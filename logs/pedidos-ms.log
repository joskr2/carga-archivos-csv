2025-08-04 07:27:18.715 [main] INFO  [] [] c.j.p.PedidosMsApplicationTests - Starting PedidosMsApplicationTests using Java 17.0.15 with PID 89543 (started by josuepatricio in /Users/josuepatricio/Downloads/pedidos-ms)
2025-08-04 07:27:18.716 [main] DEBUG [] [] c.j.p.PedidosMsApplicationTests - Running with Spring Boot v3.5.4, Spring v6.2.9
2025-08-04 07:27:18.716 [main] INFO  [] [] c.j.p.PedidosMsApplicationTests - The following 1 profile is active: "test"
2025-08-04 07:27:19.222 [main] INFO  [] [] o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-08-04 07:27:19.279 [main] INFO  [] [] o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 49 ms. Found 3 JPA repository interfaces.
2025-08-04 07:27:19.732 [main] INFO  [] [] o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-08-04 07:27:19.747 [main] INFO  [] [] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-08-04 07:27:19.853 [main] INFO  [] [] com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:testdb user=SA
2025-08-04 07:27:19.854 [main] INFO  [] [] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-08-04 07:27:19.868 [main] WARN  [] [] org.hibernate.orm.deprecation - HHH90000025: H2Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-08-04 07:27:20.300 [main] DEBUG [] [] org.hibernate.SQL - drop table if exists cliente cascade 
2025-08-04 07:27:20.302 [main] DEBUG [] [] org.hibernate.SQL - drop table if exists pedido cascade 
2025-08-04 07:27:20.302 [main] DEBUG [] [] org.hibernate.SQL - drop table if exists zona cascade 
2025-08-04 07:27:20.305 [main] DEBUG [] [] org.hibernate.SQL - create table cliente (id varchar(255) not null, nombre varchar(255), primary key (id))
2025-08-04 07:27:20.308 [main] DEBUG [] [] org.hibernate.SQL - create table pedido (fecha_entrega date, requiere_refrigeracion boolean not null, cliente_id varchar(255) not null, numero_pedido varchar(255) not null, zona_entrega varchar(255) not null, estado enum ('CONFIRMADO','ENTREGADO','PENDIENTE'), primary key (numero_pedido))
2025-08-04 07:27:20.309 [main] DEBUG [] [] org.hibernate.SQL - create table zona (soporte_refrigeracion boolean not null, id varchar(255) not null, primary key (id))
2025-08-04 07:27:20.309 [main] DEBUG [] [] org.hibernate.SQL - alter table if exists pedido add constraint FK30s8j2ktpay6of18lbyqn3632 foreign key (cliente_id) references cliente
2025-08-04 07:27:20.315 [main] DEBUG [] [] org.hibernate.SQL - alter table if exists pedido add constraint FK1aokin5yjk78h5cax5jju4fs9 foreign key (zona_entrega) references zona
2025-08-04 07:27:20.318 [main] INFO  [] [] o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-08-04 07:27:20.656 [main] DEBUG [] [] org.hibernate.SQL - select count(*) from cliente c1_0
2025-08-04 07:27:20.702 [main] DEBUG [] [] org.hibernate.SQL - select c1_0.id,c1_0.nombre from cliente c1_0 where c1_0.id=?
2025-08-04 07:27:20.716 [main] DEBUG [] [] org.hibernate.SQL - insert into cliente (nombre,id) values (?,?)
2025-08-04 07:27:20.722 [main] DEBUG [] [] org.hibernate.SQL - select c1_0.id,c1_0.nombre from cliente c1_0 where c1_0.id=?
2025-08-04 07:27:20.723 [main] DEBUG [] [] org.hibernate.SQL - insert into cliente (nombre,id) values (?,?)
2025-08-04 07:27:20.726 [main] DEBUG [] [] org.hibernate.SQL - select count(*) from zona z1_0
2025-08-04 07:27:20.728 [main] DEBUG [] [] org.hibernate.SQL - select z1_0.id,z1_0.soporte_refrigeracion from zona z1_0 where z1_0.id=?
2025-08-04 07:27:20.728 [main] DEBUG [] [] org.hibernate.SQL - insert into zona (soporte_refrigeracion,id) values (?,?)
2025-08-04 07:27:20.729 [main] DEBUG [] [] org.hibernate.SQL - select z1_0.id,z1_0.soporte_refrigeracion from zona z1_0 where z1_0.id=?
2025-08-04 07:27:20.729 [main] DEBUG [] [] org.hibernate.SQL - insert into zona (soporte_refrigeracion,id) values (?,?)
2025-08-04 07:27:20.798 [main] WARN  [] [] o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-08-04 07:27:21.060 [main] INFO  [] [] o.s.b.a.h.H2ConsoleAutoConfiguration - H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:testdb'
2025-08-04 07:27:21.072 [main] INFO  [] [] o.s.b.a.e.web.EndpointLinksResolver - Exposing 1 endpoint beneath base path '/actuator'
2025-08-04 07:27:21.120 [main] INFO  [] [] c.j.p.PedidosMsApplicationTests - Started PedidosMsApplicationTests in 2.628 seconds (process running for 5.655)
2025-08-04 07:27:21.426 [main] INFO  [] [] o.s.t.c.s.AnnotationConfigContextLoaderUtils - Could not detect default configuration classes for test class [com.josue.pedidos_ms.infrastructure.controller.PedidoControllerIntegrationTest]: PedidoControllerIntegrationTest does not declare any static, non-private, non-final, nested classes annotated with @Configuration.
2025-08-04 07:27:21.437 [main] INFO  [] [] o.s.b.t.c.SpringBootTestContextBootstrapper - Found @SpringBootConfiguration com.josue.pedidos_ms.PedidosMsApplication for test class com.josue.pedidos_ms.infrastructure.controller.PedidoControllerIntegrationTest
2025-08-04 07:27:21.439 [main] INFO  [] [] o.s.b.d.r.RestartApplicationListener - Restart disabled due to context in which it is running
2025-08-04 07:27:21.456 [main] INFO  [] [] c.j.p.i.c.PedidoControllerIntegrationTest - Starting PedidoControllerIntegrationTest using Java 17.0.15 with PID 89543 (started by josuepatricio in /Users/josuepatricio/Downloads/pedidos-ms)
2025-08-04 07:27:21.456 [main] DEBUG [] [] c.j.p.i.c.PedidoControllerIntegrationTest - Running with Spring Boot v3.5.4, Spring v6.2.9
2025-08-04 07:27:21.456 [main] INFO  [] [] c.j.p.i.c.PedidoControllerIntegrationTest - The following 1 profile is active: "test"
2025-08-04 07:27:21.587 [main] INFO  [] [] o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-08-04 07:27:21.595 [main] INFO  [] [] o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 5 ms. Found 3 JPA repository interfaces.
2025-08-04 07:27:21.652 [main] INFO  [] [] o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-08-04 07:27:21.652 [main] INFO  [] [] com.zaxxer.hikari.HikariDataSource - HikariPool-2 - Starting...
2025-08-04 07:27:21.662 [main] INFO  [] [] com.zaxxer.hikari.pool.HikariPool - HikariPool-2 - Added connection conn10: url=jdbc:h2:mem:testdb user=SA
2025-08-04 07:27:21.662 [main] INFO  [] [] com.zaxxer.hikari.HikariDataSource - HikariPool-2 - Start completed.
2025-08-04 07:27:21.662 [main] WARN  [] [] org.hibernate.orm.deprecation - HHH90000025: H2Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-08-04 07:27:21.680 [main] DEBUG [] [] org.hibernate.SQL - drop table if exists cliente cascade 
2025-08-04 07:27:21.681 [main] DEBUG [] [] org.hibernate.SQL - drop table if exists pedido cascade 
2025-08-04 07:27:21.681 [main] DEBUG [] [] org.hibernate.SQL - drop table if exists zona cascade 
2025-08-04 07:27:21.682 [main] DEBUG [] [] org.hibernate.SQL - create table cliente (id varchar(255) not null, nombre varchar(255), primary key (id))
2025-08-04 07:27:21.682 [main] DEBUG [] [] org.hibernate.SQL - create table pedido (fecha_entrega date, requiere_refrigeracion boolean not null, cliente_id varchar(255) not null, numero_pedido varchar(255) not null, zona_entrega varchar(255) not null, estado enum ('CONFIRMADO','ENTREGADO','PENDIENTE'), primary key (numero_pedido))
2025-08-04 07:27:21.683 [main] DEBUG [] [] org.hibernate.SQL - create table zona (soporte_refrigeracion boolean not null, id varchar(255) not null, primary key (id))
2025-08-04 07:27:21.683 [main] DEBUG [] [] org.hibernate.SQL - alter table if exists pedido add constraint FK30s8j2ktpay6of18lbyqn3632 foreign key (cliente_id) references cliente
2025-08-04 07:27:21.684 [main] DEBUG [] [] org.hibernate.SQL - alter table if exists pedido add constraint FK1aokin5yjk78h5cax5jju4fs9 foreign key (zona_entrega) references zona
2025-08-04 07:27:21.686 [main] INFO  [] [] o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-08-04 07:27:21.713 [main] DEBUG [] [] org.hibernate.SQL - select count(*) from cliente c1_0
2025-08-04 07:27:21.718 [main] DEBUG [] [] org.hibernate.SQL - select c1_0.id,c1_0.nombre from cliente c1_0 where c1_0.id=?
2025-08-04 07:27:21.719 [main] DEBUG [] [] org.hibernate.SQL - insert into cliente (nombre,id) values (?,?)
2025-08-04 07:27:21.720 [main] DEBUG [] [] org.hibernate.SQL - select c1_0.id,c1_0.nombre from cliente c1_0 where c1_0.id=?
2025-08-04 07:27:21.720 [main] DEBUG [] [] org.hibernate.SQL - insert into cliente (nombre,id) values (?,?)
2025-08-04 07:27:21.722 [main] DEBUG [] [] org.hibernate.SQL - select count(*) from zona z1_0
2025-08-04 07:27:21.723 [main] DEBUG [] [] org.hibernate.SQL - select z1_0.id,z1_0.soporte_refrigeracion from zona z1_0 where z1_0.id=?
2025-08-04 07:27:21.723 [main] DEBUG [] [] org.hibernate.SQL - insert into zona (soporte_refrigeracion,id) values (?,?)
2025-08-04 07:27:21.724 [main] DEBUG [] [] org.hibernate.SQL - select z1_0.id,z1_0.soporte_refrigeracion from zona z1_0 where z1_0.id=?
2025-08-04 07:27:21.725 [main] DEBUG [] [] org.hibernate.SQL - insert into zona (soporte_refrigeracion,id) values (?,?)
2025-08-04 07:27:21.740 [main] WARN  [] [] o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-08-04 07:27:21.811 [main] INFO  [] [] o.s.b.a.h.H2ConsoleAutoConfiguration - H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:testdb'
2025-08-04 07:27:21.823 [main] INFO  [] [] o.s.b.t.m.w.SpringBootMockServletContext - Initializing Spring TestDispatcherServlet ''
2025-08-04 07:27:21.823 [main] INFO  [] [] o.s.t.w.s.TestDispatcherServlet - Initializing Servlet ''
2025-08-04 07:27:21.825 [main] INFO  [] [] o.s.b.a.e.web.EndpointLinksResolver - Exposing 1 endpoint beneath base path '/actuator'
2025-08-04 07:27:21.829 [main] INFO  [] [] o.s.t.w.s.TestDispatcherServlet - Completed initialization in 6 ms
2025-08-04 07:27:21.841 [main] INFO  [] [] c.j.p.i.c.PedidoControllerIntegrationTest - Started PedidoControllerIntegrationTest in 0.402 seconds (process running for 6.377)
2025-08-04 07:27:21.846 [main] DEBUG [] [] org.hibernate.SQL - select c1_0.id,c1_0.nombre from cliente c1_0 where c1_0.id=?
2025-08-04 07:27:21.849 [main] DEBUG [] [] org.hibernate.SQL - update cliente set nombre=? where id=?
2025-08-04 07:27:21.851 [main] DEBUG [] [] org.hibernate.SQL - select z1_0.id,z1_0.soporte_refrigeracion from zona z1_0 where z1_0.id=?
2025-08-04 07:27:21.882 [main] INFO  [] [HTTP_REQUEST] c.j.p.i.controller.PedidoController - [INICIO_CARGA_CSV] POST /pedidos/cargar - Request ID: a915783a - Archivo: pedidos.csv - Tamaño: 122 bytes
2025-08-04 07:27:21.882 [main] INFO  [] [CARGA_CSV] c.j.p.a.usecase.CargarPedidosUseCase - [INICIO_CARGA_CSV] Iniciando procesamiento de archivo: pedidos.csv (tamaño: 122 bytes)
2025-08-04 07:27:21.888 [main] INFO  [] [CARGA_CSV] c.j.p.a.usecase.CargarPedidosUseCase - [INICIO_CARGA_CSV] Procesando 1 filas de datos (excluyendo cabecera)
2025-08-04 07:27:21.889 [main] DEBUG [P001] [CARGA_CSV] c.j.p.a.usecase.CargarPedidosUseCase - [INICIO_VALIDACION] Iniciando validación completa de pedido: P001
2025-08-04 07:27:21.889 [main] INFO  [P001] [CARGA_CSV] c.j.p.domain.service.PedidoValidator - [INICIO_VALIDACION] Validando número de pedido: P001
2025-08-04 07:27:21.916 [main] DEBUG [P001] [CARGA_CSV] org.hibernate.SQL - select count(*) from pedido p1_0 where p1_0.numero_pedido=?
2025-08-04 07:27:21.917 [main] DEBUG [P001] [CARGA_CSV] c.j.p.domain.service.PedidoValidator - [PEDIDO_VALIDO] Número de pedido único y válido: P001
2025-08-04 07:27:21.918 [main] DEBUG [P001] [CARGA_CSV] c.j.p.d.service.ClienteValidator - [INICIO_VALIDACION] Validando cliente: CLI-123
2025-08-04 07:27:21.918 [main] DEBUG [P001] [CARGA_CSV] org.hibernate.SQL - select c1_0.id,c1_0.nombre from cliente c1_0 where c1_0.id=?
2025-08-04 07:27:21.919 [main] DEBUG [P001] [CARGA_CSV] c.j.p.d.service.ClienteValidator - [PEDIDO_VALIDO] Cliente válido encontrado: CLI-123 - Test Cliente
2025-08-04 07:27:21.919 [main] DEBUG [P001] [CARGA_CSV] c.j.p.domain.service.FechaValidator - [INICIO_VALIDACION] Validando fecha de entrega: 2099-08-10
2025-08-04 07:27:21.920 [main] DEBUG [P001] [CARGA_CSV] c.j.p.domain.service.FechaValidator - [PEDIDO_VALIDO] Fecha de entrega válida: 2099-08-10 (días desde hoy: 27034)
2025-08-04 07:27:21.920 [main] DEBUG [P001] [CARGA_CSV] c.j.p.domain.service.EstadoValidator - [INICIO_VALIDACION] Validando estado: PENDIENTE
2025-08-04 07:27:21.920 [main] DEBUG [P001] [CARGA_CSV] c.j.p.domain.service.EstadoValidator - [PEDIDO_VALIDO] Estado válido: PENDIENTE
2025-08-04 07:27:21.920 [main] DEBUG [P001] [CARGA_CSV] c.j.p.domain.service.ZonaValidator - [INICIO_VALIDACION] Validando zona: ZONA1 con refrigeración: true
2025-08-04 07:27:21.921 [main] DEBUG [P001] [CARGA_CSV] org.hibernate.SQL - select z1_0.id,z1_0.soporte_refrigeracion from zona z1_0 where z1_0.id=?
2025-08-04 07:27:21.921 [main] DEBUG [P001] [CARGA_CSV] c.j.p.domain.service.ZonaValidator - [PEDIDO_VALIDO] Zona válida: ZONA1 - Soporte refrigeración: true - Requerido: true
2025-08-04 07:27:21.921 [main] DEBUG [P001] [CARGA_CSV] c.j.p.a.usecase.CargarPedidosUseCase - [PEDIDO_VALIDO] Todas las validaciones pasaron exitosamente
2025-08-04 07:27:21.921 [main] DEBUG [P001] [CONVERSION] c.j.p.a.usecase.CargarPedidosUseCase - [PEDIDO_PROCESADO] Convirtiendo DTO a entidad de dominio: P001
2025-08-04 07:27:21.923 [main] DEBUG [P001] [CONVERSION] c.j.p.a.usecase.CargarPedidosUseCase - [PEDIDO_PROCESADO] Conversión exitosa - Pedido: P001, Cliente: CLI-123, Fecha: 2099-08-10, Estado: PENDIENTE, Zona: ZONA1, Refrigeración: true
2025-08-04 07:27:21.923 [main] DEBUG [P001] [CONVERSION] c.j.p.a.usecase.CargarPedidosUseCase - [PEDIDO_PROCESADO] Pedido válido agregado para guardado: P001
2025-08-04 07:27:21.923 [main] INFO  [P001] [PERSISTENCIA] c.j.p.a.usecase.CargarPedidosUseCase - [PEDIDO_GUARDADO] Guardando 1 pedidos válidos en base de datos
2025-08-04 07:27:21.924 [main] DEBUG [P001] [PERSISTENCIA] org.hibernate.SQL - select p1_0.numero_pedido,p1_0.cliente_id,c1_0.id,c1_0.nombre,p1_0.estado,p1_0.fecha_entrega,p1_0.requiere_refrigeracion,p1_0.zona_entrega,ze1_0.id,ze1_0.soporte_refrigeracion from pedido p1_0 join cliente c1_0 on c1_0.id=p1_0.cliente_id join zona ze1_0 on ze1_0.id=p1_0.zona_entrega where p1_0.numero_pedido=?
2025-08-04 07:27:21.927 [main] DEBUG [P001] [PERSISTENCIA] org.hibernate.SQL - insert into pedido (cliente_id,estado,fecha_entrega,requiere_refrigeracion,zona_entrega,numero_pedido) values (?,?,?,?,?,?)
2025-08-04 07:27:21.928 [main] INFO  [P001] [PERSISTENCIA] c.j.p.a.usecase.CargarPedidosUseCase - [PEDIDO_GUARDADO] Guardados exitosamente 1 pedidos
2025-08-04 07:27:21.929 [main] INFO  [] [] c.j.p.a.usecase.CargarPedidosUseCase - [RESUMEN_PROCESAMIENTO] Procesamiento completado - Total: 1, Guardados: 1, Errores: 0
2025-08-04 07:27:21.929 [main] INFO  [] [] c.j.p.i.controller.PedidoController - [FIN_CARGA_CSV] Request ID: a915783a - Procesamiento completado en 47ms - Total: 1, Guardados: 1, Tipos de errores: 0
2025-08-04 07:27:21.929 [main] ERROR [] [] c.j.p.i.controller.PedidoController - [[ERROR_SISTEMA, a915783a]] Request ID: {} - Error inesperado al procesar archivo
java.lang.UnsupportedOperationException: null
	at java.base/java.util.ImmutableCollections.uoe(ImmutableCollections.java:142)
	at java.base/java.util.ImmutableCollections$AbstractImmutableMap.put(ImmutableCollections.java:1072)
	at com.josue.pedidos_ms.infrastructure.controller.PedidoController.cargarArchivo(PedidoController.java:67)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at org.springframework.test.web.servlet.TestDispatcherServlet.service(TestDispatcherServlet.java:72)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.springframework.mock.web.MockFilterChain$ServletFilterProxy.doFilter(MockFilterChain.java:165)
	at org.springframework.mock.web.MockFilterChain.doFilter(MockFilterChain.java:132)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.test.web.servlet.setup.MockMvcFilterDecorator.doFilter(MockMvcFilterDecorator.java:162)
	at org.springframework.mock.web.MockFilterChain.doFilter(MockFilterChain.java:132)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.test.web.servlet.setup.MockMvcFilterDecorator.doFilter(MockMvcFilterDecorator.java:162)
	at org.springframework.mock.web.MockFilterChain.doFilter(MockFilterChain.java:132)
	at org.springframework.web.filter.ServerHttpObservationFilter.doFilterInternal(ServerHttpObservationFilter.java:110)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.test.web.servlet.setup.MockMvcFilterDecorator.doFilter(MockMvcFilterDecorator.java:162)
	at org.springframework.mock.web.MockFilterChain.doFilter(MockFilterChain.java:132)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.test.web.servlet.setup.MockMvcFilterDecorator.doFilter(MockMvcFilterDecorator.java:162)
	at org.springframework.mock.web.MockFilterChain.doFilter(MockFilterChain.java:132)
	at org.springframework.test.web.servlet.MockMvc.perform(MockMvc.java:201)
	at com.josue.pedidos_ms.infrastructure.controller.PedidoControllerIntegrationTest.cargarCsvConUnPedidoValidoDebeResponderCorrectamente(PedidoControllerIntegrationTest.java:50)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at org.junit.platform.commons.util.ReflectionUtils.invokeMethod(ReflectionUtils.java:775)
	at org.junit.platform.commons.support.ReflectionSupport.invokeMethod(ReflectionSupport.java:479)
	at org.junit.jupiter.engine.execution.MethodInvocation.proceed(MethodInvocation.java:60)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$ValidatingInvocation.proceed(InvocationInterceptorChain.java:131)
	at org.junit.jupiter.engine.extension.TimeoutExtension.intercept(TimeoutExtension.java:161)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestableMethod(TimeoutExtension.java:152)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestMethod(TimeoutExtension.java:91)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker$ReflectiveInterceptorCall.lambda$ofVoidMethod$0(InterceptingExecutableInvoker.java:112)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.lambda$invoke$0(InterceptingExecutableInvoker.java:94)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$InterceptedInvocation.proceed(InvocationInterceptorChain.java:106)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.proceed(InvocationInterceptorChain.java:64)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.chainAndInvoke(InvocationInterceptorChain.java:45)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.invoke(InvocationInterceptorChain.java:37)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.invoke(InterceptingExecutableInvoker.java:93)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.invoke(InterceptingExecutableInvoker.java:87)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeTestMethod$7(TestMethodTestDescriptor.java:216)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeTestMethod(TestMethodTestDescriptor.java:212)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:137)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:69)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:156)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:146)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:144)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:143)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:100)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:160)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:146)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:144)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:143)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:100)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:160)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:146)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:144)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:143)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:100)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:35)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:201)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:170)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:94)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:59)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:142)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:58)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:103)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:85)
	at org.junit.platform.launcher.core.DelegatingLauncher.execute(DelegatingLauncher.java:47)
	at org.junit.platform.launcher.core.InterceptingLauncher.lambda$execute$1(InterceptingLauncher.java:39)
	at org.junit.platform.launcher.core.ClasspathAlignmentCheckingLauncherInterceptor.intercept(ClasspathAlignmentCheckingLauncherInterceptor.java:25)
	at org.junit.platform.launcher.core.InterceptingLauncher.execute(InterceptingLauncher.java:38)
	at org.junit.platform.launcher.core.DelegatingLauncher.execute(DelegatingLauncher.java:47)
	at org.apache.maven.surefire.junitplatform.LazyLauncher.execute(LazyLauncher.java:56)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.execute(JUnitPlatformProvider.java:194)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:150)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:124)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:385)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:162)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:507)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:495)
2025-08-04 07:27:21.967 [SpringApplicationShutdownHook] INFO  [] [] o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-08-04 07:27:21.968 [SpringApplicationShutdownHook] DEBUG [] [] org.hibernate.SQL - drop table if exists cliente cascade 
2025-08-04 07:27:21.971 [SpringApplicationShutdownHook] DEBUG [] [] org.hibernate.SQL - drop table if exists pedido cascade 
2025-08-04 07:27:21.971 [SpringApplicationShutdownHook] DEBUG [] [] org.hibernate.SQL - drop table if exists zona cascade 
2025-08-04 07:27:21.972 [SpringApplicationShutdownHook] INFO  [] [] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-08-04 07:27:21.973 [SpringApplicationShutdownHook] INFO  [] [] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-08-04 07:27:21.975 [SpringApplicationShutdownHook] INFO  [] [] o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-08-04 07:27:21.975 [SpringApplicationShutdownHook] DEBUG [] [] org.hibernate.SQL - drop table if exists cliente cascade 
2025-08-04 07:27:21.976 [SpringApplicationShutdownHook] DEBUG [] [] org.hibernate.SQL - drop table if exists pedido cascade 
2025-08-04 07:27:21.976 [SpringApplicationShutdownHook] DEBUG [] [] org.hibernate.SQL - drop table if exists zona cascade 
2025-08-04 07:27:21.976 [SpringApplicationShutdownHook] INFO  [] [] com.zaxxer.hikari.HikariDataSource - HikariPool-2 - Shutdown initiated...
2025-08-04 07:27:21.980 [SpringApplicationShutdownHook] INFO  [] [] com.zaxxer.hikari.HikariDataSource - HikariPool-2 - Shutdown completed.
2025-08-04 07:28:24.960 [main] INFO  [] [] c.j.p.PedidosMsApplicationTests - Starting PedidosMsApplicationTests using Java 17.0.15 with PID 90137 (started by josuepatricio in /Users/josuepatricio/Downloads/pedidos-ms)
2025-08-04 07:28:24.961 [main] DEBUG [] [] c.j.p.PedidosMsApplicationTests - Running with Spring Boot v3.5.4, Spring v6.2.9
2025-08-04 07:28:24.961 [main] INFO  [] [] c.j.p.PedidosMsApplicationTests - The following 1 profile is active: "test"
2025-08-04 07:28:25.439 [main] INFO  [] [] o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-08-04 07:28:25.468 [main] INFO  [] [] o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 24 ms. Found 3 JPA repository interfaces.
2025-08-04 07:28:25.863 [main] INFO  [] [] o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-08-04 07:28:25.877 [main] INFO  [] [] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-08-04 07:28:25.965 [main] INFO  [] [] com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:testdb user=SA
2025-08-04 07:28:25.966 [main] INFO  [] [] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-08-04 07:28:25.983 [main] WARN  [] [] org.hibernate.orm.deprecation - HHH90000025: H2Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-08-04 07:28:26.404 [main] DEBUG [] [] org.hibernate.SQL - drop table if exists cliente cascade 
2025-08-04 07:28:26.405 [main] DEBUG [] [] org.hibernate.SQL - drop table if exists pedido cascade 
2025-08-04 07:28:26.406 [main] DEBUG [] [] org.hibernate.SQL - drop table if exists zona cascade 
2025-08-04 07:28:26.408 [main] DEBUG [] [] org.hibernate.SQL - create table cliente (id varchar(255) not null, nombre varchar(255), primary key (id))
2025-08-04 07:28:26.412 [main] DEBUG [] [] org.hibernate.SQL - create table pedido (fecha_entrega date, requiere_refrigeracion boolean not null, cliente_id varchar(255) not null, numero_pedido varchar(255) not null, zona_entrega varchar(255) not null, estado enum ('CONFIRMADO','ENTREGADO','PENDIENTE'), primary key (numero_pedido))
2025-08-04 07:28:26.412 [main] DEBUG [] [] org.hibernate.SQL - create table zona (soporte_refrigeracion boolean not null, id varchar(255) not null, primary key (id))
2025-08-04 07:28:26.413 [main] DEBUG [] [] org.hibernate.SQL - alter table if exists pedido add constraint FK30s8j2ktpay6of18lbyqn3632 foreign key (cliente_id) references cliente
2025-08-04 07:28:26.418 [main] DEBUG [] [] org.hibernate.SQL - alter table if exists pedido add constraint FK1aokin5yjk78h5cax5jju4fs9 foreign key (zona_entrega) references zona
2025-08-04 07:28:26.421 [main] INFO  [] [] o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-08-04 07:28:26.762 [main] DEBUG [] [] org.hibernate.SQL - select count(*) from cliente c1_0
2025-08-04 07:28:26.806 [main] DEBUG [] [] org.hibernate.SQL - select c1_0.id,c1_0.nombre from cliente c1_0 where c1_0.id=?
2025-08-04 07:28:26.819 [main] DEBUG [] [] org.hibernate.SQL - insert into cliente (nombre,id) values (?,?)
2025-08-04 07:28:26.826 [main] DEBUG [] [] org.hibernate.SQL - select c1_0.id,c1_0.nombre from cliente c1_0 where c1_0.id=?
2025-08-04 07:28:26.827 [main] DEBUG [] [] org.hibernate.SQL - insert into cliente (nombre,id) values (?,?)
2025-08-04 07:28:26.828 [main] DEBUG [] [] org.hibernate.SQL - select count(*) from zona z1_0
2025-08-04 07:28:26.829 [main] DEBUG [] [] org.hibernate.SQL - select z1_0.id,z1_0.soporte_refrigeracion from zona z1_0 where z1_0.id=?
2025-08-04 07:28:26.830 [main] DEBUG [] [] org.hibernate.SQL - insert into zona (soporte_refrigeracion,id) values (?,?)
2025-08-04 07:28:26.831 [main] DEBUG [] [] org.hibernate.SQL - select z1_0.id,z1_0.soporte_refrigeracion from zona z1_0 where z1_0.id=?
2025-08-04 07:28:26.831 [main] DEBUG [] [] org.hibernate.SQL - insert into zona (soporte_refrigeracion,id) values (?,?)
2025-08-04 07:28:26.888 [main] WARN  [] [] o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-08-04 07:28:27.190 [main] INFO  [] [] o.s.b.a.h.H2ConsoleAutoConfiguration - H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:testdb'
2025-08-04 07:28:27.204 [main] INFO  [] [] o.s.b.a.e.web.EndpointLinksResolver - Exposing 1 endpoint beneath base path '/actuator'
2025-08-04 07:28:27.257 [main] INFO  [] [] c.j.p.PedidosMsApplicationTests - Started PedidosMsApplicationTests in 2.499 seconds (process running for 2.996)
2025-08-04 07:28:27.641 [main] INFO  [] [] o.s.t.c.s.AnnotationConfigContextLoaderUtils - Could not detect default configuration classes for test class [com.josue.pedidos_ms.infrastructure.controller.PedidoControllerIntegrationTest]: PedidoControllerIntegrationTest does not declare any static, non-private, non-final, nested classes annotated with @Configuration.
2025-08-04 07:28:27.652 [main] INFO  [] [] o.s.b.t.c.SpringBootTestContextBootstrapper - Found @SpringBootConfiguration com.josue.pedidos_ms.PedidosMsApplication for test class com.josue.pedidos_ms.infrastructure.controller.PedidoControllerIntegrationTest
2025-08-04 07:28:27.654 [main] INFO  [] [] o.s.b.d.r.RestartApplicationListener - Restart disabled due to context in which it is running
2025-08-04 07:28:27.670 [main] INFO  [] [] c.j.p.i.c.PedidoControllerIntegrationTest - Starting PedidoControllerIntegrationTest using Java 17.0.15 with PID 90137 (started by josuepatricio in /Users/josuepatricio/Downloads/pedidos-ms)
2025-08-04 07:28:27.670 [main] DEBUG [] [] c.j.p.i.c.PedidoControllerIntegrationTest - Running with Spring Boot v3.5.4, Spring v6.2.9
2025-08-04 07:28:27.670 [main] INFO  [] [] c.j.p.i.c.PedidoControllerIntegrationTest - The following 1 profile is active: "test"
2025-08-04 07:28:27.803 [main] INFO  [] [] o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-08-04 07:28:27.808 [main] INFO  [] [] o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 4 ms. Found 3 JPA repository interfaces.
2025-08-04 07:28:27.860 [main] INFO  [] [] o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-08-04 07:28:27.861 [main] INFO  [] [] com.zaxxer.hikari.HikariDataSource - HikariPool-2 - Starting...
2025-08-04 07:28:27.862 [main] INFO  [] [] com.zaxxer.hikari.pool.HikariPool - HikariPool-2 - Added connection conn10: url=jdbc:h2:mem:testdb user=SA
2025-08-04 07:28:27.862 [main] INFO  [] [] com.zaxxer.hikari.HikariDataSource - HikariPool-2 - Start completed.
2025-08-04 07:28:27.862 [main] WARN  [] [] org.hibernate.orm.deprecation - HHH90000025: H2Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-08-04 07:28:27.876 [main] DEBUG [] [] org.hibernate.SQL - drop table if exists cliente cascade 
2025-08-04 07:28:27.877 [main] DEBUG [] [] org.hibernate.SQL - drop table if exists pedido cascade 
2025-08-04 07:28:27.878 [main] DEBUG [] [] org.hibernate.SQL - drop table if exists zona cascade 
2025-08-04 07:28:27.878 [main] DEBUG [] [] org.hibernate.SQL - create table cliente (id varchar(255) not null, nombre varchar(255), primary key (id))
2025-08-04 07:28:27.879 [main] DEBUG [] [] org.hibernate.SQL - create table pedido (fecha_entrega date, requiere_refrigeracion boolean not null, cliente_id varchar(255) not null, numero_pedido varchar(255) not null, zona_entrega varchar(255) not null, estado enum ('CONFIRMADO','ENTREGADO','PENDIENTE'), primary key (numero_pedido))
2025-08-04 07:28:27.879 [main] DEBUG [] [] org.hibernate.SQL - create table zona (soporte_refrigeracion boolean not null, id varchar(255) not null, primary key (id))
2025-08-04 07:28:27.880 [main] DEBUG [] [] org.hibernate.SQL - alter table if exists pedido add constraint FK30s8j2ktpay6of18lbyqn3632 foreign key (cliente_id) references cliente
2025-08-04 07:28:27.880 [main] DEBUG [] [] org.hibernate.SQL - alter table if exists pedido add constraint FK1aokin5yjk78h5cax5jju4fs9 foreign key (zona_entrega) references zona
2025-08-04 07:28:27.881 [main] INFO  [] [] o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-08-04 07:28:27.907 [main] DEBUG [] [] org.hibernate.SQL - select count(*) from cliente c1_0
2025-08-04 07:28:27.913 [main] DEBUG [] [] org.hibernate.SQL - select c1_0.id,c1_0.nombre from cliente c1_0 where c1_0.id=?
2025-08-04 07:28:27.914 [main] DEBUG [] [] org.hibernate.SQL - insert into cliente (nombre,id) values (?,?)
2025-08-04 07:28:27.915 [main] DEBUG [] [] org.hibernate.SQL - select c1_0.id,c1_0.nombre from cliente c1_0 where c1_0.id=?
2025-08-04 07:28:27.915 [main] DEBUG [] [] org.hibernate.SQL - insert into cliente (nombre,id) values (?,?)
2025-08-04 07:28:27.916 [main] DEBUG [] [] org.hibernate.SQL - select count(*) from zona z1_0
2025-08-04 07:28:27.917 [main] DEBUG [] [] org.hibernate.SQL - select z1_0.id,z1_0.soporte_refrigeracion from zona z1_0 where z1_0.id=?
2025-08-04 07:28:27.917 [main] DEBUG [] [] org.hibernate.SQL - insert into zona (soporte_refrigeracion,id) values (?,?)
2025-08-04 07:28:27.918 [main] DEBUG [] [] org.hibernate.SQL - select z1_0.id,z1_0.soporte_refrigeracion from zona z1_0 where z1_0.id=?
2025-08-04 07:28:27.918 [main] DEBUG [] [] org.hibernate.SQL - insert into zona (soporte_refrigeracion,id) values (?,?)
2025-08-04 07:28:27.942 [main] WARN  [] [] o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-08-04 07:28:28.002 [main] INFO  [] [] o.s.b.a.h.H2ConsoleAutoConfiguration - H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:testdb'
2025-08-04 07:28:28.046 [main] INFO  [] [] o.s.b.t.m.w.SpringBootMockServletContext - Initializing Spring TestDispatcherServlet ''
2025-08-04 07:28:28.046 [main] INFO  [] [] o.s.t.w.s.TestDispatcherServlet - Initializing Servlet ''
2025-08-04 07:28:28.048 [main] INFO  [] [] o.s.b.a.e.web.EndpointLinksResolver - Exposing 1 endpoint beneath base path '/actuator'
2025-08-04 07:28:28.051 [main] INFO  [] [] o.s.t.w.s.TestDispatcherServlet - Completed initialization in 5 ms
2025-08-04 07:28:28.077 [main] INFO  [] [] c.j.p.i.c.PedidoControllerIntegrationTest - Started PedidoControllerIntegrationTest in 0.423 seconds (process running for 3.817)
2025-08-04 07:28:28.082 [main] DEBUG [] [] org.hibernate.SQL - select c1_0.id,c1_0.nombre from cliente c1_0 where c1_0.id=?
2025-08-04 07:28:28.085 [main] DEBUG [] [] org.hibernate.SQL - update cliente set nombre=? where id=?
2025-08-04 07:28:28.088 [main] DEBUG [] [] org.hibernate.SQL - select z1_0.id,z1_0.soporte_refrigeracion from zona z1_0 where z1_0.id=?
2025-08-04 07:28:28.133 [main] INFO  [] [HTTP_REQUEST] c.j.p.i.controller.PedidoController - [INICIO_CARGA_CSV] POST /pedidos/cargar - Request ID: d4f605e1 - Archivo: pedidos.csv - Tamaño: 122 bytes
2025-08-04 07:28:28.134 [main] INFO  [] [CARGA_CSV] c.j.p.a.usecase.CargarPedidosUseCase - [INICIO_CARGA_CSV] Iniciando procesamiento de archivo: pedidos.csv (tamaño: 122 bytes)
2025-08-04 07:28:28.159 [main] INFO  [] [CARGA_CSV] c.j.p.a.usecase.CargarPedidosUseCase - [INICIO_CARGA_CSV] Procesando 1 filas de datos (excluyendo cabecera)
2025-08-04 07:28:28.159 [main] DEBUG [P001] [CARGA_CSV] c.j.p.a.usecase.CargarPedidosUseCase - [INICIO_VALIDACION] Iniciando validación completa de pedido: P001
2025-08-04 07:28:28.159 [main] INFO  [P001] [CARGA_CSV] c.j.p.domain.service.PedidoValidator - [INICIO_VALIDACION] Validando número de pedido: P001
2025-08-04 07:28:28.205 [main] DEBUG [P001] [CARGA_CSV] org.hibernate.SQL - select count(*) from pedido p1_0 where p1_0.numero_pedido=?
2025-08-04 07:28:28.206 [main] DEBUG [P001] [CARGA_CSV] c.j.p.domain.service.PedidoValidator - [PEDIDO_VALIDO] Número de pedido único y válido: P001
2025-08-04 07:28:28.206 [main] DEBUG [P001] [CARGA_CSV] c.j.p.d.service.ClienteValidator - [INICIO_VALIDACION] Validando cliente: CLI-123
2025-08-04 07:28:28.208 [main] DEBUG [P001] [CARGA_CSV] org.hibernate.SQL - select c1_0.id,c1_0.nombre from cliente c1_0 where c1_0.id=?
2025-08-04 07:28:28.209 [main] DEBUG [P001] [CARGA_CSV] c.j.p.d.service.ClienteValidator - [PEDIDO_VALIDO] Cliente válido encontrado: CLI-123 - Test Cliente
2025-08-04 07:28:28.209 [main] DEBUG [P001] [CARGA_CSV] c.j.p.domain.service.FechaValidator - [INICIO_VALIDACION] Validando fecha de entrega: 2099-08-10
2025-08-04 07:28:28.210 [main] DEBUG [P001] [CARGA_CSV] c.j.p.domain.service.FechaValidator - [PEDIDO_VALIDO] Fecha de entrega válida: 2099-08-10 (días desde hoy: 27034)
2025-08-04 07:28:28.211 [main] DEBUG [P001] [CARGA_CSV] c.j.p.domain.service.EstadoValidator - [INICIO_VALIDACION] Validando estado: PENDIENTE
2025-08-04 07:28:28.211 [main] DEBUG [P001] [CARGA_CSV] c.j.p.domain.service.EstadoValidator - [PEDIDO_VALIDO] Estado válido: PENDIENTE
2025-08-04 07:28:28.211 [main] DEBUG [P001] [CARGA_CSV] c.j.p.domain.service.ZonaValidator - [INICIO_VALIDACION] Validando zona: ZONA1 con refrigeración: true
2025-08-04 07:28:28.212 [main] DEBUG [P001] [CARGA_CSV] org.hibernate.SQL - select z1_0.id,z1_0.soporte_refrigeracion from zona z1_0 where z1_0.id=?
2025-08-04 07:28:28.212 [main] DEBUG [P001] [CARGA_CSV] c.j.p.domain.service.ZonaValidator - [PEDIDO_VALIDO] Zona válida: ZONA1 - Soporte refrigeración: true - Requerido: true
2025-08-04 07:28:28.213 [main] DEBUG [P001] [CARGA_CSV] c.j.p.a.usecase.CargarPedidosUseCase - [PEDIDO_VALIDO] Todas las validaciones pasaron exitosamente
2025-08-04 07:28:28.213 [main] DEBUG [P001] [CONVERSION] c.j.p.a.usecase.CargarPedidosUseCase - [PEDIDO_PROCESADO] Convirtiendo DTO a entidad de dominio: P001
2025-08-04 07:28:28.214 [main] DEBUG [P001] [CONVERSION] c.j.p.a.usecase.CargarPedidosUseCase - [PEDIDO_PROCESADO] Conversión exitosa - Pedido: P001, Cliente: CLI-123, Fecha: 2099-08-10, Estado: PENDIENTE, Zona: ZONA1, Refrigeración: true
2025-08-04 07:28:28.214 [main] DEBUG [P001] [CONVERSION] c.j.p.a.usecase.CargarPedidosUseCase - [PEDIDO_PROCESADO] Pedido válido agregado para guardado: P001
2025-08-04 07:28:28.214 [main] INFO  [P001] [PERSISTENCIA] c.j.p.a.usecase.CargarPedidosUseCase - [PEDIDO_GUARDADO] Guardando 1 pedidos válidos en base de datos
2025-08-04 07:28:28.215 [main] DEBUG [P001] [PERSISTENCIA] org.hibernate.SQL - select p1_0.numero_pedido,p1_0.cliente_id,c1_0.id,c1_0.nombre,p1_0.estado,p1_0.fecha_entrega,p1_0.requiere_refrigeracion,p1_0.zona_entrega,ze1_0.id,ze1_0.soporte_refrigeracion from pedido p1_0 join cliente c1_0 on c1_0.id=p1_0.cliente_id join zona ze1_0 on ze1_0.id=p1_0.zona_entrega where p1_0.numero_pedido=?
2025-08-04 07:28:28.218 [main] DEBUG [P001] [PERSISTENCIA] org.hibernate.SQL - insert into pedido (cliente_id,estado,fecha_entrega,requiere_refrigeracion,zona_entrega,numero_pedido) values (?,?,?,?,?,?)
2025-08-04 07:28:28.219 [main] INFO  [P001] [PERSISTENCIA] c.j.p.a.usecase.CargarPedidosUseCase - [PEDIDO_GUARDADO] Guardados exitosamente 1 pedidos
2025-08-04 07:28:28.219 [main] INFO  [] [] c.j.p.a.usecase.CargarPedidosUseCase - [RESUMEN_PROCESAMIENTO] Procesamiento completado - Total: 1, Guardados: 1, Errores: 0
2025-08-04 07:28:28.219 [main] INFO  [] [] c.j.p.i.controller.PedidoController - [FIN_CARGA_CSV] Request ID: d4f605e1 - Procesamiento completado en 85ms - Total: 1, Guardados: 1, Tipos de errores: 0
2025-08-04 07:28:28.545 [main] INFO  [] [CARGA_CSV] c.j.p.a.usecase.CargarPedidosUseCase - [INICIO_CARGA_CSV] Iniciando procesamiento de archivo: pedidos.csv (tamaño: 167 bytes)
2025-08-04 07:28:28.545 [main] INFO  [] [CARGA_CSV] c.j.p.a.usecase.CargarPedidosUseCase - [INICIO_CARGA_CSV] Procesando 2 filas de datos (excluyendo cabecera)
2025-08-04 07:28:28.545 [main] DEBUG [P001] [CARGA_CSV] c.j.p.a.usecase.CargarPedidosUseCase - [INICIO_VALIDACION] Iniciando validación completa de pedido: P001
2025-08-04 07:28:28.546 [main] INFO  [P001] [CARGA_CSV] c.j.p.domain.service.PedidoValidator - [INICIO_VALIDACION] Validando número de pedido: P001
2025-08-04 07:28:28.548 [main] DEBUG [P001] [CARGA_CSV] c.j.p.domain.service.PedidoValidator - [PEDIDO_VALIDO] Número de pedido único y válido: P001
2025-08-04 07:28:28.548 [main] DEBUG [P001] [CARGA_CSV] c.j.p.d.service.ClienteValidator - [INICIO_VALIDACION] Validando cliente: CLI-123
2025-08-04 07:28:28.548 [main] DEBUG [P001] [CARGA_CSV] c.j.p.d.service.ClienteValidator - [PEDIDO_VALIDO] Cliente válido encontrado: CLI-123 - Cliente Test
2025-08-04 07:28:28.548 [main] DEBUG [P001] [CARGA_CSV] c.j.p.domain.service.FechaValidator - [INICIO_VALIDACION] Validando fecha de entrega: 2099-08-10
2025-08-04 07:28:28.548 [main] DEBUG [P001] [CARGA_CSV] c.j.p.domain.service.FechaValidator - [PEDIDO_VALIDO] Fecha de entrega válida: 2099-08-10 (días desde hoy: 27034)
2025-08-04 07:28:28.548 [main] DEBUG [P001] [CARGA_CSV] c.j.p.domain.service.EstadoValidator - [INICIO_VALIDACION] Validando estado: PENDIENTE
2025-08-04 07:28:28.549 [main] DEBUG [P001] [CARGA_CSV] c.j.p.domain.service.EstadoValidator - [PEDIDO_VALIDO] Estado válido: PENDIENTE
2025-08-04 07:28:28.549 [main] DEBUG [P001] [CARGA_CSV] c.j.p.domain.service.ZonaValidator - [INICIO_VALIDACION] Validando zona: ZONA1 con refrigeración: true
2025-08-04 07:28:28.549 [main] DEBUG [P001] [CARGA_CSV] c.j.p.domain.service.ZonaValidator - [PEDIDO_VALIDO] Zona válida: ZONA1 - Soporte refrigeración: true - Requerido: true
2025-08-04 07:28:28.549 [main] DEBUG [P001] [CARGA_CSV] c.j.p.a.usecase.CargarPedidosUseCase - [PEDIDO_VALIDO] Todas las validaciones pasaron exitosamente
2025-08-04 07:28:28.549 [main] DEBUG [P001] [CONVERSION] c.j.p.a.usecase.CargarPedidosUseCase - [PEDIDO_PROCESADO] Convirtiendo DTO a entidad de dominio: P001
2025-08-04 07:28:28.549 [main] DEBUG [P001] [CONVERSION] c.j.p.a.usecase.CargarPedidosUseCase - [PEDIDO_PROCESADO] Conversión exitosa - Pedido: P001, Cliente: CLI-123, Fecha: 2099-08-10, Estado: PENDIENTE, Zona: ZONA1, Refrigeración: true
2025-08-04 07:28:28.550 [main] DEBUG [P001] [CONVERSION] c.j.p.a.usecase.CargarPedidosUseCase - [PEDIDO_PROCESADO] Pedido válido agregado para guardado: P001
2025-08-04 07:28:28.550 [main] DEBUG [P002] [CONVERSION] c.j.p.a.usecase.CargarPedidosUseCase - [INICIO_VALIDACION] Iniciando validación completa de pedido: P002
2025-08-04 07:28:28.550 [main] INFO  [P002] [CONVERSION] c.j.p.domain.service.PedidoValidator - [INICIO_VALIDACION] Validando número de pedido: P002
2025-08-04 07:28:28.550 [main] DEBUG [P002] [CONVERSION] c.j.p.domain.service.PedidoValidator - [PEDIDO_VALIDO] Número de pedido único y válido: P002
2025-08-04 07:28:28.550 [main] DEBUG [P002] [CONVERSION] c.j.p.d.service.ClienteValidator - [INICIO_VALIDACION] Validando cliente: CLI-999
2025-08-04 07:28:28.551 [main] WARN  [P002] [CONVERSION] c.j.p.d.service.ClienteValidator - [PEDIDO_INVALIDO] Cliente no encontrado en base de datos: CLI-999
2025-08-04 07:28:28.551 [main] DEBUG [P002] [CONVERSION] c.j.p.domain.service.FechaValidator - [INICIO_VALIDACION] Validando fecha de entrega: 2020-01-01
2025-08-04 07:28:28.551 [main] WARN  [P002] [CONVERSION] c.j.p.domain.service.FechaValidator - [PEDIDO_INVALIDO] Fecha de entrega en el pasado: 2020-01-01 (hoy: 2025-08-04)
2025-08-04 07:28:28.551 [main] DEBUG [P002] [CONVERSION] c.j.p.domain.service.EstadoValidator - [INICIO_VALIDACION] Validando estado: INVALIDO
2025-08-04 07:28:28.551 [main] WARN  [P002] [CONVERSION] c.j.p.domain.service.EstadoValidator - [PEDIDO_INVALIDO] Estado inválido: INVALIDO. Estados válidos: PENDIENTE, CONFIRMADO, ENTREGADO
2025-08-04 07:28:28.551 [main] DEBUG [P002] [CONVERSION] c.j.p.domain.service.ZonaValidator - [INICIO_VALIDACION] Validando zona: ZONA2 con refrigeración: false
2025-08-04 07:28:28.552 [main] WARN  [P002] [CONVERSION] c.j.p.domain.service.ZonaValidator - [PEDIDO_INVALIDO] Zona no encontrada en base de datos: ZONA2
2025-08-04 07:28:28.552 [main] INFO  [P002] [CONVERSION] c.j.p.a.usecase.CargarPedidosUseCase - [ESTADISTICAS_VALIDACION] Validación completada con 4 errores: [Clientes no encontrados, Fecha de entrega inválida, Estado inválido, Zonas inválidas]
2025-08-04 07:28:28.552 [main] WARN  [P002] [CONVERSION] c.j.p.a.usecase.CargarPedidosUseCase - [PEDIDO_INVALIDO] Pedido con 4 errores de validación
2025-08-04 07:28:28.552 [main] INFO  [P002] [PERSISTENCIA] c.j.p.a.usecase.CargarPedidosUseCase - [PEDIDO_GUARDADO] Guardando 1 pedidos válidos en base de datos
2025-08-04 07:28:28.552 [main] INFO  [P002] [PERSISTENCIA] c.j.p.a.usecase.CargarPedidosUseCase - [PEDIDO_GUARDADO] Guardados exitosamente 1 pedidos
2025-08-04 07:28:28.553 [main] INFO  [] [] c.j.p.a.usecase.CargarPedidosUseCase - [RESUMEN_PROCESAMIENTO] Procesamiento completado - Total: 2, Guardados: 1, Errores: 4
2025-08-04 07:28:28.586 [SpringApplicationShutdownHook] INFO  [] [] o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-08-04 07:28:28.587 [SpringApplicationShutdownHook] DEBUG [] [] org.hibernate.SQL - drop table if exists cliente cascade 
2025-08-04 07:28:28.588 [SpringApplicationShutdownHook] DEBUG [] [] org.hibernate.SQL - drop table if exists pedido cascade 
2025-08-04 07:28:28.588 [SpringApplicationShutdownHook] DEBUG [] [] org.hibernate.SQL - drop table if exists zona cascade 
2025-08-04 07:28:28.591 [SpringApplicationShutdownHook] INFO  [] [] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-08-04 07:28:28.594 [SpringApplicationShutdownHook] INFO  [] [] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-08-04 07:28:28.598 [SpringApplicationShutdownHook] INFO  [] [] o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-08-04 07:28:28.599 [SpringApplicationShutdownHook] DEBUG [] [] org.hibernate.SQL - drop table if exists cliente cascade 
2025-08-04 07:28:28.599 [SpringApplicationShutdownHook] DEBUG [] [] org.hibernate.SQL - drop table if exists pedido cascade 
2025-08-04 07:28:28.599 [SpringApplicationShutdownHook] DEBUG [] [] org.hibernate.SQL - drop table if exists zona cascade 
2025-08-04 07:28:28.600 [SpringApplicationShutdownHook] INFO  [] [] com.zaxxer.hikari.HikariDataSource - HikariPool-2 - Shutdown initiated...
2025-08-04 07:28:28.600 [SpringApplicationShutdownHook] INFO  [] [] com.zaxxer.hikari.HikariDataSource - HikariPool-2 - Shutdown completed.
2025-08-04 07:46:29.223 [main] INFO  [] [] c.j.p.i.c.PedidoControllerHttpStatusTest - Starting PedidoControllerHttpStatusTest using Java 17.0.15 with PID 96188 (started by josuepatricio in /Users/josuepatricio/Downloads/pedidos-ms)
2025-08-04 07:46:29.225 [main] DEBUG [] [] c.j.p.i.c.PedidoControllerHttpStatusTest - Running with Spring Boot v3.5.4, Spring v6.2.9
2025-08-04 07:46:29.225 [main] INFO  [] [] c.j.p.i.c.PedidoControllerHttpStatusTest - The following 1 profile is active: "test"
2025-08-04 07:46:29.702 [main] INFO  [] [] o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-08-04 07:46:29.734 [main] INFO  [] [] o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 26 ms. Found 3 JPA repository interfaces.
2025-08-04 07:46:30.165 [main] INFO  [] [] o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-08-04 07:46:30.180 [main] INFO  [] [] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-08-04 07:46:30.280 [main] INFO  [] [] com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:testdb user=SA
2025-08-04 07:46:30.281 [main] INFO  [] [] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-08-04 07:46:30.294 [main] WARN  [] [] org.hibernate.orm.deprecation - HHH90000025: H2Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-08-04 07:46:30.712 [main] DEBUG [] [] org.hibernate.SQL - drop table if exists cliente cascade 
2025-08-04 07:46:30.714 [main] DEBUG [] [] org.hibernate.SQL - drop table if exists pedido cascade 
2025-08-04 07:46:30.714 [main] DEBUG [] [] org.hibernate.SQL - drop table if exists zona cascade 
2025-08-04 07:46:30.717 [main] DEBUG [] [] org.hibernate.SQL - create table cliente (id varchar(255) not null, nombre varchar(255), primary key (id))
2025-08-04 07:46:30.720 [main] DEBUG [] [] org.hibernate.SQL - create table pedido (fecha_entrega date, requiere_refrigeracion boolean not null, cliente_id varchar(255) not null, numero_pedido varchar(255) not null, zona_entrega varchar(255) not null, estado enum ('CONFIRMADO','ENTREGADO','PENDIENTE'), primary key (numero_pedido))
2025-08-04 07:46:30.721 [main] DEBUG [] [] org.hibernate.SQL - create table zona (soporte_refrigeracion boolean not null, id varchar(255) not null, primary key (id))
2025-08-04 07:46:30.722 [main] DEBUG [] [] org.hibernate.SQL - alter table if exists pedido add constraint FK30s8j2ktpay6of18lbyqn3632 foreign key (cliente_id) references cliente
2025-08-04 07:46:30.728 [main] DEBUG [] [] org.hibernate.SQL - alter table if exists pedido add constraint FK1aokin5yjk78h5cax5jju4fs9 foreign key (zona_entrega) references zona
2025-08-04 07:46:30.731 [main] INFO  [] [] o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-08-04 07:46:31.073 [main] DEBUG [] [] org.hibernate.SQL - select count(*) from cliente c1_0
2025-08-04 07:46:31.115 [main] DEBUG [] [] org.hibernate.SQL - select c1_0.id,c1_0.nombre from cliente c1_0 where c1_0.id=?
2025-08-04 07:46:31.130 [main] DEBUG [] [] org.hibernate.SQL - insert into cliente (nombre,id) values (?,?)
2025-08-04 07:46:31.137 [main] DEBUG [] [] org.hibernate.SQL - select c1_0.id,c1_0.nombre from cliente c1_0 where c1_0.id=?
2025-08-04 07:46:31.137 [main] DEBUG [] [] org.hibernate.SQL - insert into cliente (nombre,id) values (?,?)
2025-08-04 07:46:31.140 [main] DEBUG [] [] org.hibernate.SQL - select count(*) from zona z1_0
2025-08-04 07:46:31.142 [main] DEBUG [] [] org.hibernate.SQL - select z1_0.id,z1_0.soporte_refrigeracion from zona z1_0 where z1_0.id=?
2025-08-04 07:46:31.143 [main] DEBUG [] [] org.hibernate.SQL - insert into zona (soporte_refrigeracion,id) values (?,?)
2025-08-04 07:46:31.144 [main] DEBUG [] [] org.hibernate.SQL - select z1_0.id,z1_0.soporte_refrigeracion from zona z1_0 where z1_0.id=?
2025-08-04 07:46:31.145 [main] DEBUG [] [] org.hibernate.SQL - insert into zona (soporte_refrigeracion,id) values (?,?)
2025-08-04 07:46:31.209 [main] WARN  [] [] o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-08-04 07:46:31.458 [main] INFO  [] [] o.s.b.a.h.H2ConsoleAutoConfiguration - H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:testdb'
2025-08-04 07:46:31.475 [main] INFO  [] [] o.s.b.t.m.w.SpringBootMockServletContext - Initializing Spring TestDispatcherServlet ''
2025-08-04 07:46:31.475 [main] INFO  [] [] o.s.t.w.s.TestDispatcherServlet - Initializing Servlet ''
2025-08-04 07:46:31.479 [main] INFO  [] [] o.s.b.a.e.web.EndpointLinksResolver - Exposing 1 endpoint beneath base path '/actuator'
2025-08-04 07:46:31.486 [main] INFO  [] [] o.s.t.w.s.TestDispatcherServlet - Completed initialization in 11 ms
2025-08-04 07:46:31.529 [main] INFO  [] [] c.j.p.i.c.PedidoControllerHttpStatusTest - Started PedidoControllerHttpStatusTest in 2.535 seconds (process running for 3.199)
2025-08-04 07:46:31.825 [main] DEBUG [] [] org.hibernate.SQL - select c1_0.id,c1_0.nombre from cliente c1_0 where c1_0.id=?
2025-08-04 07:46:31.828 [main] DEBUG [] [] org.hibernate.SQL - update cliente set nombre=? where id=?
2025-08-04 07:46:31.831 [main] DEBUG [] [] org.hibernate.SQL - select z1_0.id,z1_0.soporte_refrigeracion from zona z1_0 where z1_0.id=?
2025-08-04 07:46:31.861 [main] INFO  [] [HTTP_REQUEST] c.j.p.i.controller.PedidoController - [INICIO_CARGA_CSV] POST /pedidos/cargar - Request ID: 553f54c2 - Archivo: pedidos.csv - Tamaño: 122 bytes
2025-08-04 07:46:31.862 [main] INFO  [] [CARGA_CSV] c.j.p.a.usecase.CargarPedidosUseCase - [INICIO_CARGA_CSV] Iniciando procesamiento de archivo: pedidos.csv (tamaño: 122 bytes)
2025-08-04 07:46:31.868 [main] INFO  [] [CARGA_CSV] c.j.p.a.usecase.CargarPedidosUseCase - [INICIO_CARGA_CSV] Procesando 1 filas de datos (excluyendo cabecera)
2025-08-04 07:46:31.869 [main] DEBUG [P001] [CARGA_CSV] c.j.p.a.usecase.CargarPedidosUseCase - [INICIO_VALIDACION] Iniciando validación completa de pedido: P001
2025-08-04 07:46:31.869 [main] INFO  [P001] [CARGA_CSV] c.j.p.domain.service.PedidoValidator - [INICIO_VALIDACION] Validando número de pedido: P001
2025-08-04 07:46:31.905 [main] DEBUG [P001] [CARGA_CSV] org.hibernate.SQL - select count(*) from pedido p1_0 where p1_0.numero_pedido=?
2025-08-04 07:46:31.907 [main] DEBUG [P001] [CARGA_CSV] c.j.p.domain.service.PedidoValidator - [PEDIDO_VALIDO] Número de pedido único y válido: P001
2025-08-04 07:46:31.907 [main] DEBUG [P001] [CARGA_CSV] c.j.p.d.service.ClienteValidator - [INICIO_VALIDACION] Validando cliente: CLI-123
2025-08-04 07:46:31.908 [main] DEBUG [P001] [CARGA_CSV] org.hibernate.SQL - select c1_0.id,c1_0.nombre from cliente c1_0 where c1_0.id=?
2025-08-04 07:46:31.909 [main] DEBUG [P001] [CARGA_CSV] c.j.p.d.service.ClienteValidator - [PEDIDO_VALIDO] Cliente válido encontrado: CLI-123 - Test Cliente
2025-08-04 07:46:31.909 [main] DEBUG [P001] [CARGA_CSV] c.j.p.domain.service.FechaValidator - [INICIO_VALIDACION] Validando fecha de entrega: 2099-08-10
2025-08-04 07:46:31.910 [main] DEBUG [P001] [CARGA_CSV] c.j.p.domain.service.FechaValidator - [PEDIDO_VALIDO] Fecha de entrega válida: 2099-08-10 (días desde hoy: 27034)
2025-08-04 07:46:31.910 [main] DEBUG [P001] [CARGA_CSV] c.j.p.domain.service.EstadoValidator - [INICIO_VALIDACION] Validando estado: PENDIENTE
2025-08-04 07:46:31.910 [main] DEBUG [P001] [CARGA_CSV] c.j.p.domain.service.EstadoValidator - [PEDIDO_VALIDO] Estado válido: PENDIENTE
2025-08-04 07:46:31.911 [main] DEBUG [P001] [CARGA_CSV] c.j.p.domain.service.ZonaValidator - [INICIO_VALIDACION] Validando zona: ZONA1 con refrigeración: true
2025-08-04 07:46:31.911 [main] DEBUG [P001] [CARGA_CSV] org.hibernate.SQL - select z1_0.id,z1_0.soporte_refrigeracion from zona z1_0 where z1_0.id=?
2025-08-04 07:46:31.912 [main] DEBUG [P001] [CARGA_CSV] c.j.p.domain.service.ZonaValidator - [PEDIDO_VALIDO] Zona válida: ZONA1 - Soporte refrigeración: true - Requerido: true
2025-08-04 07:46:31.912 [main] DEBUG [P001] [CARGA_CSV] c.j.p.a.usecase.CargarPedidosUseCase - [PEDIDO_VALIDO] Todas las validaciones pasaron exitosamente
2025-08-04 07:46:31.912 [main] DEBUG [P001] [CONVERSION] c.j.p.a.usecase.CargarPedidosUseCase - [PEDIDO_PROCESADO] Convirtiendo DTO a entidad de dominio: P001
2025-08-04 07:46:31.913 [main] DEBUG [P001] [CONVERSION] c.j.p.a.usecase.CargarPedidosUseCase - [PEDIDO_PROCESADO] Conversión exitosa - Pedido: P001, Cliente: CLI-123, Fecha: 2099-08-10, Estado: PENDIENTE, Zona: ZONA1, Refrigeración: true
2025-08-04 07:46:31.914 [main] DEBUG [P001] [CONVERSION] c.j.p.a.usecase.CargarPedidosUseCase - [PEDIDO_PROCESADO] Pedido válido agregado para guardado: P001
2025-08-04 07:46:31.914 [main] INFO  [P001] [PERSISTENCIA] c.j.p.a.usecase.CargarPedidosUseCase - [PEDIDO_GUARDADO] Guardando 1 pedidos válidos en base de datos
2025-08-04 07:46:31.915 [main] DEBUG [P001] [PERSISTENCIA] org.hibernate.SQL - select p1_0.numero_pedido,p1_0.cliente_id,c1_0.id,c1_0.nombre,p1_0.estado,p1_0.fecha_entrega,p1_0.requiere_refrigeracion,p1_0.zona_entrega,ze1_0.id,ze1_0.soporte_refrigeracion from pedido p1_0 join cliente c1_0 on c1_0.id=p1_0.cliente_id join zona ze1_0 on ze1_0.id=p1_0.zona_entrega where p1_0.numero_pedido=?
2025-08-04 07:46:31.918 [main] DEBUG [P001] [PERSISTENCIA] org.hibernate.SQL - insert into pedido (cliente_id,estado,fecha_entrega,requiere_refrigeracion,zona_entrega,numero_pedido) values (?,?,?,?,?,?)
2025-08-04 07:46:31.919 [main] INFO  [P001] [PERSISTENCIA] c.j.p.a.usecase.CargarPedidosUseCase - [PEDIDO_GUARDADO] Guardados exitosamente 1 pedidos
2025-08-04 07:46:31.920 [main] INFO  [] [] c.j.p.a.usecase.CargarPedidosUseCase - [RESUMEN_PROCESAMIENTO] Procesamiento completado - Total: 1, Guardados: 1, Errores: 0
2025-08-04 07:46:31.920 [main] INFO  [] [] c.j.p.i.controller.PedidoController - [FIN_CARGA_CSV] Request ID: 553f54c2 - Procesamiento completado en 58ms - Total: 1, Guardados: 1, Tipos de errores: 0
2025-08-04 07:46:31.971 [main] DEBUG [] [] org.hibernate.SQL - select c1_0.id,c1_0.nombre from cliente c1_0 where c1_0.id=?
2025-08-04 07:46:31.972 [main] DEBUG [] [] org.hibernate.SQL - select z1_0.id,z1_0.soporte_refrigeracion from zona z1_0 where z1_0.id=?
2025-08-04 07:46:31.974 [main] INFO  [] [HTTP_REQUEST] c.j.p.i.controller.PedidoController - [INICIO_CARGA_CSV] POST /pedidos/cargar - Request ID: c846b0df - Archivo: pedidos.csv - Tamaño: 61 bytes
2025-08-04 07:46:31.974 [main] INFO  [] [CARGA_CSV] c.j.p.a.usecase.CargarPedidosUseCase - [INICIO_CARGA_CSV] Iniciando procesamiento de archivo: pedidos.csv (tamaño: 61 bytes)
2025-08-04 07:46:31.978 [main] ERROR [] [CARGA_CSV] c.j.p.a.usecase.CargarPedidosUseCase - [[ERROR_LECTURA_CSV, pedidos.csv]] Error al leer archivo CSV: {}
com.opencsv.exceptions.CsvMalformedLineException: Unterminated quoted field at end of CSV line. Beginning of lost text: [P001,CLI-123,2099-08-10
]
	at com.opencsv.CSVReader.primeNextRecord(CSVReader.java:245)
	at com.opencsv.CSVReader.flexibleRead(CSVReader.java:610)
	at com.opencsv.CSVReader.readNext(CSVReader.java:204)
	at com.opencsv.CSVReader.readAll(CSVReader.java:186)
	at com.josue.pedidos_ms.application.usecase.CargarPedidosUseCase.procesarArchivo(CargarPedidosUseCase.java:57)
	at com.josue.pedidos_ms.infrastructure.controller.PedidoController.cargarArchivo(PedidoController.java:54)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at org.springframework.test.web.servlet.TestDispatcherServlet.service(TestDispatcherServlet.java:72)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.springframework.mock.web.MockFilterChain$ServletFilterProxy.doFilter(MockFilterChain.java:165)
	at org.springframework.mock.web.MockFilterChain.doFilter(MockFilterChain.java:132)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.test.web.servlet.setup.MockMvcFilterDecorator.doFilter(MockMvcFilterDecorator.java:162)
	at org.springframework.mock.web.MockFilterChain.doFilter(MockFilterChain.java:132)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.test.web.servlet.setup.MockMvcFilterDecorator.doFilter(MockMvcFilterDecorator.java:162)
	at org.springframework.mock.web.MockFilterChain.doFilter(MockFilterChain.java:132)
	at org.springframework.web.filter.ServerHttpObservationFilter.doFilterInternal(ServerHttpObservationFilter.java:110)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.test.web.servlet.setup.MockMvcFilterDecorator.doFilter(MockMvcFilterDecorator.java:162)
	at org.springframework.mock.web.MockFilterChain.doFilter(MockFilterChain.java:132)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.test.web.servlet.setup.MockMvcFilterDecorator.doFilter(MockMvcFilterDecorator.java:162)
	at org.springframework.mock.web.MockFilterChain.doFilter(MockFilterChain.java:132)
	at org.springframework.test.web.servlet.MockMvc.perform(MockMvc.java:201)
	at com.josue.pedidos_ms.infrastructure.controller.PedidoControllerHttpStatusTest.debeRetornar400CuandoElCsvEsMalformado(PedidoControllerHttpStatusTest.java:109)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at org.junit.platform.commons.util.ReflectionUtils.invokeMethod(ReflectionUtils.java:775)
	at org.junit.platform.commons.support.ReflectionSupport.invokeMethod(ReflectionSupport.java:479)
	at org.junit.jupiter.engine.execution.MethodInvocation.proceed(MethodInvocation.java:60)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$ValidatingInvocation.proceed(InvocationInterceptorChain.java:131)
	at org.junit.jupiter.engine.extension.TimeoutExtension.intercept(TimeoutExtension.java:161)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestableMethod(TimeoutExtension.java:152)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestMethod(TimeoutExtension.java:91)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker$ReflectiveInterceptorCall.lambda$ofVoidMethod$0(InterceptingExecutableInvoker.java:112)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.lambda$invoke$0(InterceptingExecutableInvoker.java:94)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$InterceptedInvocation.proceed(InvocationInterceptorChain.java:106)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.proceed(InvocationInterceptorChain.java:64)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.chainAndInvoke(InvocationInterceptorChain.java:45)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.invoke(InvocationInterceptorChain.java:37)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.invoke(InterceptingExecutableInvoker.java:93)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.invoke(InterceptingExecutableInvoker.java:87)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeTestMethod$7(TestMethodTestDescriptor.java:216)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeTestMethod(TestMethodTestDescriptor.java:212)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:137)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:69)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:156)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:146)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:144)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:143)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:100)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:160)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:146)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:144)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:143)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:100)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:160)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:146)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:144)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:143)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:100)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:35)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:201)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:170)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:94)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:59)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:142)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:58)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:103)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:94)
	at org.junit.platform.launcher.core.DelegatingLauncher.execute(DelegatingLauncher.java:52)
	at org.junit.platform.launcher.core.InterceptingLauncher.lambda$execute$2(InterceptingLauncher.java:47)
	at org.junit.platform.launcher.core.ClasspathAlignmentCheckingLauncherInterceptor.intercept(ClasspathAlignmentCheckingLauncherInterceptor.java:25)
	at org.junit.platform.launcher.core.InterceptingLauncher.execute(InterceptingLauncher.java:46)
	at org.junit.platform.launcher.core.DelegatingLauncher.execute(DelegatingLauncher.java:52)
	at org.junit.platform.launcher.core.SessionPerRequestLauncher.execute(SessionPerRequestLauncher.java:70)
	at org.eclipse.jdt.internal.junit5.runner.JUnit5TestReference.run(JUnit5TestReference.java:100)
	at org.eclipse.jdt.internal.junit.runner.TestExecution.run(TestExecution.java:40)
	at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:520)
	at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:748)
	at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:443)
	at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.main(RemoteTestRunner.java:211)
2025-08-04 07:46:31.982 [main] WARN  [] [] c.j.p.i.c.GlobalExceptionHandler - [ERROR_LECTURA_CSV] Error de validación CSV: Archivo CSV ilegible o mal formateado: Unterminated quoted field at end of CSV line. Beginning of lost text: [P001,CLI-123,2099-08-10
]
2025-08-04 07:46:31.994 [main] DEBUG [] [] org.hibernate.SQL - select c1_0.id,c1_0.nombre from cliente c1_0 where c1_0.id=?
2025-08-04 07:46:31.996 [main] DEBUG [] [] org.hibernate.SQL - select z1_0.id,z1_0.soporte_refrigeracion from zona z1_0 where z1_0.id=?
2025-08-04 07:46:32.000 [main] INFO  [] [HTTP_REQUEST] c.j.p.i.controller.PedidoController - [INICIO_CARGA_CSV] POST /pedidos/cargar - Request ID: c6be4316 - Archivo: pedidos.csv - Tamaño: 0 bytes
2025-08-04 07:46:32.000 [main] WARN  [] [HTTP_REQUEST] c.j.p.i.controller.PedidoController - [ARCHIVO_VACIO] Request ID: c6be4316 - Archivo vacío recibido
2025-08-04 07:46:32.001 [main] WARN  [] [] c.j.p.i.c.GlobalExceptionHandler - [ERROR_LECTURA_CSV] Error de validación CSV: El archivo está vacío
2025-08-04 07:46:32.011 [main] DEBUG [] [] org.hibernate.SQL - select c1_0.id,c1_0.nombre from cliente c1_0 where c1_0.id=?
2025-08-04 07:46:32.015 [main] DEBUG [] [] org.hibernate.SQL - select z1_0.id,z1_0.soporte_refrigeracion from zona z1_0 where z1_0.id=?
2025-08-04 07:46:32.018 [main] INFO  [] [HTTP_REQUEST] c.j.p.i.controller.PedidoController - [INICIO_CARGA_CSV] POST /pedidos/cargar - Request ID: 4dc7cc9d - Archivo: pedidos.csv - Tamaño: 147 bytes
2025-08-04 07:46:32.019 [main] INFO  [] [CARGA_CSV] c.j.p.a.usecase.CargarPedidosUseCase - [INICIO_CARGA_CSV] Iniciando procesamiento de archivo: pedidos.csv (tamaño: 147 bytes)
2025-08-04 07:46:32.019 [main] INFO  [] [CARGA_CSV] c.j.p.a.usecase.CargarPedidosUseCase - [INICIO_CARGA_CSV] Procesando 1 filas de datos (excluyendo cabecera)
2025-08-04 07:46:32.019 [main] DEBUG [P001] [CARGA_CSV] c.j.p.a.usecase.CargarPedidosUseCase - [INICIO_VALIDACION] Iniciando validación completa de pedido: P001
2025-08-04 07:46:32.019 [main] INFO  [P001] [CARGA_CSV] c.j.p.domain.service.PedidoValidator - [INICIO_VALIDACION] Validando número de pedido: P001
2025-08-04 07:46:32.020 [main] DEBUG [P001] [CARGA_CSV] org.hibernate.SQL - select count(*) from pedido p1_0 where p1_0.numero_pedido=?
2025-08-04 07:46:32.022 [main] WARN  [P001] [CARGA_CSV] c.j.p.domain.service.PedidoValidator - [PEDIDO_INVALIDO] Número de pedido duplicado en base de datos: P001
2025-08-04 07:46:32.022 [main] DEBUG [P001] [CARGA_CSV] c.j.p.d.service.ClienteValidator - [INICIO_VALIDACION] Validando cliente: CLI-INEXISTENTE
2025-08-04 07:46:32.024 [main] DEBUG [P001] [CARGA_CSV] org.hibernate.SQL - select c1_0.id,c1_0.nombre from cliente c1_0 where c1_0.id=?
2025-08-04 07:46:32.024 [main] WARN  [P001] [CARGA_CSV] c.j.p.d.service.ClienteValidator - [PEDIDO_INVALIDO] Cliente no encontrado en base de datos: CLI-INEXISTENTE
2025-08-04 07:46:32.024 [main] DEBUG [P001] [CARGA_CSV] c.j.p.domain.service.FechaValidator - [INICIO_VALIDACION] Validando fecha de entrega: 2020-01-01
2025-08-04 07:46:32.025 [main] WARN  [P001] [CARGA_CSV] c.j.p.domain.service.FechaValidator - [PEDIDO_INVALIDO] Fecha de entrega en el pasado: 2020-01-01 (hoy: 2025-08-04)
2025-08-04 07:46:32.025 [main] DEBUG [P001] [CARGA_CSV] c.j.p.domain.service.EstadoValidator - [INICIO_VALIDACION] Validando estado: ESTADO_INVALIDO
2025-08-04 07:46:32.025 [main] WARN  [P001] [CARGA_CSV] c.j.p.domain.service.EstadoValidator - [PEDIDO_INVALIDO] Estado inválido: ESTADO_INVALIDO. Estados válidos: PENDIENTE, CONFIRMADO, ENTREGADO
2025-08-04 07:46:32.025 [main] DEBUG [P001] [CARGA_CSV] c.j.p.domain.service.ZonaValidator - [INICIO_VALIDACION] Validando zona: ZONA_INEXISTENTE con refrigeración: true
2025-08-04 07:46:32.026 [main] DEBUG [P001] [CARGA_CSV] org.hibernate.SQL - select z1_0.id,z1_0.soporte_refrigeracion from zona z1_0 where z1_0.id=?
2025-08-04 07:46:32.028 [main] WARN  [P001] [CARGA_CSV] c.j.p.domain.service.ZonaValidator - [PEDIDO_INVALIDO] Zona no encontrada en base de datos: ZONA_INEXISTENTE
2025-08-04 07:46:32.028 [main] INFO  [P001] [CARGA_CSV] c.j.p.a.usecase.CargarPedidosUseCase - [ESTADISTICAS_VALIDACION] Validación completada con 5 errores: [Número de pedido duplicado, Clientes no encontrados, Fecha de entrega inválida, Estado inválido, Zonas inválidas]
2025-08-04 07:46:32.028 [main] WARN  [P001] [CARGA_CSV] c.j.p.a.usecase.CargarPedidosUseCase - [PEDIDO_INVALIDO] Pedido con 5 errores de validación
2025-08-04 07:46:32.028 [main] INFO  [] [] c.j.p.a.usecase.CargarPedidosUseCase - [RESUMEN_PROCESAMIENTO] Procesamiento completado - Total: 1, Guardados: 0, Errores: 5
2025-08-04 07:46:32.028 [main] INFO  [] [] c.j.p.i.controller.PedidoController - [FIN_CARGA_CSV] Request ID: 4dc7cc9d - Procesamiento completado en 9ms - Total: 1, Guardados: 0, Tipos de errores: 5
2025-08-04 07:46:32.029 [main] WARN  [] [] c.j.p.i.controller.PedidoController - [ESTADISTICAS_VALIDACION] Request ID: 4dc7cc9d - Errores de validación encontrados: 5 errores totales
2025-08-04 07:46:32.044 [main] DEBUG [] [] org.hibernate.SQL - select c1_0.id,c1_0.nombre from cliente c1_0 where c1_0.id=?
2025-08-04 07:46:32.048 [main] DEBUG [] [] org.hibernate.SQL - select z1_0.id,z1_0.soporte_refrigeracion from zona z1_0 where z1_0.id=?
2025-08-04 07:46:32.052 [main] INFO  [] [HTTP_REQUEST] c.j.p.i.controller.PedidoController - [INICIO_CARGA_CSV] POST /pedidos/cargar - Request ID: c5d354eb - Archivo: pedidos.txt - Tamaño: 9 bytes
2025-08-04 07:46:32.053 [main] WARN  [] [HTTP_REQUEST] c.j.p.i.controller.PedidoController - [ERROR_LECTURA_CSV] Request ID: c5d354eb - Formato de archivo inválido: pedidos.txt
2025-08-04 07:46:32.054 [main] WARN  [] [] c.j.p.i.c.GlobalExceptionHandler - [ERROR_LECTURA_CSV] Error de validación CSV: Solo se permiten archivos CSV
2025-08-04 07:46:32.070 [main] DEBUG [] [] org.hibernate.SQL - select c1_0.id,c1_0.nombre from cliente c1_0 where c1_0.id=?
2025-08-04 07:46:32.074 [main] DEBUG [] [] org.hibernate.SQL - select z1_0.id,z1_0.soporte_refrigeracion from zona z1_0 where z1_0.id=?
2025-08-04 07:46:32.077 [main] INFO  [] [HTTP_REQUEST] c.j.p.i.controller.PedidoController - [INICIO_CARGA_CSV] POST /pedidos/cargar - Request ID: a0ec49ac - Archivo: pedidos.csv - Tamaño: 186 bytes
2025-08-04 07:46:32.077 [main] INFO  [] [CARGA_CSV] c.j.p.a.usecase.CargarPedidosUseCase - [INICIO_CARGA_CSV] Iniciando procesamiento de archivo: pedidos.csv (tamaño: 186 bytes)
2025-08-04 07:46:32.078 [main] INFO  [] [CARGA_CSV] c.j.p.a.usecase.CargarPedidosUseCase - [INICIO_CARGA_CSV] Procesando 2 filas de datos (excluyendo cabecera)
2025-08-04 07:46:32.078 [main] DEBUG [P001] [CARGA_CSV] c.j.p.a.usecase.CargarPedidosUseCase - [INICIO_VALIDACION] Iniciando validación completa de pedido: P001
2025-08-04 07:46:32.078 [main] INFO  [P001] [CARGA_CSV] c.j.p.domain.service.PedidoValidator - [INICIO_VALIDACION] Validando número de pedido: P001
2025-08-04 07:46:32.080 [main] DEBUG [P001] [CARGA_CSV] org.hibernate.SQL - select count(*) from pedido p1_0 where p1_0.numero_pedido=?
2025-08-04 07:46:32.080 [main] WARN  [P001] [CARGA_CSV] c.j.p.domain.service.PedidoValidator - [PEDIDO_INVALIDO] Número de pedido duplicado en base de datos: P001
2025-08-04 07:46:32.080 [main] DEBUG [P001] [CARGA_CSV] c.j.p.d.service.ClienteValidator - [INICIO_VALIDACION] Validando cliente: CLI-123
2025-08-04 07:46:32.081 [main] DEBUG [P001] [CARGA_CSV] org.hibernate.SQL - select c1_0.id,c1_0.nombre from cliente c1_0 where c1_0.id=?
2025-08-04 07:46:32.081 [main] DEBUG [P001] [CARGA_CSV] c.j.p.d.service.ClienteValidator - [PEDIDO_VALIDO] Cliente válido encontrado: CLI-123 - Test Cliente
2025-08-04 07:46:32.081 [main] DEBUG [P001] [CARGA_CSV] c.j.p.domain.service.FechaValidator - [INICIO_VALIDACION] Validando fecha de entrega: 2099-08-10
2025-08-04 07:46:32.081 [main] DEBUG [P001] [CARGA_CSV] c.j.p.domain.service.FechaValidator - [PEDIDO_VALIDO] Fecha de entrega válida: 2099-08-10 (días desde hoy: 27034)
2025-08-04 07:46:32.081 [main] DEBUG [P001] [CARGA_CSV] c.j.p.domain.service.EstadoValidator - [INICIO_VALIDACION] Validando estado: PENDIENTE
2025-08-04 07:46:32.081 [main] DEBUG [P001] [CARGA_CSV] c.j.p.domain.service.EstadoValidator - [PEDIDO_VALIDO] Estado válido: PENDIENTE
2025-08-04 07:46:32.081 [main] DEBUG [P001] [CARGA_CSV] c.j.p.domain.service.ZonaValidator - [INICIO_VALIDACION] Validando zona: ZONA1 con refrigeración: true
2025-08-04 07:46:32.082 [main] DEBUG [P001] [CARGA_CSV] org.hibernate.SQL - select z1_0.id,z1_0.soporte_refrigeracion from zona z1_0 where z1_0.id=?
2025-08-04 07:46:32.082 [main] DEBUG [P001] [CARGA_CSV] c.j.p.domain.service.ZonaValidator - [PEDIDO_VALIDO] Zona válida: ZONA1 - Soporte refrigeración: true - Requerido: true
2025-08-04 07:46:32.082 [main] INFO  [P001] [CARGA_CSV] c.j.p.a.usecase.CargarPedidosUseCase - [ESTADISTICAS_VALIDACION] Validación completada con 1 errores: [Número de pedido duplicado]
2025-08-04 07:46:32.082 [main] WARN  [P001] [CARGA_CSV] c.j.p.a.usecase.CargarPedidosUseCase - [PEDIDO_INVALIDO] Pedido con 1 errores de validación
2025-08-04 07:46:32.082 [main] DEBUG [P002] [CARGA_CSV] c.j.p.a.usecase.CargarPedidosUseCase - [INICIO_VALIDACION] Iniciando validación completa de pedido: P002
2025-08-04 07:46:32.082 [main] INFO  [P002] [CARGA_CSV] c.j.p.domain.service.PedidoValidator - [INICIO_VALIDACION] Validando número de pedido: P002
2025-08-04 07:46:32.083 [main] DEBUG [P002] [CARGA_CSV] org.hibernate.SQL - select count(*) from pedido p1_0 where p1_0.numero_pedido=?
2025-08-04 07:46:32.083 [main] DEBUG [P002] [CARGA_CSV] c.j.p.domain.service.PedidoValidator - [PEDIDO_VALIDO] Número de pedido único y válido: P002
2025-08-04 07:46:32.083 [main] DEBUG [P002] [CARGA_CSV] c.j.p.d.service.ClienteValidator - [INICIO_VALIDACION] Validando cliente: CLI-INEXISTENTE
2025-08-04 07:46:32.084 [main] DEBUG [P002] [CARGA_CSV] org.hibernate.SQL - select c1_0.id,c1_0.nombre from cliente c1_0 where c1_0.id=?
2025-08-04 07:46:32.084 [main] WARN  [P002] [CARGA_CSV] c.j.p.d.service.ClienteValidator - [PEDIDO_INVALIDO] Cliente no encontrado en base de datos: CLI-INEXISTENTE
2025-08-04 07:46:32.084 [main] DEBUG [P002] [CARGA_CSV] c.j.p.domain.service.FechaValidator - [INICIO_VALIDACION] Validando fecha de entrega: 2020-01-01
2025-08-04 07:46:32.084 [main] WARN  [P002] [CARGA_CSV] c.j.p.domain.service.FechaValidator - [PEDIDO_INVALIDO] Fecha de entrega en el pasado: 2020-01-01 (hoy: 2025-08-04)
2025-08-04 07:46:32.084 [main] DEBUG [P002] [CARGA_CSV] c.j.p.domain.service.EstadoValidator - [INICIO_VALIDACION] Validando estado: INVALIDO
2025-08-04 07:46:32.085 [main] WARN  [P002] [CARGA_CSV] c.j.p.domain.service.EstadoValidator - [PEDIDO_INVALIDO] Estado inválido: INVALIDO. Estados válidos: PENDIENTE, CONFIRMADO, ENTREGADO
2025-08-04 07:46:32.085 [main] DEBUG [P002] [CARGA_CSV] c.j.p.domain.service.ZonaValidator - [INICIO_VALIDACION] Validando zona: ZONA_INEXISTENTE con refrigeración: false
2025-08-04 07:46:32.086 [main] DEBUG [P002] [CARGA_CSV] org.hibernate.SQL - select z1_0.id,z1_0.soporte_refrigeracion from zona z1_0 where z1_0.id=?
2025-08-04 07:46:32.086 [main] WARN  [P002] [CARGA_CSV] c.j.p.domain.service.ZonaValidator - [PEDIDO_INVALIDO] Zona no encontrada en base de datos: ZONA_INEXISTENTE
2025-08-04 07:46:32.086 [main] INFO  [P002] [CARGA_CSV] c.j.p.a.usecase.CargarPedidosUseCase - [ESTADISTICAS_VALIDACION] Validación completada con 4 errores: [Clientes no encontrados, Fecha de entrega inválida, Estado inválido, Zonas inválidas]
2025-08-04 07:46:32.086 [main] WARN  [P002] [CARGA_CSV] c.j.p.a.usecase.CargarPedidosUseCase - [PEDIDO_INVALIDO] Pedido con 4 errores de validación
2025-08-04 07:46:32.086 [main] INFO  [] [] c.j.p.a.usecase.CargarPedidosUseCase - [RESUMEN_PROCESAMIENTO] Procesamiento completado - Total: 2, Guardados: 0, Errores: 5
2025-08-04 07:46:32.086 [main] INFO  [] [] c.j.p.i.controller.PedidoController - [FIN_CARGA_CSV] Request ID: a0ec49ac - Procesamiento completado en 9ms - Total: 2, Guardados: 0, Tipos de errores: 5
2025-08-04 07:46:32.086 [main] WARN  [] [] c.j.p.i.controller.PedidoController - [ESTADISTICAS_VALIDACION] Request ID: a0ec49ac - Errores de validación encontrados: 5 errores totales
2025-08-04 07:46:32.116 [SpringApplicationShutdownHook] INFO  [] [] o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-08-04 07:46:32.117 [SpringApplicationShutdownHook] DEBUG [] [] org.hibernate.SQL - drop table if exists cliente cascade 
2025-08-04 07:46:32.118 [SpringApplicationShutdownHook] DEBUG [] [] org.hibernate.SQL - drop table if exists pedido cascade 
2025-08-04 07:46:32.119 [SpringApplicationShutdownHook] DEBUG [] [] org.hibernate.SQL - drop table if exists zona cascade 
2025-08-04 07:46:32.122 [SpringApplicationShutdownHook] INFO  [] [] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-08-04 07:46:32.127 [SpringApplicationShutdownHook] INFO  [] [] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-08-04 07:47:04.583 [main] INFO  [] [] c.j.p.i.c.PedidoControllerHttpStatusTest - Starting PedidoControllerHttpStatusTest using Java 17.0.15 with PID 96831 (started by josuepatricio in /Users/josuepatricio/Downloads/pedidos-ms)
2025-08-04 07:47:04.584 [main] DEBUG [] [] c.j.p.i.c.PedidoControllerHttpStatusTest - Running with Spring Boot v3.5.4, Spring v6.2.9
2025-08-04 07:47:04.584 [main] INFO  [] [] c.j.p.i.c.PedidoControllerHttpStatusTest - The following 1 profile is active: "test"
2025-08-04 07:47:05.064 [main] INFO  [] [] o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-08-04 07:47:05.094 [main] INFO  [] [] o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 24 ms. Found 3 JPA repository interfaces.
2025-08-04 07:47:05.483 [main] INFO  [] [] o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-08-04 07:47:05.497 [main] INFO  [] [] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-08-04 07:47:05.580 [main] INFO  [] [] com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:testdb user=SA
2025-08-04 07:47:05.581 [main] INFO  [] [] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-08-04 07:47:05.594 [main] WARN  [] [] org.hibernate.orm.deprecation - HHH90000025: H2Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-08-04 07:47:06.003 [main] DEBUG [] [] org.hibernate.SQL - drop table if exists cliente cascade 
2025-08-04 07:47:06.005 [main] DEBUG [] [] org.hibernate.SQL - drop table if exists pedido cascade 
2025-08-04 07:47:06.005 [main] DEBUG [] [] org.hibernate.SQL - drop table if exists zona cascade 
2025-08-04 07:47:06.007 [main] DEBUG [] [] org.hibernate.SQL - create table cliente (id varchar(255) not null, nombre varchar(255), primary key (id))
2025-08-04 07:47:06.010 [main] DEBUG [] [] org.hibernate.SQL - create table pedido (fecha_entrega date, requiere_refrigeracion boolean not null, cliente_id varchar(255) not null, numero_pedido varchar(255) not null, zona_entrega varchar(255) not null, estado enum ('CONFIRMADO','ENTREGADO','PENDIENTE'), primary key (numero_pedido))
2025-08-04 07:47:06.011 [main] DEBUG [] [] org.hibernate.SQL - create table zona (soporte_refrigeracion boolean not null, id varchar(255) not null, primary key (id))
2025-08-04 07:47:06.012 [main] DEBUG [] [] org.hibernate.SQL - alter table if exists pedido add constraint FK30s8j2ktpay6of18lbyqn3632 foreign key (cliente_id) references cliente
2025-08-04 07:47:06.017 [main] DEBUG [] [] org.hibernate.SQL - alter table if exists pedido add constraint FK1aokin5yjk78h5cax5jju4fs9 foreign key (zona_entrega) references zona
2025-08-04 07:47:06.020 [main] INFO  [] [] o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-08-04 07:47:06.357 [main] DEBUG [] [] org.hibernate.SQL - select count(*) from cliente c1_0
2025-08-04 07:47:06.402 [main] DEBUG [] [] org.hibernate.SQL - select c1_0.id,c1_0.nombre from cliente c1_0 where c1_0.id=?
2025-08-04 07:47:06.415 [main] DEBUG [] [] org.hibernate.SQL - insert into cliente (nombre,id) values (?,?)
2025-08-04 07:47:06.421 [main] DEBUG [] [] org.hibernate.SQL - select c1_0.id,c1_0.nombre from cliente c1_0 where c1_0.id=?
2025-08-04 07:47:06.422 [main] DEBUG [] [] org.hibernate.SQL - insert into cliente (nombre,id) values (?,?)
2025-08-04 07:47:06.424 [main] DEBUG [] [] org.hibernate.SQL - select count(*) from zona z1_0
2025-08-04 07:47:06.425 [main] DEBUG [] [] org.hibernate.SQL - select z1_0.id,z1_0.soporte_refrigeracion from zona z1_0 where z1_0.id=?
2025-08-04 07:47:06.426 [main] DEBUG [] [] org.hibernate.SQL - insert into zona (soporte_refrigeracion,id) values (?,?)
2025-08-04 07:47:06.427 [main] DEBUG [] [] org.hibernate.SQL - select z1_0.id,z1_0.soporte_refrigeracion from zona z1_0 where z1_0.id=?
2025-08-04 07:47:06.427 [main] DEBUG [] [] org.hibernate.SQL - insert into zona (soporte_refrigeracion,id) values (?,?)
2025-08-04 07:47:06.482 [main] WARN  [] [] o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-08-04 07:47:06.733 [main] INFO  [] [] o.s.b.a.h.H2ConsoleAutoConfiguration - H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:testdb'
2025-08-04 07:47:06.752 [main] INFO  [] [] o.s.b.t.m.w.SpringBootMockServletContext - Initializing Spring TestDispatcherServlet ''
2025-08-04 07:47:06.752 [main] INFO  [] [] o.s.t.w.s.TestDispatcherServlet - Initializing Servlet ''
2025-08-04 07:47:06.756 [main] INFO  [] [] o.s.b.a.e.web.EndpointLinksResolver - Exposing 1 endpoint beneath base path '/actuator'
2025-08-04 07:47:06.766 [main] INFO  [] [] o.s.t.w.s.TestDispatcherServlet - Completed initialization in 14 ms
2025-08-04 07:47:06.813 [main] INFO  [] [] c.j.p.i.c.PedidoControllerHttpStatusTest - Started PedidoControllerHttpStatusTest in 2.445 seconds (process running for 2.937)
2025-08-04 07:47:07.084 [main] DEBUG [] [] org.hibernate.SQL - select c1_0.id,c1_0.nombre from cliente c1_0 where c1_0.id=?
2025-08-04 07:47:07.087 [main] DEBUG [] [] org.hibernate.SQL - update cliente set nombre=? where id=?
2025-08-04 07:47:07.090 [main] DEBUG [] [] org.hibernate.SQL - select z1_0.id,z1_0.soporte_refrigeracion from zona z1_0 where z1_0.id=?
2025-08-04 07:47:07.120 [main] INFO  [] [HTTP_REQUEST] c.j.p.i.controller.PedidoController - [INICIO_CARGA_CSV] POST /pedidos/cargar - Request ID: f8fe5311 - Archivo: pedidos.csv - Tamaño: 186 bytes
2025-08-04 07:47:07.120 [main] INFO  [] [CARGA_CSV] c.j.p.a.usecase.CargarPedidosUseCase - [INICIO_CARGA_CSV] Iniciando procesamiento de archivo: pedidos.csv (tamaño: 186 bytes)
2025-08-04 07:47:07.127 [main] INFO  [] [CARGA_CSV] c.j.p.a.usecase.CargarPedidosUseCase - [INICIO_CARGA_CSV] Procesando 2 filas de datos (excluyendo cabecera)
2025-08-04 07:47:07.127 [main] DEBUG [P001] [CARGA_CSV] c.j.p.a.usecase.CargarPedidosUseCase - [INICIO_VALIDACION] Iniciando validación completa de pedido: P001
2025-08-04 07:47:07.127 [main] INFO  [P001] [CARGA_CSV] c.j.p.domain.service.PedidoValidator - [INICIO_VALIDACION] Validando número de pedido: P001
2025-08-04 07:47:07.168 [main] DEBUG [P001] [CARGA_CSV] org.hibernate.SQL - select count(*) from pedido p1_0 where p1_0.numero_pedido=?
2025-08-04 07:47:07.170 [main] DEBUG [P001] [CARGA_CSV] c.j.p.domain.service.PedidoValidator - [PEDIDO_VALIDO] Número de pedido único y válido: P001
2025-08-04 07:47:07.170 [main] DEBUG [P001] [CARGA_CSV] c.j.p.d.service.ClienteValidator - [INICIO_VALIDACION] Validando cliente: CLI-123
2025-08-04 07:47:07.170 [main] DEBUG [P001] [CARGA_CSV] org.hibernate.SQL - select c1_0.id,c1_0.nombre from cliente c1_0 where c1_0.id=?
2025-08-04 07:47:07.171 [main] DEBUG [P001] [CARGA_CSV] c.j.p.d.service.ClienteValidator - [PEDIDO_VALIDO] Cliente válido encontrado: CLI-123 - Test Cliente
2025-08-04 07:47:07.171 [main] DEBUG [P001] [CARGA_CSV] c.j.p.domain.service.FechaValidator - [INICIO_VALIDACION] Validando fecha de entrega: 2099-08-10
2025-08-04 07:47:07.172 [main] DEBUG [P001] [CARGA_CSV] c.j.p.domain.service.FechaValidator - [PEDIDO_VALIDO] Fecha de entrega válida: 2099-08-10 (días desde hoy: 27034)
2025-08-04 07:47:07.172 [main] DEBUG [P001] [CARGA_CSV] c.j.p.domain.service.EstadoValidator - [INICIO_VALIDACION] Validando estado: PENDIENTE
2025-08-04 07:47:07.172 [main] DEBUG [P001] [CARGA_CSV] c.j.p.domain.service.EstadoValidator - [PEDIDO_VALIDO] Estado válido: PENDIENTE
2025-08-04 07:47:07.172 [main] DEBUG [P001] [CARGA_CSV] c.j.p.domain.service.ZonaValidator - [INICIO_VALIDACION] Validando zona: ZONA1 con refrigeración: true
2025-08-04 07:47:07.172 [main] DEBUG [P001] [CARGA_CSV] org.hibernate.SQL - select z1_0.id,z1_0.soporte_refrigeracion from zona z1_0 where z1_0.id=?
2025-08-04 07:47:07.173 [main] DEBUG [P001] [CARGA_CSV] c.j.p.domain.service.ZonaValidator - [PEDIDO_VALIDO] Zona válida: ZONA1 - Soporte refrigeración: true - Requerido: true
2025-08-04 07:47:07.173 [main] DEBUG [P001] [CARGA_CSV] c.j.p.a.usecase.CargarPedidosUseCase - [PEDIDO_VALIDO] Todas las validaciones pasaron exitosamente
2025-08-04 07:47:07.173 [main] DEBUG [P001] [CONVERSION] c.j.p.a.usecase.CargarPedidosUseCase - [PEDIDO_PROCESADO] Convirtiendo DTO a entidad de dominio: P001
2025-08-04 07:47:07.174 [main] DEBUG [P001] [CONVERSION] c.j.p.a.usecase.CargarPedidosUseCase - [PEDIDO_PROCESADO] Conversión exitosa - Pedido: P001, Cliente: CLI-123, Fecha: 2099-08-10, Estado: PENDIENTE, Zona: ZONA1, Refrigeración: true
2025-08-04 07:47:07.174 [main] DEBUG [P001] [CONVERSION] c.j.p.a.usecase.CargarPedidosUseCase - [PEDIDO_PROCESADO] Pedido válido agregado para guardado: P001
2025-08-04 07:47:07.174 [main] DEBUG [P002] [CONVERSION] c.j.p.a.usecase.CargarPedidosUseCase - [INICIO_VALIDACION] Iniciando validación completa de pedido: P002
2025-08-04 07:47:07.174 [main] INFO  [P002] [CONVERSION] c.j.p.domain.service.PedidoValidator - [INICIO_VALIDACION] Validando número de pedido: P002
2025-08-04 07:47:07.175 [main] DEBUG [P002] [CONVERSION] org.hibernate.SQL - select count(*) from pedido p1_0 where p1_0.numero_pedido=?
2025-08-04 07:47:07.175 [main] DEBUG [P002] [CONVERSION] c.j.p.domain.service.PedidoValidator - [PEDIDO_VALIDO] Número de pedido único y válido: P002
2025-08-04 07:47:07.175 [main] DEBUG [P002] [CONVERSION] c.j.p.d.service.ClienteValidator - [INICIO_VALIDACION] Validando cliente: CLI-INEXISTENTE
2025-08-04 07:47:07.176 [main] DEBUG [P002] [CONVERSION] org.hibernate.SQL - select c1_0.id,c1_0.nombre from cliente c1_0 where c1_0.id=?
2025-08-04 07:47:07.176 [main] WARN  [P002] [CONVERSION] c.j.p.d.service.ClienteValidator - [PEDIDO_INVALIDO] Cliente no encontrado en base de datos: CLI-INEXISTENTE
2025-08-04 07:47:07.176 [main] DEBUG [P002] [CONVERSION] c.j.p.domain.service.FechaValidator - [INICIO_VALIDACION] Validando fecha de entrega: 2020-01-01
2025-08-04 07:47:07.176 [main] WARN  [P002] [CONVERSION] c.j.p.domain.service.FechaValidator - [PEDIDO_INVALIDO] Fecha de entrega en el pasado: 2020-01-01 (hoy: 2025-08-04)
2025-08-04 07:47:07.176 [main] DEBUG [P002] [CONVERSION] c.j.p.domain.service.EstadoValidator - [INICIO_VALIDACION] Validando estado: INVALIDO
2025-08-04 07:47:07.176 [main] WARN  [P002] [CONVERSION] c.j.p.domain.service.EstadoValidator - [PEDIDO_INVALIDO] Estado inválido: INVALIDO. Estados válidos: PENDIENTE, CONFIRMADO, ENTREGADO
2025-08-04 07:47:07.176 [main] DEBUG [P002] [CONVERSION] c.j.p.domain.service.ZonaValidator - [INICIO_VALIDACION] Validando zona: ZONA_INEXISTENTE con refrigeración: false
2025-08-04 07:47:07.177 [main] DEBUG [P002] [CONVERSION] org.hibernate.SQL - select z1_0.id,z1_0.soporte_refrigeracion from zona z1_0 where z1_0.id=?
2025-08-04 07:47:07.177 [main] WARN  [P002] [CONVERSION] c.j.p.domain.service.ZonaValidator - [PEDIDO_INVALIDO] Zona no encontrada en base de datos: ZONA_INEXISTENTE
2025-08-04 07:47:07.177 [main] INFO  [P002] [CONVERSION] c.j.p.a.usecase.CargarPedidosUseCase - [ESTADISTICAS_VALIDACION] Validación completada con 4 errores: [Clientes no encontrados, Fecha de entrega inválida, Estado inválido, Zonas inválidas]
2025-08-04 07:47:07.177 [main] WARN  [P002] [CONVERSION] c.j.p.a.usecase.CargarPedidosUseCase - [PEDIDO_INVALIDO] Pedido con 4 errores de validación
2025-08-04 07:47:07.177 [main] INFO  [P002] [PERSISTENCIA] c.j.p.a.usecase.CargarPedidosUseCase - [PEDIDO_GUARDADO] Guardando 1 pedidos válidos en base de datos
2025-08-04 07:47:07.178 [main] DEBUG [P002] [PERSISTENCIA] org.hibernate.SQL - select p1_0.numero_pedido,p1_0.cliente_id,c1_0.id,c1_0.nombre,p1_0.estado,p1_0.fecha_entrega,p1_0.requiere_refrigeracion,p1_0.zona_entrega,ze1_0.id,ze1_0.soporte_refrigeracion from pedido p1_0 join cliente c1_0 on c1_0.id=p1_0.cliente_id join zona ze1_0 on ze1_0.id=p1_0.zona_entrega where p1_0.numero_pedido=?
2025-08-04 07:47:07.180 [main] DEBUG [P002] [PERSISTENCIA] org.hibernate.SQL - insert into pedido (cliente_id,estado,fecha_entrega,requiere_refrigeracion,zona_entrega,numero_pedido) values (?,?,?,?,?,?)
2025-08-04 07:47:07.181 [main] INFO  [P002] [PERSISTENCIA] c.j.p.a.usecase.CargarPedidosUseCase - [PEDIDO_GUARDADO] Guardados exitosamente 1 pedidos
2025-08-04 07:47:07.182 [main] INFO  [] [] c.j.p.a.usecase.CargarPedidosUseCase - [RESUMEN_PROCESAMIENTO] Procesamiento completado - Total: 2, Guardados: 1, Errores: 4
2025-08-04 07:47:07.182 [main] INFO  [] [] c.j.p.i.controller.PedidoController - [FIN_CARGA_CSV] Request ID: f8fe5311 - Procesamiento completado en 62ms - Total: 2, Guardados: 1, Tipos de errores: 4
2025-08-04 07:47:07.182 [main] WARN  [] [] c.j.p.i.controller.PedidoController - [ESTADISTICAS_VALIDACION] Request ID: f8fe5311 - Errores de validación encontrados: 4 errores totales
2025-08-04 07:47:07.255 [SpringApplicationShutdownHook] INFO  [] [] o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-08-04 07:47:07.255 [SpringApplicationShutdownHook] DEBUG [] [] org.hibernate.SQL - drop table if exists cliente cascade 
2025-08-04 07:47:07.256 [SpringApplicationShutdownHook] DEBUG [] [] org.hibernate.SQL - drop table if exists pedido cascade 
2025-08-04 07:47:07.258 [SpringApplicationShutdownHook] DEBUG [] [] org.hibernate.SQL - drop table if exists zona cascade 
2025-08-04 07:47:07.259 [SpringApplicationShutdownHook] INFO  [] [] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-08-04 07:47:07.260 [SpringApplicationShutdownHook] INFO  [] [] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-08-04 07:47:20.206 [main] INFO  [] [] c.j.p.i.c.PedidoControllerHttpStatusTest - Starting PedidoControllerHttpStatusTest using Java 17.0.15 with PID 96982 (started by josuepatricio in /Users/josuepatricio/Downloads/pedidos-ms)
2025-08-04 07:47:20.206 [main] DEBUG [] [] c.j.p.i.c.PedidoControllerHttpStatusTest - Running with Spring Boot v3.5.4, Spring v6.2.9
2025-08-04 07:47:20.207 [main] INFO  [] [] c.j.p.i.c.PedidoControllerHttpStatusTest - The following 1 profile is active: "test"
2025-08-04 07:47:20.747 [main] INFO  [] [] o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-08-04 07:47:20.787 [main] INFO  [] [] o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 32 ms. Found 3 JPA repository interfaces.
2025-08-04 07:47:21.265 [main] INFO  [] [] o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-08-04 07:47:21.285 [main] INFO  [] [] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-08-04 07:47:21.415 [main] INFO  [] [] com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:testdb user=SA
2025-08-04 07:47:21.417 [main] INFO  [] [] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-08-04 07:47:21.431 [main] WARN  [] [] org.hibernate.orm.deprecation - HHH90000025: H2Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-08-04 07:47:22.012 [main] DEBUG [] [] org.hibernate.SQL - drop table if exists cliente cascade 
2025-08-04 07:47:22.017 [main] DEBUG [] [] org.hibernate.SQL - drop table if exists pedido cascade 
2025-08-04 07:47:22.018 [main] DEBUG [] [] org.hibernate.SQL - drop table if exists zona cascade 
2025-08-04 07:47:22.023 [main] DEBUG [] [] org.hibernate.SQL - create table cliente (id varchar(255) not null, nombre varchar(255), primary key (id))
2025-08-04 07:47:22.028 [main] DEBUG [] [] org.hibernate.SQL - create table pedido (fecha_entrega date, requiere_refrigeracion boolean not null, cliente_id varchar(255) not null, numero_pedido varchar(255) not null, zona_entrega varchar(255) not null, estado enum ('CONFIRMADO','ENTREGADO','PENDIENTE'), primary key (numero_pedido))
2025-08-04 07:47:22.029 [main] DEBUG [] [] org.hibernate.SQL - create table zona (soporte_refrigeracion boolean not null, id varchar(255) not null, primary key (id))
2025-08-04 07:47:22.031 [main] DEBUG [] [] org.hibernate.SQL - alter table if exists pedido add constraint FK30s8j2ktpay6of18lbyqn3632 foreign key (cliente_id) references cliente
2025-08-04 07:47:22.038 [main] DEBUG [] [] org.hibernate.SQL - alter table if exists pedido add constraint FK1aokin5yjk78h5cax5jju4fs9 foreign key (zona_entrega) references zona
2025-08-04 07:47:22.043 [main] INFO  [] [] o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-08-04 07:47:22.417 [main] DEBUG [] [] org.hibernate.SQL - select count(*) from cliente c1_0
2025-08-04 07:47:22.468 [main] DEBUG [] [] org.hibernate.SQL - select c1_0.id,c1_0.nombre from cliente c1_0 where c1_0.id=?
2025-08-04 07:47:22.486 [main] DEBUG [] [] org.hibernate.SQL - insert into cliente (nombre,id) values (?,?)
2025-08-04 07:47:22.489 [main] DEBUG [] [] org.hibernate.SQL - select c1_0.id,c1_0.nombre from cliente c1_0 where c1_0.id=?
2025-08-04 07:47:22.490 [main] DEBUG [] [] org.hibernate.SQL - insert into cliente (nombre,id) values (?,?)
2025-08-04 07:47:22.493 [main] DEBUG [] [] org.hibernate.SQL - select count(*) from zona z1_0
2025-08-04 07:47:22.494 [main] DEBUG [] [] org.hibernate.SQL - select z1_0.id,z1_0.soporte_refrigeracion from zona z1_0 where z1_0.id=?
2025-08-04 07:47:22.496 [main] DEBUG [] [] org.hibernate.SQL - insert into zona (soporte_refrigeracion,id) values (?,?)
2025-08-04 07:47:22.497 [main] DEBUG [] [] org.hibernate.SQL - select z1_0.id,z1_0.soporte_refrigeracion from zona z1_0 where z1_0.id=?
2025-08-04 07:47:22.497 [main] DEBUG [] [] org.hibernate.SQL - insert into zona (soporte_refrigeracion,id) values (?,?)
2025-08-04 07:47:22.574 [main] WARN  [] [] o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-08-04 07:47:22.888 [main] INFO  [] [] o.s.b.a.h.H2ConsoleAutoConfiguration - H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:testdb'
2025-08-04 07:47:22.907 [main] INFO  [] [] o.s.b.t.m.w.SpringBootMockServletContext - Initializing Spring TestDispatcherServlet ''
2025-08-04 07:47:22.908 [main] INFO  [] [] o.s.t.w.s.TestDispatcherServlet - Initializing Servlet ''
2025-08-04 07:47:22.912 [main] INFO  [] [] o.s.b.a.e.web.EndpointLinksResolver - Exposing 1 endpoint beneath base path '/actuator'
2025-08-04 07:47:22.920 [main] INFO  [] [] o.s.t.w.s.TestDispatcherServlet - Completed initialization in 12 ms
2025-08-04 07:47:22.970 [main] INFO  [] [] c.j.p.i.c.PedidoControllerHttpStatusTest - Started PedidoControllerHttpStatusTest in 2.982 seconds (process running for 3.959)
2025-08-04 07:47:23.274 [main] DEBUG [] [] org.hibernate.SQL - select c1_0.id,c1_0.nombre from cliente c1_0 where c1_0.id=?
2025-08-04 07:47:23.278 [main] DEBUG [] [] org.hibernate.SQL - update cliente set nombre=? where id=?
2025-08-04 07:47:23.280 [main] DEBUG [] [] org.hibernate.SQL - select z1_0.id,z1_0.soporte_refrigeracion from zona z1_0 where z1_0.id=?
2025-08-04 07:47:23.310 [main] INFO  [] [HTTP_REQUEST] c.j.p.i.controller.PedidoController - [INICIO_CARGA_CSV] POST /pedidos/cargar - Request ID: 3f5cf53f - Archivo: pedidos.csv - Tamaño: 122 bytes
2025-08-04 07:47:23.310 [main] INFO  [] [CARGA_CSV] c.j.p.a.usecase.CargarPedidosUseCase - [INICIO_CARGA_CSV] Iniciando procesamiento de archivo: pedidos.csv (tamaño: 122 bytes)
2025-08-04 07:47:23.317 [main] INFO  [] [CARGA_CSV] c.j.p.a.usecase.CargarPedidosUseCase - [INICIO_CARGA_CSV] Procesando 1 filas de datos (excluyendo cabecera)
2025-08-04 07:47:23.317 [main] DEBUG [P001] [CARGA_CSV] c.j.p.a.usecase.CargarPedidosUseCase - [INICIO_VALIDACION] Iniciando validación completa de pedido: P001
2025-08-04 07:47:23.317 [main] INFO  [P001] [CARGA_CSV] c.j.p.domain.service.PedidoValidator - [INICIO_VALIDACION] Validando número de pedido: P001
2025-08-04 07:47:23.344 [main] DEBUG [P001] [CARGA_CSV] org.hibernate.SQL - select count(*) from pedido p1_0 where p1_0.numero_pedido=?
2025-08-04 07:47:23.346 [main] DEBUG [P001] [CARGA_CSV] c.j.p.domain.service.PedidoValidator - [PEDIDO_VALIDO] Número de pedido único y válido: P001
2025-08-04 07:47:23.346 [main] DEBUG [P001] [CARGA_CSV] c.j.p.d.service.ClienteValidator - [INICIO_VALIDACION] Validando cliente: CLI-123
2025-08-04 07:47:23.347 [main] DEBUG [P001] [CARGA_CSV] org.hibernate.SQL - select c1_0.id,c1_0.nombre from cliente c1_0 where c1_0.id=?
2025-08-04 07:47:23.348 [main] DEBUG [P001] [CARGA_CSV] c.j.p.d.service.ClienteValidator - [PEDIDO_VALIDO] Cliente válido encontrado: CLI-123 - Test Cliente
2025-08-04 07:47:23.348 [main] DEBUG [P001] [CARGA_CSV] c.j.p.domain.service.FechaValidator - [INICIO_VALIDACION] Validando fecha de entrega: 2099-08-10
2025-08-04 07:47:23.349 [main] DEBUG [P001] [CARGA_CSV] c.j.p.domain.service.FechaValidator - [PEDIDO_VALIDO] Fecha de entrega válida: 2099-08-10 (días desde hoy: 27034)
2025-08-04 07:47:23.349 [main] DEBUG [P001] [CARGA_CSV] c.j.p.domain.service.EstadoValidator - [INICIO_VALIDACION] Validando estado: PENDIENTE
2025-08-04 07:47:23.349 [main] DEBUG [P001] [CARGA_CSV] c.j.p.domain.service.EstadoValidator - [PEDIDO_VALIDO] Estado válido: PENDIENTE
2025-08-04 07:47:23.349 [main] DEBUG [P001] [CARGA_CSV] c.j.p.domain.service.ZonaValidator - [INICIO_VALIDACION] Validando zona: ZONA1 con refrigeración: true
2025-08-04 07:47:23.350 [main] DEBUG [P001] [CARGA_CSV] org.hibernate.SQL - select z1_0.id,z1_0.soporte_refrigeracion from zona z1_0 where z1_0.id=?
2025-08-04 07:47:23.351 [main] DEBUG [P001] [CARGA_CSV] c.j.p.domain.service.ZonaValidator - [PEDIDO_VALIDO] Zona válida: ZONA1 - Soporte refrigeración: true - Requerido: true
2025-08-04 07:47:23.351 [main] DEBUG [P001] [CARGA_CSV] c.j.p.a.usecase.CargarPedidosUseCase - [PEDIDO_VALIDO] Todas las validaciones pasaron exitosamente
2025-08-04 07:47:23.351 [main] DEBUG [P001] [CONVERSION] c.j.p.a.usecase.CargarPedidosUseCase - [PEDIDO_PROCESADO] Convirtiendo DTO a entidad de dominio: P001
2025-08-04 07:47:23.352 [main] DEBUG [P001] [CONVERSION] c.j.p.a.usecase.CargarPedidosUseCase - [PEDIDO_PROCESADO] Conversión exitosa - Pedido: P001, Cliente: CLI-123, Fecha: 2099-08-10, Estado: PENDIENTE, Zona: ZONA1, Refrigeración: true
2025-08-04 07:47:23.353 [main] DEBUG [P001] [CONVERSION] c.j.p.a.usecase.CargarPedidosUseCase - [PEDIDO_PROCESADO] Pedido válido agregado para guardado: P001
2025-08-04 07:47:23.353 [main] INFO  [P001] [PERSISTENCIA] c.j.p.a.usecase.CargarPedidosUseCase - [PEDIDO_GUARDADO] Guardando 1 pedidos válidos en base de datos
2025-08-04 07:47:23.354 [main] DEBUG [P001] [PERSISTENCIA] org.hibernate.SQL - select p1_0.numero_pedido,p1_0.cliente_id,c1_0.id,c1_0.nombre,p1_0.estado,p1_0.fecha_entrega,p1_0.requiere_refrigeracion,p1_0.zona_entrega,ze1_0.id,ze1_0.soporte_refrigeracion from pedido p1_0 join cliente c1_0 on c1_0.id=p1_0.cliente_id join zona ze1_0 on ze1_0.id=p1_0.zona_entrega where p1_0.numero_pedido=?
2025-08-04 07:47:23.357 [main] DEBUG [P001] [PERSISTENCIA] org.hibernate.SQL - insert into pedido (cliente_id,estado,fecha_entrega,requiere_refrigeracion,zona_entrega,numero_pedido) values (?,?,?,?,?,?)
2025-08-04 07:47:23.359 [main] INFO  [P001] [PERSISTENCIA] c.j.p.a.usecase.CargarPedidosUseCase - [PEDIDO_GUARDADO] Guardados exitosamente 1 pedidos
2025-08-04 07:47:23.359 [main] INFO  [] [] c.j.p.a.usecase.CargarPedidosUseCase - [RESUMEN_PROCESAMIENTO] Procesamiento completado - Total: 1, Guardados: 1, Errores: 0
2025-08-04 07:47:23.359 [main] INFO  [] [] c.j.p.i.controller.PedidoController - [FIN_CARGA_CSV] Request ID: 3f5cf53f - Procesamiento completado en 49ms - Total: 1, Guardados: 1, Tipos de errores: 0
2025-08-04 07:47:23.411 [main] DEBUG [] [] org.hibernate.SQL - select c1_0.id,c1_0.nombre from cliente c1_0 where c1_0.id=?
2025-08-04 07:47:23.412 [main] DEBUG [] [] org.hibernate.SQL - select z1_0.id,z1_0.soporte_refrigeracion from zona z1_0 where z1_0.id=?
2025-08-04 07:47:23.414 [main] INFO  [] [HTTP_REQUEST] c.j.p.i.controller.PedidoController - [INICIO_CARGA_CSV] POST /pedidos/cargar - Request ID: 1133416a - Archivo: pedidos.csv - Tamaño: 61 bytes
2025-08-04 07:47:23.414 [main] INFO  [] [CARGA_CSV] c.j.p.a.usecase.CargarPedidosUseCase - [INICIO_CARGA_CSV] Iniciando procesamiento de archivo: pedidos.csv (tamaño: 61 bytes)
2025-08-04 07:47:23.417 [main] ERROR [] [CARGA_CSV] c.j.p.a.usecase.CargarPedidosUseCase - [[ERROR_LECTURA_CSV, pedidos.csv]] Error al leer archivo CSV: {}
com.opencsv.exceptions.CsvMalformedLineException: Unterminated quoted field at end of CSV line. Beginning of lost text: [P001,CLI-123,2099-08-10
]
	at com.opencsv.CSVReader.primeNextRecord(CSVReader.java:245)
	at com.opencsv.CSVReader.flexibleRead(CSVReader.java:610)
	at com.opencsv.CSVReader.readNext(CSVReader.java:204)
	at com.opencsv.CSVReader.readAll(CSVReader.java:186)
	at com.josue.pedidos_ms.application.usecase.CargarPedidosUseCase.procesarArchivo(CargarPedidosUseCase.java:57)
	at com.josue.pedidos_ms.infrastructure.controller.PedidoController.cargarArchivo(PedidoController.java:54)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at org.springframework.test.web.servlet.TestDispatcherServlet.service(TestDispatcherServlet.java:72)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.springframework.mock.web.MockFilterChain$ServletFilterProxy.doFilter(MockFilterChain.java:165)
	at org.springframework.mock.web.MockFilterChain.doFilter(MockFilterChain.java:132)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.test.web.servlet.setup.MockMvcFilterDecorator.doFilter(MockMvcFilterDecorator.java:162)
	at org.springframework.mock.web.MockFilterChain.doFilter(MockFilterChain.java:132)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.test.web.servlet.setup.MockMvcFilterDecorator.doFilter(MockMvcFilterDecorator.java:162)
	at org.springframework.mock.web.MockFilterChain.doFilter(MockFilterChain.java:132)
	at org.springframework.web.filter.ServerHttpObservationFilter.doFilterInternal(ServerHttpObservationFilter.java:110)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.test.web.servlet.setup.MockMvcFilterDecorator.doFilter(MockMvcFilterDecorator.java:162)
	at org.springframework.mock.web.MockFilterChain.doFilter(MockFilterChain.java:132)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.test.web.servlet.setup.MockMvcFilterDecorator.doFilter(MockMvcFilterDecorator.java:162)
	at org.springframework.mock.web.MockFilterChain.doFilter(MockFilterChain.java:132)
	at org.springframework.test.web.servlet.MockMvc.perform(MockMvc.java:201)
	at com.josue.pedidos_ms.infrastructure.controller.PedidoControllerHttpStatusTest.debeRetornar400CuandoElCsvEsMalformado(PedidoControllerHttpStatusTest.java:109)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at org.junit.platform.commons.util.ReflectionUtils.invokeMethod(ReflectionUtils.java:775)
	at org.junit.platform.commons.support.ReflectionSupport.invokeMethod(ReflectionSupport.java:479)
	at org.junit.jupiter.engine.execution.MethodInvocation.proceed(MethodInvocation.java:60)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$ValidatingInvocation.proceed(InvocationInterceptorChain.java:131)
	at org.junit.jupiter.engine.extension.TimeoutExtension.intercept(TimeoutExtension.java:161)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestableMethod(TimeoutExtension.java:152)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestMethod(TimeoutExtension.java:91)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker$ReflectiveInterceptorCall.lambda$ofVoidMethod$0(InterceptingExecutableInvoker.java:112)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.lambda$invoke$0(InterceptingExecutableInvoker.java:94)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$InterceptedInvocation.proceed(InvocationInterceptorChain.java:106)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.proceed(InvocationInterceptorChain.java:64)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.chainAndInvoke(InvocationInterceptorChain.java:45)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.invoke(InvocationInterceptorChain.java:37)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.invoke(InterceptingExecutableInvoker.java:93)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.invoke(InterceptingExecutableInvoker.java:87)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeTestMethod$7(TestMethodTestDescriptor.java:216)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeTestMethod(TestMethodTestDescriptor.java:212)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:137)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:69)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:156)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:146)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:144)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:143)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:100)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:160)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:146)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:144)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:143)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:100)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:160)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:146)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:144)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:143)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:100)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:35)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:201)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:170)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:94)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:59)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:142)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:58)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:103)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:94)
	at org.junit.platform.launcher.core.DelegatingLauncher.execute(DelegatingLauncher.java:52)
	at org.junit.platform.launcher.core.InterceptingLauncher.lambda$execute$2(InterceptingLauncher.java:47)
	at org.junit.platform.launcher.core.ClasspathAlignmentCheckingLauncherInterceptor.intercept(ClasspathAlignmentCheckingLauncherInterceptor.java:25)
	at org.junit.platform.launcher.core.InterceptingLauncher.execute(InterceptingLauncher.java:46)
	at org.junit.platform.launcher.core.DelegatingLauncher.execute(DelegatingLauncher.java:52)
	at org.junit.platform.launcher.core.SessionPerRequestLauncher.execute(SessionPerRequestLauncher.java:70)
	at org.eclipse.jdt.internal.junit5.runner.JUnit5TestReference.run(JUnit5TestReference.java:100)
	at org.eclipse.jdt.internal.junit.runner.TestExecution.run(TestExecution.java:40)
	at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:520)
	at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:748)
	at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:443)
	at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.main(RemoteTestRunner.java:211)
2025-08-04 07:47:23.423 [main] WARN  [] [] c.j.p.i.c.GlobalExceptionHandler - [ERROR_LECTURA_CSV] Error de validación CSV: Archivo CSV ilegible o mal formateado: Unterminated quoted field at end of CSV line. Beginning of lost text: [P001,CLI-123,2099-08-10
]
2025-08-04 07:47:23.440 [main] DEBUG [] [] org.hibernate.SQL - select c1_0.id,c1_0.nombre from cliente c1_0 where c1_0.id=?
2025-08-04 07:47:23.441 [main] DEBUG [] [] org.hibernate.SQL - select z1_0.id,z1_0.soporte_refrigeracion from zona z1_0 where z1_0.id=?
2025-08-04 07:47:23.443 [main] INFO  [] [HTTP_REQUEST] c.j.p.i.controller.PedidoController - [INICIO_CARGA_CSV] POST /pedidos/cargar - Request ID: 49a97d84 - Archivo: pedidos.csv - Tamaño: 0 bytes
2025-08-04 07:47:23.443 [main] WARN  [] [HTTP_REQUEST] c.j.p.i.controller.PedidoController - [ARCHIVO_VACIO] Request ID: 49a97d84 - Archivo vacío recibido
2025-08-04 07:47:23.444 [main] WARN  [] [] c.j.p.i.c.GlobalExceptionHandler - [ERROR_LECTURA_CSV] Error de validación CSV: El archivo está vacío
2025-08-04 07:47:23.455 [main] DEBUG [] [] org.hibernate.SQL - select c1_0.id,c1_0.nombre from cliente c1_0 where c1_0.id=?
2025-08-04 07:47:23.460 [main] DEBUG [] [] org.hibernate.SQL - select z1_0.id,z1_0.soporte_refrigeracion from zona z1_0 where z1_0.id=?
2025-08-04 07:47:23.466 [main] INFO  [] [HTTP_REQUEST] c.j.p.i.controller.PedidoController - [INICIO_CARGA_CSV] POST /pedidos/cargar - Request ID: 0eedf51d - Archivo: pedidos.csv - Tamaño: 147 bytes
2025-08-04 07:47:23.472 [main] INFO  [] [CARGA_CSV] c.j.p.a.usecase.CargarPedidosUseCase - [INICIO_CARGA_CSV] Iniciando procesamiento de archivo: pedidos.csv (tamaño: 147 bytes)
2025-08-04 07:47:23.472 [main] INFO  [] [CARGA_CSV] c.j.p.a.usecase.CargarPedidosUseCase - [INICIO_CARGA_CSV] Procesando 1 filas de datos (excluyendo cabecera)
2025-08-04 07:47:23.473 [main] DEBUG [P001] [CARGA_CSV] c.j.p.a.usecase.CargarPedidosUseCase - [INICIO_VALIDACION] Iniciando validación completa de pedido: P001
2025-08-04 07:47:23.473 [main] INFO  [P001] [CARGA_CSV] c.j.p.domain.service.PedidoValidator - [INICIO_VALIDACION] Validando número de pedido: P001
2025-08-04 07:47:23.475 [main] DEBUG [P001] [CARGA_CSV] org.hibernate.SQL - select count(*) from pedido p1_0 where p1_0.numero_pedido=?
2025-08-04 07:47:23.477 [main] WARN  [P001] [CARGA_CSV] c.j.p.domain.service.PedidoValidator - [PEDIDO_INVALIDO] Número de pedido duplicado en base de datos: P001
2025-08-04 07:47:23.477 [main] DEBUG [P001] [CARGA_CSV] c.j.p.d.service.ClienteValidator - [INICIO_VALIDACION] Validando cliente: CLI-INEXISTENTE
2025-08-04 07:47:23.478 [main] DEBUG [P001] [CARGA_CSV] org.hibernate.SQL - select c1_0.id,c1_0.nombre from cliente c1_0 where c1_0.id=?
2025-08-04 07:47:23.478 [main] WARN  [P001] [CARGA_CSV] c.j.p.d.service.ClienteValidator - [PEDIDO_INVALIDO] Cliente no encontrado en base de datos: CLI-INEXISTENTE
2025-08-04 07:47:23.478 [main] DEBUG [P001] [CARGA_CSV] c.j.p.domain.service.FechaValidator - [INICIO_VALIDACION] Validando fecha de entrega: 2020-01-01
2025-08-04 07:47:23.478 [main] WARN  [P001] [CARGA_CSV] c.j.p.domain.service.FechaValidator - [PEDIDO_INVALIDO] Fecha de entrega en el pasado: 2020-01-01 (hoy: 2025-08-04)
2025-08-04 07:47:23.478 [main] DEBUG [P001] [CARGA_CSV] c.j.p.domain.service.EstadoValidator - [INICIO_VALIDACION] Validando estado: ESTADO_INVALIDO
2025-08-04 07:47:23.479 [main] WARN  [P001] [CARGA_CSV] c.j.p.domain.service.EstadoValidator - [PEDIDO_INVALIDO] Estado inválido: ESTADO_INVALIDO. Estados válidos: PENDIENTE, CONFIRMADO, ENTREGADO
2025-08-04 07:47:23.479 [main] DEBUG [P001] [CARGA_CSV] c.j.p.domain.service.ZonaValidator - [INICIO_VALIDACION] Validando zona: ZONA_INEXISTENTE con refrigeración: true
2025-08-04 07:47:23.480 [main] DEBUG [P001] [CARGA_CSV] org.hibernate.SQL - select z1_0.id,z1_0.soporte_refrigeracion from zona z1_0 where z1_0.id=?
2025-08-04 07:47:23.481 [main] WARN  [P001] [CARGA_CSV] c.j.p.domain.service.ZonaValidator - [PEDIDO_INVALIDO] Zona no encontrada en base de datos: ZONA_INEXISTENTE
2025-08-04 07:47:23.481 [main] INFO  [P001] [CARGA_CSV] c.j.p.a.usecase.CargarPedidosUseCase - [ESTADISTICAS_VALIDACION] Validación completada con 5 errores: [Número de pedido duplicado, Clientes no encontrados, Fecha de entrega inválida, Estado inválido, Zonas inválidas]
2025-08-04 07:47:23.481 [main] WARN  [P001] [CARGA_CSV] c.j.p.a.usecase.CargarPedidosUseCase - [PEDIDO_INVALIDO] Pedido con 5 errores de validación
2025-08-04 07:47:23.482 [main] INFO  [] [] c.j.p.a.usecase.CargarPedidosUseCase - [RESUMEN_PROCESAMIENTO] Procesamiento completado - Total: 1, Guardados: 0, Errores: 5
2025-08-04 07:47:23.482 [main] INFO  [] [] c.j.p.i.controller.PedidoController - [FIN_CARGA_CSV] Request ID: 0eedf51d - Procesamiento completado en 10ms - Total: 1, Guardados: 0, Tipos de errores: 5
2025-08-04 07:47:23.484 [main] WARN  [] [] c.j.p.i.controller.PedidoController - [ESTADISTICAS_VALIDACION] Request ID: 0eedf51d - Errores de validación encontrados: 5 errores totales
2025-08-04 07:47:23.501 [main] DEBUG [] [] org.hibernate.SQL - select c1_0.id,c1_0.nombre from cliente c1_0 where c1_0.id=?
2025-08-04 07:47:23.504 [main] DEBUG [] [] org.hibernate.SQL - select z1_0.id,z1_0.soporte_refrigeracion from zona z1_0 where z1_0.id=?
2025-08-04 07:47:23.506 [main] INFO  [] [HTTP_REQUEST] c.j.p.i.controller.PedidoController - [INICIO_CARGA_CSV] POST /pedidos/cargar - Request ID: 60113ccb - Archivo: pedidos.txt - Tamaño: 9 bytes
2025-08-04 07:47:23.507 [main] WARN  [] [HTTP_REQUEST] c.j.p.i.controller.PedidoController - [ERROR_LECTURA_CSV] Request ID: 60113ccb - Formato de archivo inválido: pedidos.txt
2025-08-04 07:47:23.507 [main] WARN  [] [] c.j.p.i.c.GlobalExceptionHandler - [ERROR_LECTURA_CSV] Error de validación CSV: Solo se permiten archivos CSV
2025-08-04 07:47:23.514 [main] DEBUG [] [] org.hibernate.SQL - select c1_0.id,c1_0.nombre from cliente c1_0 where c1_0.id=?
2025-08-04 07:47:23.516 [main] DEBUG [] [] org.hibernate.SQL - select z1_0.id,z1_0.soporte_refrigeracion from zona z1_0 where z1_0.id=?
2025-08-04 07:47:23.518 [main] INFO  [] [HTTP_REQUEST] c.j.p.i.controller.PedidoController - [INICIO_CARGA_CSV] POST /pedidos/cargar - Request ID: ce3496ca - Archivo: pedidos.csv - Tamaño: 186 bytes
2025-08-04 07:47:23.518 [main] INFO  [] [CARGA_CSV] c.j.p.a.usecase.CargarPedidosUseCase - [INICIO_CARGA_CSV] Iniciando procesamiento de archivo: pedidos.csv (tamaño: 186 bytes)
2025-08-04 07:47:23.518 [main] INFO  [] [CARGA_CSV] c.j.p.a.usecase.CargarPedidosUseCase - [INICIO_CARGA_CSV] Procesando 2 filas de datos (excluyendo cabecera)
2025-08-04 07:47:23.518 [main] DEBUG [P001] [CARGA_CSV] c.j.p.a.usecase.CargarPedidosUseCase - [INICIO_VALIDACION] Iniciando validación completa de pedido: P001
2025-08-04 07:47:23.518 [main] INFO  [P001] [CARGA_CSV] c.j.p.domain.service.PedidoValidator - [INICIO_VALIDACION] Validando número de pedido: P001
2025-08-04 07:47:23.519 [main] DEBUG [P001] [CARGA_CSV] org.hibernate.SQL - select count(*) from pedido p1_0 where p1_0.numero_pedido=?
2025-08-04 07:47:23.520 [main] WARN  [P001] [CARGA_CSV] c.j.p.domain.service.PedidoValidator - [PEDIDO_INVALIDO] Número de pedido duplicado en base de datos: P001
2025-08-04 07:47:23.520 [main] DEBUG [P001] [CARGA_CSV] c.j.p.d.service.ClienteValidator - [INICIO_VALIDACION] Validando cliente: CLI-123
2025-08-04 07:47:23.521 [main] DEBUG [P001] [CARGA_CSV] org.hibernate.SQL - select c1_0.id,c1_0.nombre from cliente c1_0 where c1_0.id=?
2025-08-04 07:47:23.522 [main] DEBUG [P001] [CARGA_CSV] c.j.p.d.service.ClienteValidator - [PEDIDO_VALIDO] Cliente válido encontrado: CLI-123 - Test Cliente
2025-08-04 07:47:23.522 [main] DEBUG [P001] [CARGA_CSV] c.j.p.domain.service.FechaValidator - [INICIO_VALIDACION] Validando fecha de entrega: 2099-08-10
2025-08-04 07:47:23.522 [main] DEBUG [P001] [CARGA_CSV] c.j.p.domain.service.FechaValidator - [PEDIDO_VALIDO] Fecha de entrega válida: 2099-08-10 (días desde hoy: 27034)
2025-08-04 07:47:23.522 [main] DEBUG [P001] [CARGA_CSV] c.j.p.domain.service.EstadoValidator - [INICIO_VALIDACION] Validando estado: PENDIENTE
2025-08-04 07:47:23.522 [main] DEBUG [P001] [CARGA_CSV] c.j.p.domain.service.EstadoValidator - [PEDIDO_VALIDO] Estado válido: PENDIENTE
2025-08-04 07:47:23.522 [main] DEBUG [P001] [CARGA_CSV] c.j.p.domain.service.ZonaValidator - [INICIO_VALIDACION] Validando zona: ZONA1 con refrigeración: true
2025-08-04 07:47:23.523 [main] DEBUG [P001] [CARGA_CSV] org.hibernate.SQL - select z1_0.id,z1_0.soporte_refrigeracion from zona z1_0 where z1_0.id=?
2025-08-04 07:47:23.523 [main] DEBUG [P001] [CARGA_CSV] c.j.p.domain.service.ZonaValidator - [PEDIDO_VALIDO] Zona válida: ZONA1 - Soporte refrigeración: true - Requerido: true
2025-08-04 07:47:23.523 [main] INFO  [P001] [CARGA_CSV] c.j.p.a.usecase.CargarPedidosUseCase - [ESTADISTICAS_VALIDACION] Validación completada con 1 errores: [Número de pedido duplicado]
2025-08-04 07:47:23.523 [main] WARN  [P001] [CARGA_CSV] c.j.p.a.usecase.CargarPedidosUseCase - [PEDIDO_INVALIDO] Pedido con 1 errores de validación
2025-08-04 07:47:23.523 [main] DEBUG [P002] [CARGA_CSV] c.j.p.a.usecase.CargarPedidosUseCase - [INICIO_VALIDACION] Iniciando validación completa de pedido: P002
2025-08-04 07:47:23.524 [main] INFO  [P002] [CARGA_CSV] c.j.p.domain.service.PedidoValidator - [INICIO_VALIDACION] Validando número de pedido: P002
2025-08-04 07:47:23.524 [main] DEBUG [P002] [CARGA_CSV] org.hibernate.SQL - select count(*) from pedido p1_0 where p1_0.numero_pedido=?
2025-08-04 07:47:23.525 [main] DEBUG [P002] [CARGA_CSV] c.j.p.domain.service.PedidoValidator - [PEDIDO_VALIDO] Número de pedido único y válido: P002
2025-08-04 07:47:23.525 [main] DEBUG [P002] [CARGA_CSV] c.j.p.d.service.ClienteValidator - [INICIO_VALIDACION] Validando cliente: CLI-INEXISTENTE
2025-08-04 07:47:23.525 [main] DEBUG [P002] [CARGA_CSV] org.hibernate.SQL - select c1_0.id,c1_0.nombre from cliente c1_0 where c1_0.id=?
2025-08-04 07:47:23.526 [main] WARN  [P002] [CARGA_CSV] c.j.p.d.service.ClienteValidator - [PEDIDO_INVALIDO] Cliente no encontrado en base de datos: CLI-INEXISTENTE
2025-08-04 07:47:23.526 [main] DEBUG [P002] [CARGA_CSV] c.j.p.domain.service.FechaValidator - [INICIO_VALIDACION] Validando fecha de entrega: 2020-01-01
2025-08-04 07:47:23.526 [main] WARN  [P002] [CARGA_CSV] c.j.p.domain.service.FechaValidator - [PEDIDO_INVALIDO] Fecha de entrega en el pasado: 2020-01-01 (hoy: 2025-08-04)
2025-08-04 07:47:23.526 [main] DEBUG [P002] [CARGA_CSV] c.j.p.domain.service.EstadoValidator - [INICIO_VALIDACION] Validando estado: INVALIDO
2025-08-04 07:47:23.527 [main] WARN  [P002] [CARGA_CSV] c.j.p.domain.service.EstadoValidator - [PEDIDO_INVALIDO] Estado inválido: INVALIDO. Estados válidos: PENDIENTE, CONFIRMADO, ENTREGADO
2025-08-04 07:47:23.527 [main] DEBUG [P002] [CARGA_CSV] c.j.p.domain.service.ZonaValidator - [INICIO_VALIDACION] Validando zona: ZONA_INEXISTENTE con refrigeración: false
2025-08-04 07:47:23.530 [main] DEBUG [P002] [CARGA_CSV] org.hibernate.SQL - select z1_0.id,z1_0.soporte_refrigeracion from zona z1_0 where z1_0.id=?
2025-08-04 07:47:23.532 [main] WARN  [P002] [CARGA_CSV] c.j.p.domain.service.ZonaValidator - [PEDIDO_INVALIDO] Zona no encontrada en base de datos: ZONA_INEXISTENTE
2025-08-04 07:47:23.532 [main] INFO  [P002] [CARGA_CSV] c.j.p.a.usecase.CargarPedidosUseCase - [ESTADISTICAS_VALIDACION] Validación completada con 4 errores: [Clientes no encontrados, Fecha de entrega inválida, Estado inválido, Zonas inválidas]
2025-08-04 07:47:23.532 [main] WARN  [P002] [CARGA_CSV] c.j.p.a.usecase.CargarPedidosUseCase - [PEDIDO_INVALIDO] Pedido con 4 errores de validación
2025-08-04 07:47:23.532 [main] INFO  [] [] c.j.p.a.usecase.CargarPedidosUseCase - [RESUMEN_PROCESAMIENTO] Procesamiento completado - Total: 2, Guardados: 0, Errores: 5
2025-08-04 07:47:23.532 [main] INFO  [] [] c.j.p.i.controller.PedidoController - [FIN_CARGA_CSV] Request ID: ce3496ca - Procesamiento completado en 14ms - Total: 2, Guardados: 0, Tipos de errores: 5
2025-08-04 07:47:23.532 [main] WARN  [] [] c.j.p.i.controller.PedidoController - [ESTADISTICAS_VALIDACION] Request ID: ce3496ca - Errores de validación encontrados: 5 errores totales
2025-08-04 07:47:23.555 [SpringApplicationShutdownHook] INFO  [] [] o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-08-04 07:47:23.557 [SpringApplicationShutdownHook] DEBUG [] [] org.hibernate.SQL - drop table if exists cliente cascade 
2025-08-04 07:47:23.558 [SpringApplicationShutdownHook] DEBUG [] [] org.hibernate.SQL - drop table if exists pedido cascade 
2025-08-04 07:47:23.559 [SpringApplicationShutdownHook] DEBUG [] [] org.hibernate.SQL - drop table if exists zona cascade 
2025-08-04 07:47:23.562 [SpringApplicationShutdownHook] INFO  [] [] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-08-04 07:47:23.565 [SpringApplicationShutdownHook] INFO  [] [] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-08-04 07:48:23.949 [main] INFO  [] [] c.j.p.i.c.PedidoControllerHttpStatusTest - Starting PedidoControllerHttpStatusTest using Java 17.0.15 with PID 97381 (started by josuepatricio in /Users/josuepatricio/Downloads/pedidos-ms)
2025-08-04 07:48:23.950 [main] DEBUG [] [] c.j.p.i.c.PedidoControllerHttpStatusTest - Running with Spring Boot v3.5.4, Spring v6.2.9
2025-08-04 07:48:23.951 [main] INFO  [] [] c.j.p.i.c.PedidoControllerHttpStatusTest - The following 1 profile is active: "test"
2025-08-04 07:48:24.421 [main] INFO  [] [] o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-08-04 07:48:24.451 [main] INFO  [] [] o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 23 ms. Found 3 JPA repository interfaces.
2025-08-04 07:48:24.866 [main] INFO  [] [] o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-08-04 07:48:24.883 [main] INFO  [] [] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-08-04 07:48:24.988 [main] INFO  [] [] com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:testdb user=SA
2025-08-04 07:48:24.989 [main] INFO  [] [] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-08-04 07:48:25.002 [main] WARN  [] [] org.hibernate.orm.deprecation - HHH90000025: H2Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-08-04 07:48:25.426 [main] DEBUG [] [] org.hibernate.SQL - drop table if exists cliente cascade 
2025-08-04 07:48:25.428 [main] DEBUG [] [] org.hibernate.SQL - drop table if exists pedido cascade 
2025-08-04 07:48:25.428 [main] DEBUG [] [] org.hibernate.SQL - drop table if exists zona cascade 
2025-08-04 07:48:25.431 [main] DEBUG [] [] org.hibernate.SQL - create table cliente (id varchar(255) not null, nombre varchar(255), primary key (id))
2025-08-04 07:48:25.469 [main] DEBUG [] [] org.hibernate.SQL - create table pedido (fecha_entrega date, requiere_refrigeracion boolean not null, cliente_id varchar(255) not null, numero_pedido varchar(255) not null, zona_entrega varchar(255) not null, estado enum ('CONFIRMADO','ENTREGADO','PENDIENTE'), primary key (numero_pedido))
2025-08-04 07:48:25.507 [main] DEBUG [] [] org.hibernate.SQL - create table zona (soporte_refrigeracion boolean not null, id varchar(255) not null, primary key (id))
2025-08-04 07:48:25.509 [main] DEBUG [] [] org.hibernate.SQL - alter table if exists pedido add constraint FK30s8j2ktpay6of18lbyqn3632 foreign key (cliente_id) references cliente
2025-08-04 07:48:25.539 [main] DEBUG [] [] org.hibernate.SQL - alter table if exists pedido add constraint FK1aokin5yjk78h5cax5jju4fs9 foreign key (zona_entrega) references zona
2025-08-04 07:48:25.542 [main] INFO  [] [] o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-08-04 07:48:25.898 [main] DEBUG [] [] org.hibernate.SQL - select count(*) from cliente c1_0
2025-08-04 07:48:25.945 [main] DEBUG [] [] org.hibernate.SQL - select c1_0.id,c1_0.nombre from cliente c1_0 where c1_0.id=?
2025-08-04 07:48:25.959 [main] DEBUG [] [] org.hibernate.SQL - insert into cliente (nombre,id) values (?,?)
2025-08-04 07:48:25.962 [main] DEBUG [] [] org.hibernate.SQL - select c1_0.id,c1_0.nombre from cliente c1_0 where c1_0.id=?
2025-08-04 07:48:25.963 [main] DEBUG [] [] org.hibernate.SQL - insert into cliente (nombre,id) values (?,?)
2025-08-04 07:48:25.965 [main] DEBUG [] [] org.hibernate.SQL - select count(*) from zona z1_0
2025-08-04 07:48:25.967 [main] DEBUG [] [] org.hibernate.SQL - select z1_0.id,z1_0.soporte_refrigeracion from zona z1_0 where z1_0.id=?
2025-08-04 07:48:25.968 [main] DEBUG [] [] org.hibernate.SQL - insert into zona (soporte_refrigeracion,id) values (?,?)
2025-08-04 07:48:25.969 [main] DEBUG [] [] org.hibernate.SQL - select z1_0.id,z1_0.soporte_refrigeracion from zona z1_0 where z1_0.id=?
2025-08-04 07:48:25.970 [main] DEBUG [] [] org.hibernate.SQL - insert into zona (soporte_refrigeracion,id) values (?,?)
2025-08-04 07:48:26.028 [main] WARN  [] [] o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-08-04 07:48:26.285 [main] INFO  [] [] o.s.b.a.h.H2ConsoleAutoConfiguration - H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:testdb'
2025-08-04 07:48:26.305 [main] INFO  [] [] o.s.b.t.m.w.SpringBootMockServletContext - Initializing Spring TestDispatcherServlet ''
2025-08-04 07:48:26.305 [main] INFO  [] [] o.s.t.w.s.TestDispatcherServlet - Initializing Servlet ''
2025-08-04 07:48:26.309 [main] INFO  [] [] o.s.b.a.e.web.EndpointLinksResolver - Exposing 1 endpoint beneath base path '/actuator'
2025-08-04 07:48:26.316 [main] INFO  [] [] o.s.t.w.s.TestDispatcherServlet - Completed initialization in 11 ms
2025-08-04 07:48:26.355 [main] INFO  [] [] c.j.p.i.c.PedidoControllerHttpStatusTest - Started PedidoControllerHttpStatusTest in 2.621 seconds (process running for 3.219)
2025-08-04 07:48:26.385 [main] INFO  [] [] o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-08-04 07:48:26.386 [main] DEBUG [] [] org.hibernate.SQL - drop table if exists cliente cascade 
2025-08-04 07:48:26.387 [main] DEBUG [] [] org.hibernate.SQL - drop table if exists pedido cascade 
2025-08-04 07:48:26.387 [main] DEBUG [] [] org.hibernate.SQL - drop table if exists zona cascade 
2025-08-04 07:48:26.389 [main] INFO  [] [] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-08-04 07:48:26.390 [main] INFO  [] [] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-08-04 07:48:26.393 [main] INFO  [] [] o.s.b.d.r.RestartApplicationListener - Restart disabled due to context in which it is running
2025-08-04 07:48:26.413 [main] INFO  [] [] c.j.p.i.c.PedidoControllerHttpStatusTest - Starting PedidoControllerHttpStatusTest using Java 17.0.15 with PID 97381 (started by josuepatricio in /Users/josuepatricio/Downloads/pedidos-ms)
2025-08-04 07:48:26.414 [main] DEBUG [] [] c.j.p.i.c.PedidoControllerHttpStatusTest - Running with Spring Boot v3.5.4, Spring v6.2.9
2025-08-04 07:48:26.414 [main] INFO  [] [] c.j.p.i.c.PedidoControllerHttpStatusTest - The following 1 profile is active: "test"
2025-08-04 07:48:26.541 [main] INFO  [] [] o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-08-04 07:48:26.547 [main] INFO  [] [] o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 5 ms. Found 3 JPA repository interfaces.
2025-08-04 07:48:26.597 [main] INFO  [] [] o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-08-04 07:48:26.598 [main] INFO  [] [] com.zaxxer.hikari.HikariDataSource - HikariPool-2 - Starting...
2025-08-04 07:48:26.598 [main] INFO  [] [] com.zaxxer.hikari.pool.HikariPool - HikariPool-2 - Added connection conn10: url=jdbc:h2:mem:testdb user=SA
2025-08-04 07:48:26.598 [main] INFO  [] [] com.zaxxer.hikari.HikariDataSource - HikariPool-2 - Start completed.
2025-08-04 07:48:26.599 [main] WARN  [] [] org.hibernate.orm.deprecation - HHH90000025: H2Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-08-04 07:48:26.613 [main] DEBUG [] [] org.hibernate.SQL - drop table if exists cliente cascade 
2025-08-04 07:48:26.613 [main] DEBUG [] [] org.hibernate.SQL - drop table if exists pedido cascade 
2025-08-04 07:48:26.613 [main] DEBUG [] [] org.hibernate.SQL - drop table if exists zona cascade 
2025-08-04 07:48:26.613 [main] DEBUG [] [] org.hibernate.SQL - create table cliente (id varchar(255) not null, nombre varchar(255), primary key (id))
2025-08-04 07:48:26.614 [main] DEBUG [] [] org.hibernate.SQL - create table pedido (fecha_entrega date, requiere_refrigeracion boolean not null, cliente_id varchar(255) not null, numero_pedido varchar(255) not null, zona_entrega varchar(255) not null, estado enum ('CONFIRMADO','ENTREGADO','PENDIENTE'), primary key (numero_pedido))
2025-08-04 07:48:26.615 [main] DEBUG [] [] org.hibernate.SQL - create table zona (soporte_refrigeracion boolean not null, id varchar(255) not null, primary key (id))
2025-08-04 07:48:26.616 [main] DEBUG [] [] org.hibernate.SQL - alter table if exists pedido add constraint FK30s8j2ktpay6of18lbyqn3632 foreign key (cliente_id) references cliente
2025-08-04 07:48:26.617 [main] DEBUG [] [] org.hibernate.SQL - alter table if exists pedido add constraint FK1aokin5yjk78h5cax5jju4fs9 foreign key (zona_entrega) references zona
2025-08-04 07:48:26.618 [main] INFO  [] [] o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-08-04 07:48:26.643 [main] DEBUG [] [] org.hibernate.SQL - select count(*) from cliente c1_0
2025-08-04 07:48:26.649 [main] DEBUG [] [] org.hibernate.SQL - select c1_0.id,c1_0.nombre from cliente c1_0 where c1_0.id=?
2025-08-04 07:48:26.650 [main] DEBUG [] [] org.hibernate.SQL - insert into cliente (nombre,id) values (?,?)
2025-08-04 07:48:26.651 [main] DEBUG [] [] org.hibernate.SQL - select c1_0.id,c1_0.nombre from cliente c1_0 where c1_0.id=?
2025-08-04 07:48:26.652 [main] DEBUG [] [] org.hibernate.SQL - insert into cliente (nombre,id) values (?,?)
2025-08-04 07:48:26.653 [main] DEBUG [] [] org.hibernate.SQL - select count(*) from zona z1_0
2025-08-04 07:48:26.654 [main] DEBUG [] [] org.hibernate.SQL - select z1_0.id,z1_0.soporte_refrigeracion from zona z1_0 where z1_0.id=?
2025-08-04 07:48:26.655 [main] DEBUG [] [] org.hibernate.SQL - insert into zona (soporte_refrigeracion,id) values (?,?)
2025-08-04 07:48:26.656 [main] DEBUG [] [] org.hibernate.SQL - select z1_0.id,z1_0.soporte_refrigeracion from zona z1_0 where z1_0.id=?
2025-08-04 07:48:26.657 [main] DEBUG [] [] org.hibernate.SQL - insert into zona (soporte_refrigeracion,id) values (?,?)
2025-08-04 07:48:26.674 [main] WARN  [] [] o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-08-04 07:48:26.743 [main] INFO  [] [] o.s.b.a.h.H2ConsoleAutoConfiguration - H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:testdb'
2025-08-04 07:48:26.749 [main] INFO  [] [] o.s.b.t.m.w.SpringBootMockServletContext - Initializing Spring TestDispatcherServlet ''
2025-08-04 07:48:26.749 [main] INFO  [] [] o.s.t.w.s.TestDispatcherServlet - Initializing Servlet ''
2025-08-04 07:48:26.751 [main] INFO  [] [] o.s.b.a.e.web.EndpointLinksResolver - Exposing 1 endpoint beneath base path '/actuator'
2025-08-04 07:48:26.755 [main] INFO  [] [] o.s.t.w.s.TestDispatcherServlet - Completed initialization in 6 ms
2025-08-04 07:48:26.777 [main] INFO  [] [] c.j.p.i.c.PedidoControllerHttpStatusTest - Started PedidoControllerHttpStatusTest in 0.384 seconds (process running for 3.641)
2025-08-04 07:48:27.039 [main] DEBUG [] [] org.hibernate.SQL - select c1_0.id,c1_0.nombre from cliente c1_0
2025-08-04 07:48:27.042 [main] DEBUG [] [] org.hibernate.SQL - select z1_0.id,z1_0.soporte_refrigeracion from zona z1_0
2025-08-04 07:48:27.045 [main] DEBUG [] [] org.hibernate.SQL - delete from cliente where id=?
2025-08-04 07:48:27.046 [main] DEBUG [] [] org.hibernate.SQL - delete from cliente where id=?
2025-08-04 07:48:27.046 [main] DEBUG [] [] org.hibernate.SQL - delete from zona where id=?
2025-08-04 07:48:27.046 [main] DEBUG [] [] org.hibernate.SQL - delete from zona where id=?
2025-08-04 07:48:27.047 [main] DEBUG [] [] org.hibernate.SQL - select z1_0.id,z1_0.soporte_refrigeracion from zona z1_0 where z1_0.id=?
2025-08-04 07:48:27.077 [main] INFO  [] [HTTP_REQUEST] c.j.p.i.controller.PedidoController - [INICIO_CARGA_CSV] POST /pedidos/cargar - Request ID: a949ca0e - Archivo: pedidos.csv - Tamaño: 122 bytes
2025-08-04 07:48:27.077 [main] INFO  [] [CARGA_CSV] c.j.p.a.usecase.CargarPedidosUseCase - [INICIO_CARGA_CSV] Iniciando procesamiento de archivo: pedidos.csv (tamaño: 122 bytes)
2025-08-04 07:48:27.083 [main] INFO  [] [CARGA_CSV] c.j.p.a.usecase.CargarPedidosUseCase - [INICIO_CARGA_CSV] Procesando 1 filas de datos (excluyendo cabecera)
2025-08-04 07:48:27.084 [main] DEBUG [P001] [CARGA_CSV] c.j.p.a.usecase.CargarPedidosUseCase - [INICIO_VALIDACION] Iniciando validación completa de pedido: P001
2025-08-04 07:48:27.084 [main] INFO  [P001] [CARGA_CSV] c.j.p.domain.service.PedidoValidator - [INICIO_VALIDACION] Validando número de pedido: P001
2025-08-04 07:48:27.121 [main] DEBUG [P001] [CARGA_CSV] org.hibernate.SQL - select count(*) from pedido p1_0 where p1_0.numero_pedido=?
2025-08-04 07:48:27.124 [main] DEBUG [P001] [CARGA_CSV] c.j.p.domain.service.PedidoValidator - [PEDIDO_VALIDO] Número de pedido único y válido: P001
2025-08-04 07:48:27.124 [main] DEBUG [P001] [CARGA_CSV] c.j.p.d.service.ClienteValidator - [INICIO_VALIDACION] Validando cliente: CLI-123
2025-08-04 07:48:27.126 [main] DEBUG [P001] [CARGA_CSV] c.j.p.d.service.ClienteValidator - [PEDIDO_VALIDO] Cliente válido encontrado: CLI-123 - Test Cliente
2025-08-04 07:48:27.126 [main] DEBUG [P001] [CARGA_CSV] c.j.p.domain.service.FechaValidator - [INICIO_VALIDACION] Validando fecha de entrega: 2099-08-10
2025-08-04 07:48:27.127 [main] DEBUG [P001] [CARGA_CSV] c.j.p.domain.service.FechaValidator - [PEDIDO_VALIDO] Fecha de entrega válida: 2099-08-10 (días desde hoy: 27034)
2025-08-04 07:48:27.127 [main] DEBUG [P001] [CARGA_CSV] c.j.p.domain.service.EstadoValidator - [INICIO_VALIDACION] Validando estado: PENDIENTE
2025-08-04 07:48:27.127 [main] DEBUG [P001] [CARGA_CSV] c.j.p.domain.service.EstadoValidator - [PEDIDO_VALIDO] Estado válido: PENDIENTE
2025-08-04 07:48:27.127 [main] DEBUG [P001] [CARGA_CSV] c.j.p.domain.service.ZonaValidator - [INICIO_VALIDACION] Validando zona: ZONA1 con refrigeración: true
2025-08-04 07:48:27.129 [main] DEBUG [P001] [CARGA_CSV] c.j.p.domain.service.ZonaValidator - [PEDIDO_VALIDO] Zona válida: ZONA1 - Soporte refrigeración: true - Requerido: true
2025-08-04 07:48:27.129 [main] DEBUG [P001] [CARGA_CSV] c.j.p.a.usecase.CargarPedidosUseCase - [PEDIDO_VALIDO] Todas las validaciones pasaron exitosamente
2025-08-04 07:48:27.129 [main] DEBUG [P001] [CONVERSION] c.j.p.a.usecase.CargarPedidosUseCase - [PEDIDO_PROCESADO] Convirtiendo DTO a entidad de dominio: P001
2025-08-04 07:48:27.129 [main] DEBUG [P001] [CONVERSION] c.j.p.a.usecase.CargarPedidosUseCase - [PEDIDO_PROCESADO] Conversión exitosa - Pedido: P001, Cliente: CLI-123, Fecha: 2099-08-10, Estado: PENDIENTE, Zona: ZONA1, Refrigeración: true
2025-08-04 07:48:27.129 [main] DEBUG [P001] [CONVERSION] c.j.p.a.usecase.CargarPedidosUseCase - [PEDIDO_PROCESADO] Pedido válido agregado para guardado: P001
2025-08-04 07:48:27.129 [main] INFO  [P001] [PERSISTENCIA] c.j.p.a.usecase.CargarPedidosUseCase - [PEDIDO_GUARDADO] Guardando 1 pedidos válidos en base de datos
2025-08-04 07:48:27.131 [main] DEBUG [P001] [PERSISTENCIA] org.hibernate.SQL - select p1_0.numero_pedido,p1_0.cliente_id,c1_0.id,c1_0.nombre,p1_0.estado,p1_0.fecha_entrega,p1_0.requiere_refrigeracion,p1_0.zona_entrega,ze1_0.id,ze1_0.soporte_refrigeracion from pedido p1_0 join cliente c1_0 on c1_0.id=p1_0.cliente_id join zona ze1_0 on ze1_0.id=p1_0.zona_entrega where p1_0.numero_pedido=?
2025-08-04 07:48:27.133 [main] INFO  [P001] [PERSISTENCIA] c.j.p.a.usecase.CargarPedidosUseCase - [PEDIDO_GUARDADO] Guardados exitosamente 1 pedidos
2025-08-04 07:48:27.133 [main] INFO  [] [] c.j.p.a.usecase.CargarPedidosUseCase - [RESUMEN_PROCESAMIENTO] Procesamiento completado - Total: 1, Guardados: 1, Errores: 0
2025-08-04 07:48:27.133 [main] INFO  [] [] c.j.p.i.controller.PedidoController - [FIN_CARGA_CSV] Request ID: a949ca0e - Procesamiento completado en 56ms - Total: 1, Guardados: 1, Tipos de errores: 0
2025-08-04 07:48:27.183 [main] INFO  [] [] o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-08-04 07:48:27.183 [main] DEBUG [] [] org.hibernate.SQL - drop table if exists cliente cascade 
2025-08-04 07:48:27.184 [main] DEBUG [] [] org.hibernate.SQL - drop table if exists pedido cascade 
2025-08-04 07:48:27.184 [main] DEBUG [] [] org.hibernate.SQL - drop table if exists zona cascade 
2025-08-04 07:48:27.185 [main] INFO  [] [] com.zaxxer.hikari.HikariDataSource - HikariPool-2 - Shutdown initiated...
2025-08-04 07:48:27.186 [main] INFO  [] [] com.zaxxer.hikari.HikariDataSource - HikariPool-2 - Shutdown completed.
2025-08-04 07:48:27.188 [main] INFO  [] [] o.s.b.d.r.RestartApplicationListener - Restart disabled due to context in which it is running
2025-08-04 07:48:27.204 [main] INFO  [] [] c.j.p.i.c.PedidoControllerHttpStatusTest - Starting PedidoControllerHttpStatusTest using Java 17.0.15 with PID 97381 (started by josuepatricio in /Users/josuepatricio/Downloads/pedidos-ms)
2025-08-04 07:48:27.205 [main] DEBUG [] [] c.j.p.i.c.PedidoControllerHttpStatusTest - Running with Spring Boot v3.5.4, Spring v6.2.9
2025-08-04 07:48:27.205 [main] INFO  [] [] c.j.p.i.c.PedidoControllerHttpStatusTest - The following 1 profile is active: "test"
2025-08-04 07:48:27.313 [main] INFO  [] [] o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-08-04 07:48:27.318 [main] INFO  [] [] o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 4 ms. Found 3 JPA repository interfaces.
2025-08-04 07:48:27.354 [main] INFO  [] [] o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-08-04 07:48:27.354 [main] INFO  [] [] com.zaxxer.hikari.HikariDataSource - HikariPool-3 - Starting...
2025-08-04 07:48:27.355 [main] INFO  [] [] com.zaxxer.hikari.pool.HikariPool - HikariPool-3 - Added connection conn20: url=jdbc:h2:mem:testdb user=SA
2025-08-04 07:48:27.355 [main] INFO  [] [] com.zaxxer.hikari.HikariDataSource - HikariPool-3 - Start completed.
2025-08-04 07:48:27.355 [main] WARN  [] [] org.hibernate.orm.deprecation - HHH90000025: H2Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-08-04 07:48:27.369 [main] DEBUG [] [] org.hibernate.SQL - drop table if exists cliente cascade 
2025-08-04 07:48:27.369 [main] DEBUG [] [] org.hibernate.SQL - drop table if exists pedido cascade 
2025-08-04 07:48:27.369 [main] DEBUG [] [] org.hibernate.SQL - drop table if exists zona cascade 
2025-08-04 07:48:27.369 [main] DEBUG [] [] org.hibernate.SQL - create table cliente (id varchar(255) not null, nombre varchar(255), primary key (id))
2025-08-04 07:48:27.370 [main] DEBUG [] [] org.hibernate.SQL - create table pedido (fecha_entrega date, requiere_refrigeracion boolean not null, cliente_id varchar(255) not null, numero_pedido varchar(255) not null, zona_entrega varchar(255) not null, estado enum ('CONFIRMADO','ENTREGADO','PENDIENTE'), primary key (numero_pedido))
2025-08-04 07:48:27.371 [main] DEBUG [] [] org.hibernate.SQL - create table zona (soporte_refrigeracion boolean not null, id varchar(255) not null, primary key (id))
2025-08-04 07:48:27.371 [main] DEBUG [] [] org.hibernate.SQL - alter table if exists pedido add constraint FK30s8j2ktpay6of18lbyqn3632 foreign key (cliente_id) references cliente
2025-08-04 07:48:27.372 [main] DEBUG [] [] org.hibernate.SQL - alter table if exists pedido add constraint FK1aokin5yjk78h5cax5jju4fs9 foreign key (zona_entrega) references zona
2025-08-04 07:48:27.373 [main] INFO  [] [] o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-08-04 07:48:27.397 [main] DEBUG [] [] org.hibernate.SQL - select count(*) from cliente c1_0
2025-08-04 07:48:27.402 [main] DEBUG [] [] org.hibernate.SQL - select c1_0.id,c1_0.nombre from cliente c1_0 where c1_0.id=?
2025-08-04 07:48:27.403 [main] DEBUG [] [] org.hibernate.SQL - insert into cliente (nombre,id) values (?,?)
2025-08-04 07:48:27.404 [main] DEBUG [] [] org.hibernate.SQL - select c1_0.id,c1_0.nombre from cliente c1_0 where c1_0.id=?
2025-08-04 07:48:27.405 [main] DEBUG [] [] org.hibernate.SQL - insert into cliente (nombre,id) values (?,?)
2025-08-04 07:48:27.406 [main] DEBUG [] [] org.hibernate.SQL - select count(*) from zona z1_0
2025-08-04 07:48:27.407 [main] DEBUG [] [] org.hibernate.SQL - select z1_0.id,z1_0.soporte_refrigeracion from zona z1_0 where z1_0.id=?
2025-08-04 07:48:27.409 [main] DEBUG [] [] org.hibernate.SQL - insert into zona (soporte_refrigeracion,id) values (?,?)
2025-08-04 07:48:27.410 [main] DEBUG [] [] org.hibernate.SQL - select z1_0.id,z1_0.soporte_refrigeracion from zona z1_0 where z1_0.id=?
2025-08-04 07:48:27.411 [main] DEBUG [] [] org.hibernate.SQL - insert into zona (soporte_refrigeracion,id) values (?,?)
2025-08-04 07:48:27.425 [main] WARN  [] [] o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-08-04 07:48:27.482 [main] INFO  [] [] o.s.b.a.h.H2ConsoleAutoConfiguration - H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:testdb'
2025-08-04 07:48:27.487 [main] INFO  [] [] o.s.b.t.m.w.SpringBootMockServletContext - Initializing Spring TestDispatcherServlet ''
2025-08-04 07:48:27.487 [main] INFO  [] [] o.s.t.w.s.TestDispatcherServlet - Initializing Servlet ''
2025-08-04 07:48:27.488 [main] INFO  [] [] o.s.b.a.e.web.EndpointLinksResolver - Exposing 1 endpoint beneath base path '/actuator'
2025-08-04 07:48:27.493 [main] INFO  [] [] o.s.t.w.s.TestDispatcherServlet - Completed initialization in 6 ms
2025-08-04 07:48:27.511 [main] INFO  [] [] c.j.p.i.c.PedidoControllerHttpStatusTest - Started PedidoControllerHttpStatusTest in 0.323 seconds (process running for 4.375)
2025-08-04 07:48:27.515 [main] DEBUG [] [] org.hibernate.SQL - select c1_0.id,c1_0.nombre from cliente c1_0
2025-08-04 07:48:27.517 [main] DEBUG [] [] org.hibernate.SQL - select z1_0.id,z1_0.soporte_refrigeracion from zona z1_0
2025-08-04 07:48:27.518 [main] DEBUG [] [] org.hibernate.SQL - delete from cliente where id=?
2025-08-04 07:48:27.518 [main] DEBUG [] [] org.hibernate.SQL - delete from cliente where id=?
2025-08-04 07:48:27.519 [main] DEBUG [] [] org.hibernate.SQL - delete from zona where id=?
2025-08-04 07:48:27.519 [main] DEBUG [] [] org.hibernate.SQL - delete from zona where id=?
2025-08-04 07:48:27.520 [main] DEBUG [] [] org.hibernate.SQL - select z1_0.id,z1_0.soporte_refrigeracion from zona z1_0 where z1_0.id=?
2025-08-04 07:48:27.523 [main] INFO  [] [HTTP_REQUEST] c.j.p.i.controller.PedidoController - [INICIO_CARGA_CSV] POST /pedidos/cargar - Request ID: f3427cec - Archivo: pedidos.csv - Tamaño: 61 bytes
2025-08-04 07:48:27.523 [main] INFO  [] [CARGA_CSV] c.j.p.a.usecase.CargarPedidosUseCase - [INICIO_CARGA_CSV] Iniciando procesamiento de archivo: pedidos.csv (tamaño: 61 bytes)
2025-08-04 07:48:27.528 [main] ERROR [] [CARGA_CSV] c.j.p.a.usecase.CargarPedidosUseCase - [[ERROR_LECTURA_CSV, pedidos.csv]] Error al leer archivo CSV: {}
com.opencsv.exceptions.CsvMalformedLineException: Unterminated quoted field at end of CSV line. Beginning of lost text: [P001,CLI-123,2099-08-10
]
	at com.opencsv.CSVReader.primeNextRecord(CSVReader.java:245) ~[opencsv-5.8.jar:na]
	at com.opencsv.CSVReader.flexibleRead(CSVReader.java:610) ~[opencsv-5.8.jar:na]
	at com.opencsv.CSVReader.readNext(CSVReader.java:204) ~[opencsv-5.8.jar:na]
	at com.opencsv.CSVReader.readAll(CSVReader.java:186) ~[opencsv-5.8.jar:na]
	at com.josue.pedidos_ms.application.usecase.CargarPedidosUseCase.procesarArchivo(CargarPedidosUseCase.java:57) ~[classes/:na]
	at com.josue.pedidos_ms.infrastructure.controller.PedidoController.cargarArchivo(PedidoController.java:54) ~[classes/:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:569) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.9.jar:6.2.9]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.9.jar:6.2.9]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.9.jar:6.2.9]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991) ~[spring-webmvc-6.2.9.jar:6.2.9]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896) ~[spring-webmvc-6.2.9.jar:6.2.9]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.9.jar:6.2.9]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.9.jar:6.2.9]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.9.jar:6.2.9]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.9.jar:6.2.9]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914) ~[spring-webmvc-6.2.9.jar:6.2.9]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590) ~[tomcat-embed-core-10.1.43.jar:6.0]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.9.jar:6.2.9]
	at org.springframework.test.web.servlet.TestDispatcherServlet.service(TestDispatcherServlet.java:72) ~[spring-test-6.2.9.jar:6.2.9]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.43.jar:6.0]
	at org.springframework.mock.web.MockFilterChain$ServletFilterProxy.doFilter(MockFilterChain.java:165) ~[spring-test-6.2.9.jar:6.2.9]
	at org.springframework.mock.web.MockFilterChain.doFilter(MockFilterChain.java:132) ~[spring-test-6.2.9.jar:6.2.9]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.9.jar:6.2.9]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.9.jar:6.2.9]
	at org.springframework.test.web.servlet.setup.MockMvcFilterDecorator.doFilter(MockMvcFilterDecorator.java:162) ~[spring-test-6.2.9.jar:6.2.9]
	at org.springframework.mock.web.MockFilterChain.doFilter(MockFilterChain.java:132) ~[spring-test-6.2.9.jar:6.2.9]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.9.jar:6.2.9]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.9.jar:6.2.9]
	at org.springframework.test.web.servlet.setup.MockMvcFilterDecorator.doFilter(MockMvcFilterDecorator.java:162) ~[spring-test-6.2.9.jar:6.2.9]
	at org.springframework.mock.web.MockFilterChain.doFilter(MockFilterChain.java:132) ~[spring-test-6.2.9.jar:6.2.9]
	at org.springframework.web.filter.ServerHttpObservationFilter.doFilterInternal(ServerHttpObservationFilter.java:110) ~[spring-web-6.2.9.jar:6.2.9]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.9.jar:6.2.9]
	at org.springframework.test.web.servlet.setup.MockMvcFilterDecorator.doFilter(MockMvcFilterDecorator.java:162) ~[spring-test-6.2.9.jar:6.2.9]
	at org.springframework.mock.web.MockFilterChain.doFilter(MockFilterChain.java:132) ~[spring-test-6.2.9.jar:6.2.9]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.9.jar:6.2.9]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.9.jar:6.2.9]
	at org.springframework.test.web.servlet.setup.MockMvcFilterDecorator.doFilter(MockMvcFilterDecorator.java:162) ~[spring-test-6.2.9.jar:6.2.9]
	at org.springframework.mock.web.MockFilterChain.doFilter(MockFilterChain.java:132) ~[spring-test-6.2.9.jar:6.2.9]
	at org.springframework.test.web.servlet.MockMvc.perform(MockMvc.java:201) ~[spring-test-6.2.9.jar:6.2.9]
	at com.josue.pedidos_ms.infrastructure.controller.PedidoControllerHttpStatusTest.debeRetornar400CuandoElCsvEsMalformado(PedidoControllerHttpStatusTest.java:117) ~[test-classes/:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:569) ~[na:na]
	at org.junit.platform.commons.util.ReflectionUtils.invokeMethod(ReflectionUtils.java:775) ~[junit-platform-commons-1.12.2.jar:1.12.2]
	at org.junit.platform.commons.support.ReflectionSupport.invokeMethod(ReflectionSupport.java:479) ~[junit-platform-commons-1.12.2.jar:1.12.2]
	at org.junit.jupiter.engine.execution.MethodInvocation.proceed(MethodInvocation.java:60) ~[junit-jupiter-engine-5.12.2.jar:5.12.2]
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$ValidatingInvocation.proceed(InvocationInterceptorChain.java:131) ~[junit-jupiter-engine-5.12.2.jar:5.12.2]
	at org.junit.jupiter.engine.extension.TimeoutExtension.intercept(TimeoutExtension.java:161) ~[junit-jupiter-engine-5.12.2.jar:5.12.2]
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestableMethod(TimeoutExtension.java:152) ~[junit-jupiter-engine-5.12.2.jar:5.12.2]
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestMethod(TimeoutExtension.java:91) ~[junit-jupiter-engine-5.12.2.jar:5.12.2]
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker$ReflectiveInterceptorCall.lambda$ofVoidMethod$0(InterceptingExecutableInvoker.java:112) ~[junit-jupiter-engine-5.12.2.jar:5.12.2]
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.lambda$invoke$0(InterceptingExecutableInvoker.java:94) ~[junit-jupiter-engine-5.12.2.jar:5.12.2]
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$InterceptedInvocation.proceed(InvocationInterceptorChain.java:106) ~[junit-jupiter-engine-5.12.2.jar:5.12.2]
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.proceed(InvocationInterceptorChain.java:64) ~[junit-jupiter-engine-5.12.2.jar:5.12.2]
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.chainAndInvoke(InvocationInterceptorChain.java:45) ~[junit-jupiter-engine-5.12.2.jar:5.12.2]
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.invoke(InvocationInterceptorChain.java:37) ~[junit-jupiter-engine-5.12.2.jar:5.12.2]
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.invoke(InterceptingExecutableInvoker.java:93) ~[junit-jupiter-engine-5.12.2.jar:5.12.2]
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.invoke(InterceptingExecutableInvoker.java:87) ~[junit-jupiter-engine-5.12.2.jar:5.12.2]
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeTestMethod$7(TestMethodTestDescriptor.java:216) ~[junit-jupiter-engine-5.12.2.jar:5.12.2]
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73) ~[junit-platform-engine-1.12.2.jar:1.12.2]
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeTestMethod(TestMethodTestDescriptor.java:212) ~[junit-jupiter-engine-5.12.2.jar:5.12.2]
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:137) ~[junit-jupiter-engine-5.12.2.jar:5.12.2]
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:69) ~[junit-jupiter-engine-5.12.2.jar:5.12.2]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:156) ~[junit-platform-engine-1.12.2.jar:1.12.2]
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73) ~[junit-platform-engine-1.12.2.jar:1.12.2]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:146) ~[junit-platform-engine-1.12.2.jar:1.12.2]
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137) ~[junit-platform-engine-1.12.2.jar:1.12.2]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:144) ~[junit-platform-engine-1.12.2.jar:1.12.2]
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73) ~[junit-platform-engine-1.12.2.jar:1.12.2]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:143) ~[junit-platform-engine-1.12.2.jar:1.12.2]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:100) ~[junit-platform-engine-1.12.2.jar:1.12.2]
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511) ~[na:na]
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41) ~[junit-platform-engine-1.12.2.jar:1.12.2]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:160) ~[junit-platform-engine-1.12.2.jar:1.12.2]
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73) ~[junit-platform-engine-1.12.2.jar:1.12.2]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:146) ~[junit-platform-engine-1.12.2.jar:1.12.2]
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137) ~[junit-platform-engine-1.12.2.jar:1.12.2]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:144) ~[junit-platform-engine-1.12.2.jar:1.12.2]
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73) ~[junit-platform-engine-1.12.2.jar:1.12.2]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:143) ~[junit-platform-engine-1.12.2.jar:1.12.2]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:100) ~[junit-platform-engine-1.12.2.jar:1.12.2]
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511) ~[na:na]
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41) ~[junit-platform-engine-1.12.2.jar:1.12.2]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:160) ~[junit-platform-engine-1.12.2.jar:1.12.2]
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73) ~[junit-platform-engine-1.12.2.jar:1.12.2]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:146) ~[junit-platform-engine-1.12.2.jar:1.12.2]
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137) ~[junit-platform-engine-1.12.2.jar:1.12.2]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:144) ~[junit-platform-engine-1.12.2.jar:1.12.2]
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73) ~[junit-platform-engine-1.12.2.jar:1.12.2]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:143) ~[junit-platform-engine-1.12.2.jar:1.12.2]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:100) ~[junit-platform-engine-1.12.2.jar:1.12.2]
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:35) ~[junit-platform-engine-1.12.2.jar:1.12.2]
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57) ~[junit-platform-engine-1.12.2.jar:1.12.2]
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:54) ~[junit-platform-engine-1.12.2.jar:1.12.2]
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:201) ~[junit-platform-launcher-1.12.2.jar:1.12.2]
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:170) ~[junit-platform-launcher-1.12.2.jar:1.12.2]
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:94) ~[junit-platform-launcher-1.12.2.jar:1.12.2]
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:59) ~[junit-platform-launcher-1.12.2.jar:1.12.2]
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:142) ~[junit-platform-launcher-1.12.2.jar:1.12.2]
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:58) ~[junit-platform-launcher-1.12.2.jar:1.12.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:103) ~[junit-platform-launcher-1.12.2.jar:1.12.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:94) ~[junit-platform-launcher-1.12.2.jar:1.12.2]
	at org.junit.platform.launcher.core.DelegatingLauncher.execute(DelegatingLauncher.java:52) ~[junit-platform-launcher-1.12.2.jar:1.12.2]
	at org.junit.platform.launcher.core.InterceptingLauncher.lambda$execute$2(InterceptingLauncher.java:47) ~[junit-platform-launcher-1.12.2.jar:1.12.2]
	at org.junit.platform.launcher.core.ClasspathAlignmentCheckingLauncherInterceptor.intercept(ClasspathAlignmentCheckingLauncherInterceptor.java:25) ~[junit-platform-launcher-1.12.2.jar:1.12.2]
	at org.junit.platform.launcher.core.InterceptingLauncher.execute(InterceptingLauncher.java:46) ~[junit-platform-launcher-1.12.2.jar:1.12.2]
	at org.junit.platform.launcher.core.DelegatingLauncher.execute(DelegatingLauncher.java:52) ~[junit-platform-launcher-1.12.2.jar:1.12.2]
	at org.junit.platform.launcher.core.SessionPerRequestLauncher.execute(SessionPerRequestLauncher.java:70) ~[junit-platform-launcher-1.12.2.jar:1.12.2]
	at org.eclipse.jdt.internal.junit5.runner.JUnit5TestReference.run(JUnit5TestReference.java:100) ~[.cp/:na]
	at org.eclipse.jdt.internal.junit.runner.TestExecution.run(TestExecution.java:40) ~[.cp/:na]
	at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:520) ~[.cp/:na]
	at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:748) ~[.cp/:na]
	at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:443) ~[.cp/:na]
	at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.main(RemoteTestRunner.java:211) ~[.cp/:na]
2025-08-04 07:48:27.533 [main] WARN  [] [] c.j.p.i.c.GlobalExceptionHandler - [ERROR_LECTURA_CSV] Error de validación CSV: Archivo CSV ilegible o mal formateado: Unterminated quoted field at end of CSV line. Beginning of lost text: [P001,CLI-123,2099-08-10
]
2025-08-04 07:48:27.555 [main] INFO  [] [] o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-08-04 07:48:27.555 [main] DEBUG [] [] org.hibernate.SQL - drop table if exists cliente cascade 
2025-08-04 07:48:27.556 [main] DEBUG [] [] org.hibernate.SQL - drop table if exists pedido cascade 
2025-08-04 07:48:27.558 [main] DEBUG [] [] org.hibernate.SQL - drop table if exists zona cascade 
2025-08-04 07:48:27.560 [main] INFO  [] [] com.zaxxer.hikari.HikariDataSource - HikariPool-3 - Shutdown initiated...
2025-08-04 07:48:27.565 [main] INFO  [] [] com.zaxxer.hikari.HikariDataSource - HikariPool-3 - Shutdown completed.
2025-08-04 07:48:27.569 [main] INFO  [] [] o.s.b.d.r.RestartApplicationListener - Restart disabled due to context in which it is running
2025-08-04 07:48:27.595 [main] INFO  [] [] c.j.p.i.c.PedidoControllerHttpStatusTest - Starting PedidoControllerHttpStatusTest using Java 17.0.15 with PID 97381 (started by josuepatricio in /Users/josuepatricio/Downloads/pedidos-ms)
2025-08-04 07:48:27.596 [main] DEBUG [] [] c.j.p.i.c.PedidoControllerHttpStatusTest - Running with Spring Boot v3.5.4, Spring v6.2.9
2025-08-04 07:48:27.596 [main] INFO  [] [] c.j.p.i.c.PedidoControllerHttpStatusTest - The following 1 profile is active: "test"
2025-08-04 07:48:27.703 [main] INFO  [] [] o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-08-04 07:48:27.707 [main] INFO  [] [] o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 4 ms. Found 3 JPA repository interfaces.
2025-08-04 07:48:27.742 [main] INFO  [] [] o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-08-04 07:48:27.743 [main] INFO  [] [] com.zaxxer.hikari.HikariDataSource - HikariPool-4 - Starting...
2025-08-04 07:48:27.744 [main] INFO  [] [] com.zaxxer.hikari.pool.HikariPool - HikariPool-4 - Added connection conn24: url=jdbc:h2:mem:testdb user=SA
2025-08-04 07:48:27.744 [main] INFO  [] [] com.zaxxer.hikari.HikariDataSource - HikariPool-4 - Start completed.
2025-08-04 07:48:27.744 [main] WARN  [] [] org.hibernate.orm.deprecation - HHH90000025: H2Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-08-04 07:48:27.759 [main] DEBUG [] [] org.hibernate.SQL - drop table if exists cliente cascade 
2025-08-04 07:48:27.759 [main] DEBUG [] [] org.hibernate.SQL - drop table if exists pedido cascade 
2025-08-04 07:48:27.759 [main] DEBUG [] [] org.hibernate.SQL - drop table if exists zona cascade 
2025-08-04 07:48:27.759 [main] DEBUG [] [] org.hibernate.SQL - create table cliente (id varchar(255) not null, nombre varchar(255), primary key (id))
2025-08-04 07:48:27.763 [main] DEBUG [] [] org.hibernate.SQL - create table pedido (fecha_entrega date, requiere_refrigeracion boolean not null, cliente_id varchar(255) not null, numero_pedido varchar(255) not null, zona_entrega varchar(255) not null, estado enum ('CONFIRMADO','ENTREGADO','PENDIENTE'), primary key (numero_pedido))
2025-08-04 07:48:27.764 [main] DEBUG [] [] org.hibernate.SQL - create table zona (soporte_refrigeracion boolean not null, id varchar(255) not null, primary key (id))
2025-08-04 07:48:27.764 [main] DEBUG [] [] org.hibernate.SQL - alter table if exists pedido add constraint FK30s8j2ktpay6of18lbyqn3632 foreign key (cliente_id) references cliente
2025-08-04 07:48:27.765 [main] DEBUG [] [] org.hibernate.SQL - alter table if exists pedido add constraint FK1aokin5yjk78h5cax5jju4fs9 foreign key (zona_entrega) references zona
2025-08-04 07:48:27.766 [main] INFO  [] [] o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-08-04 07:48:27.792 [main] DEBUG [] [] org.hibernate.SQL - select count(*) from cliente c1_0
2025-08-04 07:48:27.797 [main] DEBUG [] [] org.hibernate.SQL - select c1_0.id,c1_0.nombre from cliente c1_0 where c1_0.id=?
2025-08-04 07:48:27.798 [main] DEBUG [] [] org.hibernate.SQL - insert into cliente (nombre,id) values (?,?)
2025-08-04 07:48:27.799 [main] DEBUG [] [] org.hibernate.SQL - select c1_0.id,c1_0.nombre from cliente c1_0 where c1_0.id=?
2025-08-04 07:48:27.800 [main] DEBUG [] [] org.hibernate.SQL - insert into cliente (nombre,id) values (?,?)
2025-08-04 07:48:27.802 [main] DEBUG [] [] org.hibernate.SQL - select count(*) from zona z1_0
2025-08-04 07:48:27.803 [main] DEBUG [] [] org.hibernate.SQL - select z1_0.id,z1_0.soporte_refrigeracion from zona z1_0 where z1_0.id=?
2025-08-04 07:48:27.804 [main] DEBUG [] [] org.hibernate.SQL - insert into zona (soporte_refrigeracion,id) values (?,?)
2025-08-04 07:48:27.805 [main] DEBUG [] [] org.hibernate.SQL - select z1_0.id,z1_0.soporte_refrigeracion from zona z1_0 where z1_0.id=?
2025-08-04 07:48:27.805 [main] DEBUG [] [] org.hibernate.SQL - insert into zona (soporte_refrigeracion,id) values (?,?)
2025-08-04 07:48:27.820 [main] WARN  [] [] o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-08-04 07:48:27.870 [main] INFO  [] [] o.s.b.a.h.H2ConsoleAutoConfiguration - H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:testdb'
2025-08-04 07:48:27.874 [main] INFO  [] [] o.s.b.t.m.w.SpringBootMockServletContext - Initializing Spring TestDispatcherServlet ''
2025-08-04 07:48:27.874 [main] INFO  [] [] o.s.t.w.s.TestDispatcherServlet - Initializing Servlet ''
2025-08-04 07:48:27.875 [main] INFO  [] [] o.s.b.a.e.web.EndpointLinksResolver - Exposing 1 endpoint beneath base path '/actuator'
2025-08-04 07:48:27.877 [main] INFO  [] [] o.s.t.w.s.TestDispatcherServlet - Completed initialization in 3 ms
2025-08-04 07:48:27.895 [main] INFO  [] [] c.j.p.i.c.PedidoControllerHttpStatusTest - Started PedidoControllerHttpStatusTest in 0.327 seconds (process running for 4.758)
2025-08-04 07:48:27.898 [main] DEBUG [] [] org.hibernate.SQL - select c1_0.id,c1_0.nombre from cliente c1_0
2025-08-04 07:48:27.900 [main] DEBUG [] [] org.hibernate.SQL - select z1_0.id,z1_0.soporte_refrigeracion from zona z1_0
2025-08-04 07:48:27.901 [main] DEBUG [] [] org.hibernate.SQL - delete from cliente where id=?
2025-08-04 07:48:27.902 [main] DEBUG [] [] org.hibernate.SQL - delete from cliente where id=?
2025-08-04 07:48:27.902 [main] DEBUG [] [] org.hibernate.SQL - delete from zona where id=?
2025-08-04 07:48:27.902 [main] DEBUG [] [] org.hibernate.SQL - delete from zona where id=?
2025-08-04 07:48:27.903 [main] DEBUG [] [] org.hibernate.SQL - select z1_0.id,z1_0.soporte_refrigeracion from zona z1_0 where z1_0.id=?
2025-08-04 07:48:27.905 [main] INFO  [] [HTTP_REQUEST] c.j.p.i.controller.PedidoController - [INICIO_CARGA_CSV] POST /pedidos/cargar - Request ID: c12d49f4 - Archivo: pedidos.csv - Tamaño: 0 bytes
2025-08-04 07:48:27.905 [main] WARN  [] [HTTP_REQUEST] c.j.p.i.controller.PedidoController - [ARCHIVO_VACIO] Request ID: c12d49f4 - Archivo vacío recibido
2025-08-04 07:48:27.905 [main] WARN  [] [] c.j.p.i.c.GlobalExceptionHandler - [ERROR_LECTURA_CSV] Error de validación CSV: El archivo está vacío
2025-08-04 07:48:27.913 [main] INFO  [] [] o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-08-04 07:48:27.913 [main] DEBUG [] [] org.hibernate.SQL - drop table if exists cliente cascade 
2025-08-04 07:48:27.914 [main] DEBUG [] [] org.hibernate.SQL - drop table if exists pedido cascade 
2025-08-04 07:48:27.914 [main] DEBUG [] [] org.hibernate.SQL - drop table if exists zona cascade 
2025-08-04 07:48:27.915 [main] INFO  [] [] com.zaxxer.hikari.HikariDataSource - HikariPool-4 - Shutdown initiated...
2025-08-04 07:48:27.943 [main] INFO  [] [] com.zaxxer.hikari.HikariDataSource - HikariPool-4 - Shutdown completed.
2025-08-04 07:48:27.944 [main] INFO  [] [] o.s.b.d.r.RestartApplicationListener - Restart disabled due to context in which it is running
2025-08-04 07:48:27.957 [main] INFO  [] [] c.j.p.i.c.PedidoControllerHttpStatusTest - Starting PedidoControllerHttpStatusTest using Java 17.0.15 with PID 97381 (started by josuepatricio in /Users/josuepatricio/Downloads/pedidos-ms)
2025-08-04 07:48:27.957 [main] DEBUG [] [] c.j.p.i.c.PedidoControllerHttpStatusTest - Running with Spring Boot v3.5.4, Spring v6.2.9
2025-08-04 07:48:27.957 [main] INFO  [] [] c.j.p.i.c.PedidoControllerHttpStatusTest - The following 1 profile is active: "test"
2025-08-04 07:48:28.079 [main] INFO  [] [] o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-08-04 07:48:28.083 [main] INFO  [] [] o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 3 ms. Found 3 JPA repository interfaces.
2025-08-04 07:48:28.116 [main] INFO  [] [] o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-08-04 07:48:28.116 [main] INFO  [] [] com.zaxxer.hikari.HikariDataSource - HikariPool-5 - Starting...
2025-08-04 07:48:28.117 [main] INFO  [] [] com.zaxxer.hikari.pool.HikariPool - HikariPool-5 - Added connection conn28: url=jdbc:h2:mem:testdb user=SA
2025-08-04 07:48:28.117 [main] INFO  [] [] com.zaxxer.hikari.HikariDataSource - HikariPool-5 - Start completed.
2025-08-04 07:48:28.117 [main] WARN  [] [] org.hibernate.orm.deprecation - HHH90000025: H2Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-08-04 07:48:28.133 [main] DEBUG [] [] org.hibernate.SQL - drop table if exists cliente cascade 
2025-08-04 07:48:28.134 [main] DEBUG [] [] org.hibernate.SQL - drop table if exists pedido cascade 
2025-08-04 07:48:28.134 [main] DEBUG [] [] org.hibernate.SQL - drop table if exists zona cascade 
2025-08-04 07:48:28.134 [main] DEBUG [] [] org.hibernate.SQL - create table cliente (id varchar(255) not null, nombre varchar(255), primary key (id))
2025-08-04 07:48:28.135 [main] DEBUG [] [] org.hibernate.SQL - create table pedido (fecha_entrega date, requiere_refrigeracion boolean not null, cliente_id varchar(255) not null, numero_pedido varchar(255) not null, zona_entrega varchar(255) not null, estado enum ('CONFIRMADO','ENTREGADO','PENDIENTE'), primary key (numero_pedido))
2025-08-04 07:48:28.135 [main] DEBUG [] [] org.hibernate.SQL - create table zona (soporte_refrigeracion boolean not null, id varchar(255) not null, primary key (id))
2025-08-04 07:48:28.136 [main] DEBUG [] [] org.hibernate.SQL - alter table if exists pedido add constraint FK30s8j2ktpay6of18lbyqn3632 foreign key (cliente_id) references cliente
2025-08-04 07:48:28.136 [main] DEBUG [] [] org.hibernate.SQL - alter table if exists pedido add constraint FK1aokin5yjk78h5cax5jju4fs9 foreign key (zona_entrega) references zona
2025-08-04 07:48:28.138 [main] INFO  [] [] o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-08-04 07:48:28.153 [main] DEBUG [] [] org.hibernate.SQL - select count(*) from cliente c1_0
2025-08-04 07:48:28.157 [main] DEBUG [] [] org.hibernate.SQL - select c1_0.id,c1_0.nombre from cliente c1_0 where c1_0.id=?
2025-08-04 07:48:28.158 [main] DEBUG [] [] org.hibernate.SQL - insert into cliente (nombre,id) values (?,?)
2025-08-04 07:48:28.159 [main] DEBUG [] [] org.hibernate.SQL - select c1_0.id,c1_0.nombre from cliente c1_0 where c1_0.id=?
2025-08-04 07:48:28.159 [main] DEBUG [] [] org.hibernate.SQL - insert into cliente (nombre,id) values (?,?)
2025-08-04 07:48:28.161 [main] DEBUG [] [] org.hibernate.SQL - select count(*) from zona z1_0
2025-08-04 07:48:28.162 [main] DEBUG [] [] org.hibernate.SQL - select z1_0.id,z1_0.soporte_refrigeracion from zona z1_0 where z1_0.id=?
2025-08-04 07:48:28.163 [main] DEBUG [] [] org.hibernate.SQL - insert into zona (soporte_refrigeracion,id) values (?,?)
2025-08-04 07:48:28.164 [main] DEBUG [] [] org.hibernate.SQL - select z1_0.id,z1_0.soporte_refrigeracion from zona z1_0 where z1_0.id=?
2025-08-04 07:48:28.164 [main] DEBUG [] [] org.hibernate.SQL - insert into zona (soporte_refrigeracion,id) values (?,?)
2025-08-04 07:48:28.173 [main] WARN  [] [] o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-08-04 07:48:28.229 [main] INFO  [] [] o.s.b.a.h.H2ConsoleAutoConfiguration - H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:testdb'
2025-08-04 07:48:28.232 [main] INFO  [] [] o.s.b.t.m.w.SpringBootMockServletContext - Initializing Spring TestDispatcherServlet ''
2025-08-04 07:48:28.233 [main] INFO  [] [] o.s.t.w.s.TestDispatcherServlet - Initializing Servlet ''
2025-08-04 07:48:28.234 [main] INFO  [] [] o.s.b.a.e.web.EndpointLinksResolver - Exposing 1 endpoint beneath base path '/actuator'
2025-08-04 07:48:28.237 [main] INFO  [] [] o.s.t.w.s.TestDispatcherServlet - Completed initialization in 4 ms
2025-08-04 07:48:28.253 [main] INFO  [] [] c.j.p.i.c.PedidoControllerHttpStatusTest - Started PedidoControllerHttpStatusTest in 0.309 seconds (process running for 5.117)
2025-08-04 07:48:28.257 [main] DEBUG [] [] org.hibernate.SQL - select c1_0.id,c1_0.nombre from cliente c1_0
2025-08-04 07:48:28.259 [main] DEBUG [] [] org.hibernate.SQL - select z1_0.id,z1_0.soporte_refrigeracion from zona z1_0
2025-08-04 07:48:28.261 [main] DEBUG [] [] org.hibernate.SQL - delete from cliente where id=?
2025-08-04 07:48:28.261 [main] DEBUG [] [] org.hibernate.SQL - delete from cliente where id=?
2025-08-04 07:48:28.261 [main] DEBUG [] [] org.hibernate.SQL - delete from zona where id=?
2025-08-04 07:48:28.262 [main] DEBUG [] [] org.hibernate.SQL - delete from zona where id=?
2025-08-04 07:48:28.262 [main] DEBUG [] [] org.hibernate.SQL - select z1_0.id,z1_0.soporte_refrigeracion from zona z1_0 where z1_0.id=?
2025-08-04 07:48:28.265 [main] INFO  [] [HTTP_REQUEST] c.j.p.i.controller.PedidoController - [INICIO_CARGA_CSV] POST /pedidos/cargar - Request ID: 8e42616f - Archivo: pedidos.csv - Tamaño: 147 bytes
2025-08-04 07:48:28.265 [main] INFO  [] [CARGA_CSV] c.j.p.a.usecase.CargarPedidosUseCase - [INICIO_CARGA_CSV] Iniciando procesamiento de archivo: pedidos.csv (tamaño: 147 bytes)
2025-08-04 07:48:28.265 [main] INFO  [] [CARGA_CSV] c.j.p.a.usecase.CargarPedidosUseCase - [INICIO_CARGA_CSV] Procesando 1 filas de datos (excluyendo cabecera)
2025-08-04 07:48:28.265 [main] DEBUG [P001] [CARGA_CSV] c.j.p.a.usecase.CargarPedidosUseCase - [INICIO_VALIDACION] Iniciando validación completa de pedido: P001
2025-08-04 07:48:28.265 [main] INFO  [P001] [CARGA_CSV] c.j.p.domain.service.PedidoValidator - [INICIO_VALIDACION] Validando número de pedido: P001
2025-08-04 07:48:28.267 [main] DEBUG [P001] [CARGA_CSV] org.hibernate.SQL - select count(*) from pedido p1_0 where p1_0.numero_pedido=?
2025-08-04 07:48:28.267 [main] DEBUG [P001] [CARGA_CSV] c.j.p.domain.service.PedidoValidator - [PEDIDO_VALIDO] Número de pedido único y válido: P001
2025-08-04 07:48:28.267 [main] DEBUG [P001] [CARGA_CSV] c.j.p.d.service.ClienteValidator - [INICIO_VALIDACION] Validando cliente: CLI-INEXISTENTE
2025-08-04 07:48:28.268 [main] DEBUG [P001] [CARGA_CSV] org.hibernate.SQL - select c1_0.id,c1_0.nombre from cliente c1_0 where c1_0.id=?
2025-08-04 07:48:28.268 [main] WARN  [P001] [CARGA_CSV] c.j.p.d.service.ClienteValidator - [PEDIDO_INVALIDO] Cliente no encontrado en base de datos: CLI-INEXISTENTE
2025-08-04 07:48:28.268 [main] DEBUG [P001] [CARGA_CSV] c.j.p.domain.service.FechaValidator - [INICIO_VALIDACION] Validando fecha de entrega: 2020-01-01
2025-08-04 07:48:28.268 [main] WARN  [P001] [CARGA_CSV] c.j.p.domain.service.FechaValidator - [PEDIDO_INVALIDO] Fecha de entrega en el pasado: 2020-01-01 (hoy: 2025-08-04)
2025-08-04 07:48:28.268 [main] DEBUG [P001] [CARGA_CSV] c.j.p.domain.service.EstadoValidator - [INICIO_VALIDACION] Validando estado: ESTADO_INVALIDO
2025-08-04 07:48:28.268 [main] WARN  [P001] [CARGA_CSV] c.j.p.domain.service.EstadoValidator - [PEDIDO_INVALIDO] Estado inválido: ESTADO_INVALIDO. Estados válidos: PENDIENTE, CONFIRMADO, ENTREGADO
2025-08-04 07:48:28.268 [main] DEBUG [P001] [CARGA_CSV] c.j.p.domain.service.ZonaValidator - [INICIO_VALIDACION] Validando zona: ZONA_INEXISTENTE con refrigeración: true
2025-08-04 07:48:28.269 [main] DEBUG [P001] [CARGA_CSV] org.hibernate.SQL - select z1_0.id,z1_0.soporte_refrigeracion from zona z1_0 where z1_0.id=?
2025-08-04 07:48:28.269 [main] WARN  [P001] [CARGA_CSV] c.j.p.domain.service.ZonaValidator - [PEDIDO_INVALIDO] Zona no encontrada en base de datos: ZONA_INEXISTENTE
2025-08-04 07:48:28.270 [main] INFO  [P001] [CARGA_CSV] c.j.p.a.usecase.CargarPedidosUseCase - [ESTADISTICAS_VALIDACION] Validación completada con 4 errores: [Clientes no encontrados, Fecha de entrega inválida, Estado inválido, Zonas inválidas]
2025-08-04 07:48:28.270 [main] WARN  [P001] [CARGA_CSV] c.j.p.a.usecase.CargarPedidosUseCase - [PEDIDO_INVALIDO] Pedido con 4 errores de validación
2025-08-04 07:48:28.270 [main] INFO  [] [] c.j.p.a.usecase.CargarPedidosUseCase - [RESUMEN_PROCESAMIENTO] Procesamiento completado - Total: 1, Guardados: 0, Errores: 4
2025-08-04 07:48:28.270 [main] INFO  [] [] c.j.p.i.controller.PedidoController - [FIN_CARGA_CSV] Request ID: 8e42616f - Procesamiento completado en 5ms - Total: 1, Guardados: 0, Tipos de errores: 4
2025-08-04 07:48:28.270 [main] WARN  [] [] c.j.p.i.controller.PedidoController - [ESTADISTICAS_VALIDACION] Request ID: 8e42616f - Errores de validación encontrados: 4 errores totales
2025-08-04 07:48:28.278 [main] INFO  [] [] o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-08-04 07:48:28.278 [main] DEBUG [] [] org.hibernate.SQL - drop table if exists cliente cascade 
2025-08-04 07:48:28.278 [main] DEBUG [] [] org.hibernate.SQL - drop table if exists pedido cascade 
2025-08-04 07:48:28.278 [main] DEBUG [] [] org.hibernate.SQL - drop table if exists zona cascade 
2025-08-04 07:48:28.279 [main] INFO  [] [] com.zaxxer.hikari.HikariDataSource - HikariPool-5 - Shutdown initiated...
2025-08-04 07:48:28.291 [main] INFO  [] [] com.zaxxer.hikari.HikariDataSource - HikariPool-5 - Shutdown completed.
2025-08-04 07:48:28.292 [main] INFO  [] [] o.s.b.d.r.RestartApplicationListener - Restart disabled due to context in which it is running
2025-08-04 07:48:28.305 [main] INFO  [] [] c.j.p.i.c.PedidoControllerHttpStatusTest - Starting PedidoControllerHttpStatusTest using Java 17.0.15 with PID 97381 (started by josuepatricio in /Users/josuepatricio/Downloads/pedidos-ms)
2025-08-04 07:48:28.305 [main] DEBUG [] [] c.j.p.i.c.PedidoControllerHttpStatusTest - Running with Spring Boot v3.5.4, Spring v6.2.9
2025-08-04 07:48:28.305 [main] INFO  [] [] c.j.p.i.c.PedidoControllerHttpStatusTest - The following 1 profile is active: "test"
2025-08-04 07:48:28.393 [main] INFO  [] [] o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-08-04 07:48:28.397 [main] INFO  [] [] o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 3 ms. Found 3 JPA repository interfaces.
2025-08-04 07:48:28.426 [main] INFO  [] [] o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-08-04 07:48:28.427 [main] INFO  [] [] com.zaxxer.hikari.HikariDataSource - HikariPool-6 - Starting...
2025-08-04 07:48:28.427 [main] INFO  [] [] com.zaxxer.hikari.pool.HikariPool - HikariPool-6 - Added connection conn31: url=jdbc:h2:mem:testdb user=SA
2025-08-04 07:48:28.427 [main] INFO  [] [] com.zaxxer.hikari.HikariDataSource - HikariPool-6 - Start completed.
2025-08-04 07:48:28.428 [main] WARN  [] [] org.hibernate.orm.deprecation - HHH90000025: H2Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-08-04 07:48:28.443 [main] DEBUG [] [] org.hibernate.SQL - drop table if exists cliente cascade 
2025-08-04 07:48:28.444 [main] DEBUG [] [] org.hibernate.SQL - drop table if exists pedido cascade 
2025-08-04 07:48:28.444 [main] DEBUG [] [] org.hibernate.SQL - drop table if exists zona cascade 
2025-08-04 07:48:28.444 [main] DEBUG [] [] org.hibernate.SQL - create table cliente (id varchar(255) not null, nombre varchar(255), primary key (id))
2025-08-04 07:48:28.446 [main] DEBUG [] [] org.hibernate.SQL - create table pedido (fecha_entrega date, requiere_refrigeracion boolean not null, cliente_id varchar(255) not null, numero_pedido varchar(255) not null, zona_entrega varchar(255) not null, estado enum ('CONFIRMADO','ENTREGADO','PENDIENTE'), primary key (numero_pedido))
2025-08-04 07:48:28.446 [main] DEBUG [] [] org.hibernate.SQL - create table zona (soporte_refrigeracion boolean not null, id varchar(255) not null, primary key (id))
2025-08-04 07:48:28.447 [main] DEBUG [] [] org.hibernate.SQL - alter table if exists pedido add constraint FK30s8j2ktpay6of18lbyqn3632 foreign key (cliente_id) references cliente
2025-08-04 07:48:28.448 [main] DEBUG [] [] org.hibernate.SQL - alter table if exists pedido add constraint FK1aokin5yjk78h5cax5jju4fs9 foreign key (zona_entrega) references zona
2025-08-04 07:48:28.449 [main] INFO  [] [] o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-08-04 07:48:28.467 [main] DEBUG [] [] org.hibernate.SQL - select count(*) from cliente c1_0
2025-08-04 07:48:28.471 [main] DEBUG [] [] org.hibernate.SQL - select c1_0.id,c1_0.nombre from cliente c1_0 where c1_0.id=?
2025-08-04 07:48:28.472 [main] DEBUG [] [] org.hibernate.SQL - insert into cliente (nombre,id) values (?,?)
2025-08-04 07:48:28.473 [main] DEBUG [] [] org.hibernate.SQL - select c1_0.id,c1_0.nombre from cliente c1_0 where c1_0.id=?
2025-08-04 07:48:28.474 [main] DEBUG [] [] org.hibernate.SQL - insert into cliente (nombre,id) values (?,?)
2025-08-04 07:48:28.475 [main] DEBUG [] [] org.hibernate.SQL - select count(*) from zona z1_0
2025-08-04 07:48:28.477 [main] DEBUG [] [] org.hibernate.SQL - select z1_0.id,z1_0.soporte_refrigeracion from zona z1_0 where z1_0.id=?
2025-08-04 07:48:28.477 [main] DEBUG [] [] org.hibernate.SQL - insert into zona (soporte_refrigeracion,id) values (?,?)
2025-08-04 07:48:28.479 [main] DEBUG [] [] org.hibernate.SQL - select z1_0.id,z1_0.soporte_refrigeracion from zona z1_0 where z1_0.id=?
2025-08-04 07:48:28.479 [main] DEBUG [] [] org.hibernate.SQL - insert into zona (soporte_refrigeracion,id) values (?,?)
2025-08-04 07:48:28.489 [main] WARN  [] [] o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-08-04 07:48:28.540 [main] INFO  [] [] o.s.b.a.h.H2ConsoleAutoConfiguration - H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:testdb'
2025-08-04 07:48:28.543 [main] INFO  [] [] o.s.b.t.m.w.SpringBootMockServletContext - Initializing Spring TestDispatcherServlet ''
2025-08-04 07:48:28.543 [main] INFO  [] [] o.s.t.w.s.TestDispatcherServlet - Initializing Servlet ''
2025-08-04 07:48:28.545 [main] INFO  [] [] o.s.b.a.e.web.EndpointLinksResolver - Exposing 1 endpoint beneath base path '/actuator'
2025-08-04 07:48:28.547 [main] INFO  [] [] o.s.t.w.s.TestDispatcherServlet - Completed initialization in 4 ms
2025-08-04 07:48:28.566 [main] INFO  [] [] c.j.p.i.c.PedidoControllerHttpStatusTest - Started PedidoControllerHttpStatusTest in 0.274 seconds (process running for 5.43)
2025-08-04 07:48:28.571 [main] DEBUG [] [] org.hibernate.SQL - select c1_0.id,c1_0.nombre from cliente c1_0
2025-08-04 07:48:28.572 [main] DEBUG [] [] org.hibernate.SQL - select z1_0.id,z1_0.soporte_refrigeracion from zona z1_0
2025-08-04 07:48:28.573 [main] DEBUG [] [] org.hibernate.SQL - delete from cliente where id=?
2025-08-04 07:48:28.574 [main] DEBUG [] [] org.hibernate.SQL - delete from cliente where id=?
2025-08-04 07:48:28.574 [main] DEBUG [] [] org.hibernate.SQL - delete from zona where id=?
2025-08-04 07:48:28.575 [main] DEBUG [] [] org.hibernate.SQL - delete from zona where id=?
2025-08-04 07:48:28.575 [main] DEBUG [] [] org.hibernate.SQL - select z1_0.id,z1_0.soporte_refrigeracion from zona z1_0 where z1_0.id=?
2025-08-04 07:48:28.577 [main] INFO  [] [HTTP_REQUEST] c.j.p.i.controller.PedidoController - [INICIO_CARGA_CSV] POST /pedidos/cargar - Request ID: 35ce947c - Archivo: pedidos.txt - Tamaño: 9 bytes
2025-08-04 07:48:28.577 [main] WARN  [] [HTTP_REQUEST] c.j.p.i.controller.PedidoController - [ERROR_LECTURA_CSV] Request ID: 35ce947c - Formato de archivo inválido: pedidos.txt
2025-08-04 07:48:28.578 [main] WARN  [] [] c.j.p.i.c.GlobalExceptionHandler - [ERROR_LECTURA_CSV] Error de validación CSV: Solo se permiten archivos CSV
2025-08-04 07:48:28.585 [main] INFO  [] [] o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-08-04 07:48:28.585 [main] DEBUG [] [] org.hibernate.SQL - drop table if exists cliente cascade 
2025-08-04 07:48:28.585 [main] DEBUG [] [] org.hibernate.SQL - drop table if exists pedido cascade 
2025-08-04 07:48:28.586 [main] DEBUG [] [] org.hibernate.SQL - drop table if exists zona cascade 
2025-08-04 07:48:28.586 [main] INFO  [] [] com.zaxxer.hikari.HikariDataSource - HikariPool-6 - Shutdown initiated...
2025-08-04 07:48:28.601 [main] INFO  [] [] com.zaxxer.hikari.HikariDataSource - HikariPool-6 - Shutdown completed.
2025-08-04 07:48:28.602 [main] INFO  [] [] o.s.b.d.r.RestartApplicationListener - Restart disabled due to context in which it is running
2025-08-04 07:48:28.613 [main] INFO  [] [] c.j.p.i.c.PedidoControllerHttpStatusTest - Starting PedidoControllerHttpStatusTest using Java 17.0.15 with PID 97381 (started by josuepatricio in /Users/josuepatricio/Downloads/pedidos-ms)
2025-08-04 07:48:28.613 [main] DEBUG [] [] c.j.p.i.c.PedidoControllerHttpStatusTest - Running with Spring Boot v3.5.4, Spring v6.2.9
2025-08-04 07:48:28.613 [main] INFO  [] [] c.j.p.i.c.PedidoControllerHttpStatusTest - The following 1 profile is active: "test"
2025-08-04 07:48:28.700 [main] INFO  [] [] o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-08-04 07:48:28.704 [main] INFO  [] [] o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 3 ms. Found 3 JPA repository interfaces.
2025-08-04 07:48:28.735 [main] INFO  [] [] o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-08-04 07:48:28.735 [main] INFO  [] [] com.zaxxer.hikari.HikariDataSource - HikariPool-7 - Starting...
2025-08-04 07:48:28.736 [main] INFO  [] [] com.zaxxer.hikari.pool.HikariPool - HikariPool-7 - Added connection conn34: url=jdbc:h2:mem:testdb user=SA
2025-08-04 07:48:28.736 [main] INFO  [] [] com.zaxxer.hikari.HikariDataSource - HikariPool-7 - Start completed.
2025-08-04 07:48:28.736 [main] WARN  [] [] org.hibernate.orm.deprecation - HHH90000025: H2Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-08-04 07:48:28.748 [main] DEBUG [] [] org.hibernate.SQL - drop table if exists cliente cascade 
2025-08-04 07:48:28.749 [main] DEBUG [] [] org.hibernate.SQL - drop table if exists pedido cascade 
2025-08-04 07:48:28.749 [main] DEBUG [] [] org.hibernate.SQL - drop table if exists zona cascade 
2025-08-04 07:48:28.749 [main] DEBUG [] [] org.hibernate.SQL - create table cliente (id varchar(255) not null, nombre varchar(255), primary key (id))
2025-08-04 07:48:28.750 [main] DEBUG [] [] org.hibernate.SQL - create table pedido (fecha_entrega date, requiere_refrigeracion boolean not null, cliente_id varchar(255) not null, numero_pedido varchar(255) not null, zona_entrega varchar(255) not null, estado enum ('CONFIRMADO','ENTREGADO','PENDIENTE'), primary key (numero_pedido))
2025-08-04 07:48:28.750 [main] DEBUG [] [] org.hibernate.SQL - create table zona (soporte_refrigeracion boolean not null, id varchar(255) not null, primary key (id))
2025-08-04 07:48:28.751 [main] DEBUG [] [] org.hibernate.SQL - alter table if exists pedido add constraint FK30s8j2ktpay6of18lbyqn3632 foreign key (cliente_id) references cliente
2025-08-04 07:48:28.752 [main] DEBUG [] [] org.hibernate.SQL - alter table if exists pedido add constraint FK1aokin5yjk78h5cax5jju4fs9 foreign key (zona_entrega) references zona
2025-08-04 07:48:28.752 [main] INFO  [] [] o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-08-04 07:48:28.771 [main] DEBUG [] [] org.hibernate.SQL - select count(*) from cliente c1_0
2025-08-04 07:48:28.775 [main] DEBUG [] [] org.hibernate.SQL - select c1_0.id,c1_0.nombre from cliente c1_0 where c1_0.id=?
2025-08-04 07:48:28.776 [main] DEBUG [] [] org.hibernate.SQL - insert into cliente (nombre,id) values (?,?)
2025-08-04 07:48:28.777 [main] DEBUG [] [] org.hibernate.SQL - select c1_0.id,c1_0.nombre from cliente c1_0 where c1_0.id=?
2025-08-04 07:48:28.778 [main] DEBUG [] [] org.hibernate.SQL - insert into cliente (nombre,id) values (?,?)
2025-08-04 07:48:28.779 [main] DEBUG [] [] org.hibernate.SQL - select count(*) from zona z1_0
2025-08-04 07:48:28.780 [main] DEBUG [] [] org.hibernate.SQL - select z1_0.id,z1_0.soporte_refrigeracion from zona z1_0 where z1_0.id=?
2025-08-04 07:48:28.781 [main] DEBUG [] [] org.hibernate.SQL - insert into zona (soporte_refrigeracion,id) values (?,?)
2025-08-04 07:48:28.782 [main] DEBUG [] [] org.hibernate.SQL - select z1_0.id,z1_0.soporte_refrigeracion from zona z1_0 where z1_0.id=?
2025-08-04 07:48:28.782 [main] DEBUG [] [] org.hibernate.SQL - insert into zona (soporte_refrigeracion,id) values (?,?)
2025-08-04 07:48:28.792 [main] WARN  [] [] o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-08-04 07:48:28.843 [main] INFO  [] [] o.s.b.a.h.H2ConsoleAutoConfiguration - H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:testdb'
2025-08-04 07:48:28.846 [main] INFO  [] [] o.s.b.t.m.w.SpringBootMockServletContext - Initializing Spring TestDispatcherServlet ''
2025-08-04 07:48:28.846 [main] INFO  [] [] o.s.t.w.s.TestDispatcherServlet - Initializing Servlet ''
2025-08-04 07:48:28.847 [main] INFO  [] [] o.s.b.a.e.web.EndpointLinksResolver - Exposing 1 endpoint beneath base path '/actuator'
2025-08-04 07:48:28.850 [main] INFO  [] [] o.s.t.w.s.TestDispatcherServlet - Completed initialization in 4 ms
2025-08-04 07:48:28.872 [main] INFO  [] [] c.j.p.i.c.PedidoControllerHttpStatusTest - Started PedidoControllerHttpStatusTest in 0.27 seconds (process running for 5.736)
2025-08-04 07:48:28.876 [main] DEBUG [] [] org.hibernate.SQL - select c1_0.id,c1_0.nombre from cliente c1_0
2025-08-04 07:48:28.877 [main] DEBUG [] [] org.hibernate.SQL - select z1_0.id,z1_0.soporte_refrigeracion from zona z1_0
2025-08-04 07:48:28.878 [main] DEBUG [] [] org.hibernate.SQL - delete from cliente where id=?
2025-08-04 07:48:28.878 [main] DEBUG [] [] org.hibernate.SQL - delete from cliente where id=?
2025-08-04 07:48:28.878 [main] DEBUG [] [] org.hibernate.SQL - delete from zona where id=?
2025-08-04 07:48:28.879 [main] DEBUG [] [] org.hibernate.SQL - delete from zona where id=?
2025-08-04 07:48:28.879 [main] DEBUG [] [] org.hibernate.SQL - select z1_0.id,z1_0.soporte_refrigeracion from zona z1_0 where z1_0.id=?
2025-08-04 07:48:28.881 [main] INFO  [] [HTTP_REQUEST] c.j.p.i.controller.PedidoController - [INICIO_CARGA_CSV] POST /pedidos/cargar - Request ID: 44b98837 - Archivo: pedidos.csv - Tamaño: 186 bytes
2025-08-04 07:48:28.881 [main] INFO  [] [CARGA_CSV] c.j.p.a.usecase.CargarPedidosUseCase - [INICIO_CARGA_CSV] Iniciando procesamiento de archivo: pedidos.csv (tamaño: 186 bytes)
2025-08-04 07:48:28.881 [main] INFO  [] [CARGA_CSV] c.j.p.a.usecase.CargarPedidosUseCase - [INICIO_CARGA_CSV] Procesando 2 filas de datos (excluyendo cabecera)
2025-08-04 07:48:28.881 [main] DEBUG [P001] [CARGA_CSV] c.j.p.a.usecase.CargarPedidosUseCase - [INICIO_VALIDACION] Iniciando validación completa de pedido: P001
2025-08-04 07:48:28.881 [main] INFO  [P001] [CARGA_CSV] c.j.p.domain.service.PedidoValidator - [INICIO_VALIDACION] Validando número de pedido: P001
2025-08-04 07:48:28.883 [main] DEBUG [P001] [CARGA_CSV] org.hibernate.SQL - select count(*) from pedido p1_0 where p1_0.numero_pedido=?
2025-08-04 07:48:28.883 [main] DEBUG [P001] [CARGA_CSV] c.j.p.domain.service.PedidoValidator - [PEDIDO_VALIDO] Número de pedido único y válido: P001
2025-08-04 07:48:28.883 [main] DEBUG [P001] [CARGA_CSV] c.j.p.d.service.ClienteValidator - [INICIO_VALIDACION] Validando cliente: CLI-123
2025-08-04 07:48:28.884 [main] DEBUG [P001] [CARGA_CSV] c.j.p.d.service.ClienteValidator - [PEDIDO_VALIDO] Cliente válido encontrado: CLI-123 - Test Cliente
2025-08-04 07:48:28.884 [main] DEBUG [P001] [CARGA_CSV] c.j.p.domain.service.FechaValidator - [INICIO_VALIDACION] Validando fecha de entrega: 2099-08-10
2025-08-04 07:48:28.884 [main] DEBUG [P001] [CARGA_CSV] c.j.p.domain.service.FechaValidator - [PEDIDO_VALIDO] Fecha de entrega válida: 2099-08-10 (días desde hoy: 27034)
2025-08-04 07:48:28.884 [main] DEBUG [P001] [CARGA_CSV] c.j.p.domain.service.EstadoValidator - [INICIO_VALIDACION] Validando estado: PENDIENTE
2025-08-04 07:48:28.884 [main] DEBUG [P001] [CARGA_CSV] c.j.p.domain.service.EstadoValidator - [PEDIDO_VALIDO] Estado válido: PENDIENTE
2025-08-04 07:48:28.884 [main] DEBUG [P001] [CARGA_CSV] c.j.p.domain.service.ZonaValidator - [INICIO_VALIDACION] Validando zona: ZONA1 con refrigeración: true
2025-08-04 07:48:28.884 [main] DEBUG [P001] [CARGA_CSV] c.j.p.domain.service.ZonaValidator - [PEDIDO_VALIDO] Zona válida: ZONA1 - Soporte refrigeración: true - Requerido: true
2025-08-04 07:48:28.885 [main] DEBUG [P001] [CARGA_CSV] c.j.p.a.usecase.CargarPedidosUseCase - [PEDIDO_VALIDO] Todas las validaciones pasaron exitosamente
2025-08-04 07:48:28.885 [main] DEBUG [P001] [CONVERSION] c.j.p.a.usecase.CargarPedidosUseCase - [PEDIDO_PROCESADO] Convirtiendo DTO a entidad de dominio: P001
2025-08-04 07:48:28.885 [main] DEBUG [P001] [CONVERSION] c.j.p.a.usecase.CargarPedidosUseCase - [PEDIDO_PROCESADO] Conversión exitosa - Pedido: P001, Cliente: CLI-123, Fecha: 2099-08-10, Estado: PENDIENTE, Zona: ZONA1, Refrigeración: true
2025-08-04 07:48:28.885 [main] DEBUG [P001] [CONVERSION] c.j.p.a.usecase.CargarPedidosUseCase - [PEDIDO_PROCESADO] Pedido válido agregado para guardado: P001
2025-08-04 07:48:28.885 [main] DEBUG [P002] [CONVERSION] c.j.p.a.usecase.CargarPedidosUseCase - [INICIO_VALIDACION] Iniciando validación completa de pedido: P002
2025-08-04 07:48:28.885 [main] INFO  [P002] [CONVERSION] c.j.p.domain.service.PedidoValidator - [INICIO_VALIDACION] Validando número de pedido: P002
2025-08-04 07:48:28.886 [main] DEBUG [P002] [CONVERSION] org.hibernate.SQL - select count(*) from pedido p1_0 where p1_0.numero_pedido=?
2025-08-04 07:48:28.886 [main] DEBUG [P002] [CONVERSION] c.j.p.domain.service.PedidoValidator - [PEDIDO_VALIDO] Número de pedido único y válido: P002
2025-08-04 07:48:28.886 [main] DEBUG [P002] [CONVERSION] c.j.p.d.service.ClienteValidator - [INICIO_VALIDACION] Validando cliente: CLI-INEXISTENTE
2025-08-04 07:48:28.887 [main] DEBUG [P002] [CONVERSION] org.hibernate.SQL - select c1_0.id,c1_0.nombre from cliente c1_0 where c1_0.id=?
2025-08-04 07:48:28.887 [main] WARN  [P002] [CONVERSION] c.j.p.d.service.ClienteValidator - [PEDIDO_INVALIDO] Cliente no encontrado en base de datos: CLI-INEXISTENTE
2025-08-04 07:48:28.887 [main] DEBUG [P002] [CONVERSION] c.j.p.domain.service.FechaValidator - [INICIO_VALIDACION] Validando fecha de entrega: 2020-01-01
2025-08-04 07:48:28.887 [main] WARN  [P002] [CONVERSION] c.j.p.domain.service.FechaValidator - [PEDIDO_INVALIDO] Fecha de entrega en el pasado: 2020-01-01 (hoy: 2025-08-04)
2025-08-04 07:48:28.887 [main] DEBUG [P002] [CONVERSION] c.j.p.domain.service.EstadoValidator - [INICIO_VALIDACION] Validando estado: INVALIDO
2025-08-04 07:48:28.887 [main] WARN  [P002] [CONVERSION] c.j.p.domain.service.EstadoValidator - [PEDIDO_INVALIDO] Estado inválido: INVALIDO. Estados válidos: PENDIENTE, CONFIRMADO, ENTREGADO
2025-08-04 07:48:28.888 [main] DEBUG [P002] [CONVERSION] c.j.p.domain.service.ZonaValidator - [INICIO_VALIDACION] Validando zona: ZONA_INEXISTENTE con refrigeración: false
2025-08-04 07:48:28.888 [main] DEBUG [P002] [CONVERSION] org.hibernate.SQL - select z1_0.id,z1_0.soporte_refrigeracion from zona z1_0 where z1_0.id=?
2025-08-04 07:48:28.888 [main] WARN  [P002] [CONVERSION] c.j.p.domain.service.ZonaValidator - [PEDIDO_INVALIDO] Zona no encontrada en base de datos: ZONA_INEXISTENTE
2025-08-04 07:48:28.889 [main] INFO  [P002] [CONVERSION] c.j.p.a.usecase.CargarPedidosUseCase - [ESTADISTICAS_VALIDACION] Validación completada con 4 errores: [Clientes no encontrados, Fecha de entrega inválida, Estado inválido, Zonas inválidas]
2025-08-04 07:48:28.889 [main] WARN  [P002] [CONVERSION] c.j.p.a.usecase.CargarPedidosUseCase - [PEDIDO_INVALIDO] Pedido con 4 errores de validación
2025-08-04 07:48:28.889 [main] INFO  [P002] [PERSISTENCIA] c.j.p.a.usecase.CargarPedidosUseCase - [PEDIDO_GUARDADO] Guardando 1 pedidos válidos en base de datos
2025-08-04 07:48:28.890 [main] DEBUG [P002] [PERSISTENCIA] org.hibernate.SQL - select p1_0.numero_pedido,p1_0.cliente_id,c1_0.id,c1_0.nombre,p1_0.estado,p1_0.fecha_entrega,p1_0.requiere_refrigeracion,p1_0.zona_entrega,ze1_0.id,ze1_0.soporte_refrigeracion from pedido p1_0 join cliente c1_0 on c1_0.id=p1_0.cliente_id join zona ze1_0 on ze1_0.id=p1_0.zona_entrega where p1_0.numero_pedido=?
2025-08-04 07:48:28.891 [main] INFO  [P002] [PERSISTENCIA] c.j.p.a.usecase.CargarPedidosUseCase - [PEDIDO_GUARDADO] Guardados exitosamente 1 pedidos
2025-08-04 07:48:28.892 [main] INFO  [] [] c.j.p.a.usecase.CargarPedidosUseCase - [RESUMEN_PROCESAMIENTO] Procesamiento completado - Total: 2, Guardados: 1, Errores: 4
2025-08-04 07:48:28.892 [main] INFO  [] [] c.j.p.i.controller.PedidoController - [FIN_CARGA_CSV] Request ID: 44b98837 - Procesamiento completado en 11ms - Total: 2, Guardados: 1, Tipos de errores: 4
2025-08-04 07:48:28.892 [main] WARN  [] [] c.j.p.i.controller.PedidoController - [ESTADISTICAS_VALIDACION] Request ID: 44b98837 - Errores de validación encontrados: 4 errores totales
2025-08-04 07:48:28.903 [SpringApplicationShutdownHook] INFO  [] [] o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-08-04 07:48:28.903 [SpringApplicationShutdownHook] DEBUG [] [] org.hibernate.SQL - drop table if exists cliente cascade 
2025-08-04 07:48:28.904 [SpringApplicationShutdownHook] DEBUG [] [] org.hibernate.SQL - drop table if exists pedido cascade 
2025-08-04 07:48:28.904 [SpringApplicationShutdownHook] DEBUG [] [] org.hibernate.SQL - drop table if exists zona cascade 
2025-08-04 07:48:28.905 [SpringApplicationShutdownHook] INFO  [] [] com.zaxxer.hikari.HikariDataSource - HikariPool-7 - Shutdown initiated...
2025-08-04 07:48:28.912 [SpringApplicationShutdownHook] INFO  [] [] com.zaxxer.hikari.HikariDataSource - HikariPool-7 - Shutdown completed.
2025-08-04 07:48:39.916 [main] INFO  [] [] c.j.p.PedidosMsApplicationTests - Starting PedidosMsApplicationTests using Java 17.0.15 with PID 97497 (started by josuepatricio in /Users/josuepatricio/Downloads/pedidos-ms)
2025-08-04 07:48:39.917 [main] DEBUG [] [] c.j.p.PedidosMsApplicationTests - Running with Spring Boot v3.5.4, Spring v6.2.9
2025-08-04 07:48:39.918 [main] INFO  [] [] c.j.p.PedidosMsApplicationTests - The following 1 profile is active: "test"
2025-08-04 07:48:40.382 [main] INFO  [] [] o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-08-04 07:48:40.412 [main] INFO  [] [] o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 24 ms. Found 3 JPA repository interfaces.
2025-08-04 07:48:40.803 [main] INFO  [] [] o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-08-04 07:48:40.819 [main] INFO  [] [] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-08-04 07:48:40.923 [main] INFO  [] [] com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:testdb user=SA
2025-08-04 07:48:40.924 [main] INFO  [] [] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-08-04 07:48:40.938 [main] WARN  [] [] org.hibernate.orm.deprecation - HHH90000025: H2Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-08-04 07:48:41.360 [main] DEBUG [] [] org.hibernate.SQL - drop table if exists cliente cascade 
2025-08-04 07:48:41.362 [main] DEBUG [] [] org.hibernate.SQL - drop table if exists pedido cascade 
2025-08-04 07:48:41.362 [main] DEBUG [] [] org.hibernate.SQL - drop table if exists zona cascade 
2025-08-04 07:48:41.365 [main] DEBUG [] [] org.hibernate.SQL - create table cliente (id varchar(255) not null, nombre varchar(255), primary key (id))
2025-08-04 07:48:41.368 [main] DEBUG [] [] org.hibernate.SQL - create table pedido (fecha_entrega date, requiere_refrigeracion boolean not null, cliente_id varchar(255) not null, numero_pedido varchar(255) not null, zona_entrega varchar(255) not null, estado enum ('CONFIRMADO','ENTREGADO','PENDIENTE'), primary key (numero_pedido))
2025-08-04 07:48:41.369 [main] DEBUG [] [] org.hibernate.SQL - create table zona (soporte_refrigeracion boolean not null, id varchar(255) not null, primary key (id))
2025-08-04 07:48:41.369 [main] DEBUG [] [] org.hibernate.SQL - alter table if exists pedido add constraint FK30s8j2ktpay6of18lbyqn3632 foreign key (cliente_id) references cliente
2025-08-04 07:48:41.375 [main] DEBUG [] [] org.hibernate.SQL - alter table if exists pedido add constraint FK1aokin5yjk78h5cax5jju4fs9 foreign key (zona_entrega) references zona
2025-08-04 07:48:41.378 [main] INFO  [] [] o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-08-04 07:48:41.705 [main] DEBUG [] [] org.hibernate.SQL - select count(*) from cliente c1_0
2025-08-04 07:48:41.747 [main] DEBUG [] [] org.hibernate.SQL - select c1_0.id,c1_0.nombre from cliente c1_0 where c1_0.id=?
2025-08-04 07:48:41.764 [main] DEBUG [] [] org.hibernate.SQL - insert into cliente (nombre,id) values (?,?)
2025-08-04 07:48:41.767 [main] DEBUG [] [] org.hibernate.SQL - select c1_0.id,c1_0.nombre from cliente c1_0 where c1_0.id=?
2025-08-04 07:48:41.768 [main] DEBUG [] [] org.hibernate.SQL - insert into cliente (nombre,id) values (?,?)
2025-08-04 07:48:41.770 [main] DEBUG [] [] org.hibernate.SQL - select count(*) from zona z1_0
2025-08-04 07:48:41.771 [main] DEBUG [] [] org.hibernate.SQL - select z1_0.id,z1_0.soporte_refrigeracion from zona z1_0 where z1_0.id=?
2025-08-04 07:48:41.772 [main] DEBUG [] [] org.hibernate.SQL - insert into zona (soporte_refrigeracion,id) values (?,?)
2025-08-04 07:48:41.773 [main] DEBUG [] [] org.hibernate.SQL - select z1_0.id,z1_0.soporte_refrigeracion from zona z1_0 where z1_0.id=?
2025-08-04 07:48:41.774 [main] DEBUG [] [] org.hibernate.SQL - insert into zona (soporte_refrigeracion,id) values (?,?)
2025-08-04 07:48:41.832 [main] WARN  [] [] o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-08-04 07:48:42.079 [main] INFO  [] [] o.s.b.a.h.H2ConsoleAutoConfiguration - H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:testdb'
2025-08-04 07:48:42.090 [main] INFO  [] [] o.s.b.a.e.web.EndpointLinksResolver - Exposing 1 endpoint beneath base path '/actuator'
2025-08-04 07:48:42.129 [main] INFO  [] [] c.j.p.PedidosMsApplicationTests - Started PedidosMsApplicationTests in 2.428 seconds (process running for 2.994)
2025-08-04 07:48:42.422 [main] INFO  [] [] o.s.t.c.s.AnnotationConfigContextLoaderUtils - Could not detect default configuration classes for test class [com.josue.pedidos_ms.infrastructure.controller.PedidoControllerIntegrationTest]: PedidoControllerIntegrationTest does not declare any static, non-private, non-final, nested classes annotated with @Configuration.
2025-08-04 07:48:42.432 [main] INFO  [] [] o.s.b.t.c.SpringBootTestContextBootstrapper - Found @SpringBootConfiguration com.josue.pedidos_ms.PedidosMsApplication for test class com.josue.pedidos_ms.infrastructure.controller.PedidoControllerIntegrationTest
2025-08-04 07:48:42.434 [main] INFO  [] [] o.s.b.d.r.RestartApplicationListener - Restart disabled due to context in which it is running
2025-08-04 07:48:42.447 [main] INFO  [] [] c.j.p.i.c.PedidoControllerIntegrationTest - Starting PedidoControllerIntegrationTest using Java 17.0.15 with PID 97497 (started by josuepatricio in /Users/josuepatricio/Downloads/pedidos-ms)
2025-08-04 07:48:42.447 [main] DEBUG [] [] c.j.p.i.c.PedidoControllerIntegrationTest - Running with Spring Boot v3.5.4, Spring v6.2.9
2025-08-04 07:48:42.447 [main] INFO  [] [] c.j.p.i.c.PedidoControllerIntegrationTest - The following 1 profile is active: "test"
2025-08-04 07:48:42.562 [main] INFO  [] [] o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-08-04 07:48:42.567 [main] INFO  [] [] o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 4 ms. Found 3 JPA repository interfaces.
2025-08-04 07:48:42.616 [main] INFO  [] [] o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-08-04 07:48:42.617 [main] INFO  [] [] com.zaxxer.hikari.HikariDataSource - HikariPool-2 - Starting...
2025-08-04 07:48:42.625 [main] INFO  [] [] com.zaxxer.hikari.pool.HikariPool - HikariPool-2 - Added connection conn10: url=jdbc:h2:mem:testdb user=SA
2025-08-04 07:48:42.625 [main] INFO  [] [] com.zaxxer.hikari.HikariDataSource - HikariPool-2 - Start completed.
2025-08-04 07:48:42.626 [main] WARN  [] [] org.hibernate.orm.deprecation - HHH90000025: H2Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-08-04 07:48:42.641 [main] DEBUG [] [] org.hibernate.SQL - drop table if exists cliente cascade 
2025-08-04 07:48:42.642 [main] DEBUG [] [] org.hibernate.SQL - drop table if exists pedido cascade 
2025-08-04 07:48:42.643 [main] DEBUG [] [] org.hibernate.SQL - drop table if exists zona cascade 
2025-08-04 07:48:42.643 [main] DEBUG [] [] org.hibernate.SQL - create table cliente (id varchar(255) not null, nombre varchar(255), primary key (id))
2025-08-04 07:48:42.644 [main] DEBUG [] [] org.hibernate.SQL - create table pedido (fecha_entrega date, requiere_refrigeracion boolean not null, cliente_id varchar(255) not null, numero_pedido varchar(255) not null, zona_entrega varchar(255) not null, estado enum ('CONFIRMADO','ENTREGADO','PENDIENTE'), primary key (numero_pedido))
2025-08-04 07:48:42.645 [main] DEBUG [] [] org.hibernate.SQL - create table zona (soporte_refrigeracion boolean not null, id varchar(255) not null, primary key (id))
2025-08-04 07:48:42.645 [main] DEBUG [] [] org.hibernate.SQL - alter table if exists pedido add constraint FK30s8j2ktpay6of18lbyqn3632 foreign key (cliente_id) references cliente
2025-08-04 07:48:42.646 [main] DEBUG [] [] org.hibernate.SQL - alter table if exists pedido add constraint FK1aokin5yjk78h5cax5jju4fs9 foreign key (zona_entrega) references zona
2025-08-04 07:48:42.647 [main] INFO  [] [] o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-08-04 07:48:42.667 [main] DEBUG [] [] org.hibernate.SQL - select count(*) from cliente c1_0
2025-08-04 07:48:42.672 [main] DEBUG [] [] org.hibernate.SQL - select c1_0.id,c1_0.nombre from cliente c1_0 where c1_0.id=?
2025-08-04 07:48:42.673 [main] DEBUG [] [] org.hibernate.SQL - insert into cliente (nombre,id) values (?,?)
2025-08-04 07:48:42.674 [main] DEBUG [] [] org.hibernate.SQL - select c1_0.id,c1_0.nombre from cliente c1_0 where c1_0.id=?
2025-08-04 07:48:42.675 [main] DEBUG [] [] org.hibernate.SQL - insert into cliente (nombre,id) values (?,?)
2025-08-04 07:48:42.676 [main] DEBUG [] [] org.hibernate.SQL - select count(*) from zona z1_0
2025-08-04 07:48:42.678 [main] DEBUG [] [] org.hibernate.SQL - select z1_0.id,z1_0.soporte_refrigeracion from zona z1_0 where z1_0.id=?
2025-08-04 07:48:42.679 [main] DEBUG [] [] org.hibernate.SQL - insert into zona (soporte_refrigeracion,id) values (?,?)
2025-08-04 07:48:42.679 [main] DEBUG [] [] org.hibernate.SQL - select z1_0.id,z1_0.soporte_refrigeracion from zona z1_0 where z1_0.id=?
2025-08-04 07:48:42.680 [main] DEBUG [] [] org.hibernate.SQL - insert into zona (soporte_refrigeracion,id) values (?,?)
2025-08-04 07:48:42.695 [main] WARN  [] [] o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-08-04 07:48:42.764 [main] INFO  [] [] o.s.b.a.h.H2ConsoleAutoConfiguration - H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:testdb'
2025-08-04 07:48:42.780 [main] INFO  [] [] o.s.b.t.m.w.SpringBootMockServletContext - Initializing Spring TestDispatcherServlet ''
2025-08-04 07:48:42.780 [main] INFO  [] [] o.s.t.w.s.TestDispatcherServlet - Initializing Servlet ''
2025-08-04 07:48:42.782 [main] INFO  [] [] o.s.b.a.e.web.EndpointLinksResolver - Exposing 1 endpoint beneath base path '/actuator'
2025-08-04 07:48:42.786 [main] INFO  [] [] o.s.t.w.s.TestDispatcherServlet - Completed initialization in 6 ms
2025-08-04 07:48:42.808 [main] INFO  [] [] c.j.p.i.c.PedidoControllerIntegrationTest - Started PedidoControllerIntegrationTest in 0.374 seconds (process running for 3.674)
2025-08-04 07:48:42.813 [main] DEBUG [] [] org.hibernate.SQL - select c1_0.id,c1_0.nombre from cliente c1_0 where c1_0.id=?
2025-08-04 07:48:42.818 [main] DEBUG [] [] org.hibernate.SQL - update cliente set nombre=? where id=?
2025-08-04 07:48:42.821 [main] DEBUG [] [] org.hibernate.SQL - select z1_0.id,z1_0.soporte_refrigeracion from zona z1_0 where z1_0.id=?
2025-08-04 07:48:42.853 [main] INFO  [] [HTTP_REQUEST] c.j.p.i.controller.PedidoController - [INICIO_CARGA_CSV] POST /pedidos/cargar - Request ID: 6736ebb1 - Archivo: pedidos.csv - Tamaño: 122 bytes
2025-08-04 07:48:42.853 [main] INFO  [] [CARGA_CSV] c.j.p.a.usecase.CargarPedidosUseCase - [INICIO_CARGA_CSV] Iniciando procesamiento de archivo: pedidos.csv (tamaño: 122 bytes)
2025-08-04 07:48:42.860 [main] INFO  [] [CARGA_CSV] c.j.p.a.usecase.CargarPedidosUseCase - [INICIO_CARGA_CSV] Procesando 1 filas de datos (excluyendo cabecera)
2025-08-04 07:48:42.860 [main] DEBUG [P001] [CARGA_CSV] c.j.p.a.usecase.CargarPedidosUseCase - [INICIO_VALIDACION] Iniciando validación completa de pedido: P001
2025-08-04 07:48:42.860 [main] INFO  [P001] [CARGA_CSV] c.j.p.domain.service.PedidoValidator - [INICIO_VALIDACION] Validando número de pedido: P001
2025-08-04 07:48:42.887 [main] DEBUG [P001] [CARGA_CSV] org.hibernate.SQL - select count(*) from pedido p1_0 where p1_0.numero_pedido=?
2025-08-04 07:48:42.889 [main] DEBUG [P001] [CARGA_CSV] c.j.p.domain.service.PedidoValidator - [PEDIDO_VALIDO] Número de pedido único y válido: P001
2025-08-04 07:48:42.889 [main] DEBUG [P001] [CARGA_CSV] c.j.p.d.service.ClienteValidator - [INICIO_VALIDACION] Validando cliente: CLI-123
2025-08-04 07:48:42.890 [main] DEBUG [P001] [CARGA_CSV] org.hibernate.SQL - select c1_0.id,c1_0.nombre from cliente c1_0 where c1_0.id=?
2025-08-04 07:48:42.892 [main] DEBUG [P001] [CARGA_CSV] c.j.p.d.service.ClienteValidator - [PEDIDO_VALIDO] Cliente válido encontrado: CLI-123 - Test Cliente
2025-08-04 07:48:42.892 [main] DEBUG [P001] [CARGA_CSV] c.j.p.domain.service.FechaValidator - [INICIO_VALIDACION] Validando fecha de entrega: 2099-08-10
2025-08-04 07:48:42.893 [main] DEBUG [P001] [CARGA_CSV] c.j.p.domain.service.FechaValidator - [PEDIDO_VALIDO] Fecha de entrega válida: 2099-08-10 (días desde hoy: 27034)
2025-08-04 07:48:42.893 [main] DEBUG [P001] [CARGA_CSV] c.j.p.domain.service.EstadoValidator - [INICIO_VALIDACION] Validando estado: PENDIENTE
2025-08-04 07:48:42.893 [main] DEBUG [P001] [CARGA_CSV] c.j.p.domain.service.EstadoValidator - [PEDIDO_VALIDO] Estado válido: PENDIENTE
2025-08-04 07:48:42.893 [main] DEBUG [P001] [CARGA_CSV] c.j.p.domain.service.ZonaValidator - [INICIO_VALIDACION] Validando zona: ZONA1 con refrigeración: true
2025-08-04 07:48:42.893 [main] DEBUG [P001] [CARGA_CSV] org.hibernate.SQL - select z1_0.id,z1_0.soporte_refrigeracion from zona z1_0 where z1_0.id=?
2025-08-04 07:48:42.894 [main] DEBUG [P001] [CARGA_CSV] c.j.p.domain.service.ZonaValidator - [PEDIDO_VALIDO] Zona válida: ZONA1 - Soporte refrigeración: true - Requerido: true
2025-08-04 07:48:42.894 [main] DEBUG [P001] [CARGA_CSV] c.j.p.a.usecase.CargarPedidosUseCase - [PEDIDO_VALIDO] Todas las validaciones pasaron exitosamente
2025-08-04 07:48:42.894 [main] DEBUG [P001] [CONVERSION] c.j.p.a.usecase.CargarPedidosUseCase - [PEDIDO_PROCESADO] Convirtiendo DTO a entidad de dominio: P001
2025-08-04 07:48:42.896 [main] DEBUG [P001] [CONVERSION] c.j.p.a.usecase.CargarPedidosUseCase - [PEDIDO_PROCESADO] Conversión exitosa - Pedido: P001, Cliente: CLI-123, Fecha: 2099-08-10, Estado: PENDIENTE, Zona: ZONA1, Refrigeración: true
2025-08-04 07:48:42.896 [main] DEBUG [P001] [CONVERSION] c.j.p.a.usecase.CargarPedidosUseCase - [PEDIDO_PROCESADO] Pedido válido agregado para guardado: P001
2025-08-04 07:48:42.896 [main] INFO  [P001] [PERSISTENCIA] c.j.p.a.usecase.CargarPedidosUseCase - [PEDIDO_GUARDADO] Guardando 1 pedidos válidos en base de datos
2025-08-04 07:48:42.897 [main] DEBUG [P001] [PERSISTENCIA] org.hibernate.SQL - select p1_0.numero_pedido,p1_0.cliente_id,c1_0.id,c1_0.nombre,p1_0.estado,p1_0.fecha_entrega,p1_0.requiere_refrigeracion,p1_0.zona_entrega,ze1_0.id,ze1_0.soporte_refrigeracion from pedido p1_0 join cliente c1_0 on c1_0.id=p1_0.cliente_id join zona ze1_0 on ze1_0.id=p1_0.zona_entrega where p1_0.numero_pedido=?
2025-08-04 07:48:42.899 [main] DEBUG [P001] [PERSISTENCIA] org.hibernate.SQL - insert into pedido (cliente_id,estado,fecha_entrega,requiere_refrigeracion,zona_entrega,numero_pedido) values (?,?,?,?,?,?)
2025-08-04 07:48:42.901 [main] INFO  [P001] [PERSISTENCIA] c.j.p.a.usecase.CargarPedidosUseCase - [PEDIDO_GUARDADO] Guardados exitosamente 1 pedidos
2025-08-04 07:48:42.901 [main] INFO  [] [] c.j.p.a.usecase.CargarPedidosUseCase - [RESUMEN_PROCESAMIENTO] Procesamiento completado - Total: 1, Guardados: 1, Errores: 0
2025-08-04 07:48:42.901 [main] INFO  [] [] c.j.p.i.controller.PedidoController - [FIN_CARGA_CSV] Request ID: 6736ebb1 - Procesamiento completado en 48ms - Total: 1, Guardados: 1, Tipos de errores: 0
2025-08-04 07:48:42.954 [main] INFO  [] [] o.s.t.c.s.AnnotationConfigContextLoaderUtils - Could not detect default configuration classes for test class [com.josue.pedidos_ms.infrastructure.controller.PedidoControllerHttpStatusTest]: PedidoControllerHttpStatusTest does not declare any static, non-private, non-final, nested classes annotated with @Configuration.
2025-08-04 07:48:42.957 [main] INFO  [] [] o.s.b.t.c.SpringBootTestContextBootstrapper - Found @SpringBootConfiguration com.josue.pedidos_ms.PedidosMsApplication for test class com.josue.pedidos_ms.infrastructure.controller.PedidoControllerHttpStatusTest
2025-08-04 07:48:42.962 [main] INFO  [] [] o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-08-04 07:48:42.963 [main] DEBUG [] [] org.hibernate.SQL - drop table if exists cliente cascade 
2025-08-04 07:48:42.963 [main] DEBUG [] [] org.hibernate.SQL - drop table if exists pedido cascade 
2025-08-04 07:48:42.963 [main] DEBUG [] [] org.hibernate.SQL - drop table if exists zona cascade 
2025-08-04 07:48:42.965 [main] INFO  [] [] com.zaxxer.hikari.HikariDataSource - HikariPool-2 - Shutdown initiated...
2025-08-04 07:48:42.974 [main] INFO  [] [] com.zaxxer.hikari.HikariDataSource - HikariPool-2 - Shutdown completed.
2025-08-04 07:48:42.976 [main] INFO  [] [] o.s.b.d.r.RestartApplicationListener - Restart disabled due to context in which it is running
2025-08-04 07:48:42.990 [main] INFO  [] [] c.j.p.i.c.PedidoControllerHttpStatusTest - Starting PedidoControllerHttpStatusTest using Java 17.0.15 with PID 97497 (started by josuepatricio in /Users/josuepatricio/Downloads/pedidos-ms)
2025-08-04 07:48:42.990 [main] DEBUG [] [] c.j.p.i.c.PedidoControllerHttpStatusTest - Running with Spring Boot v3.5.4, Spring v6.2.9
2025-08-04 07:48:42.991 [main] INFO  [] [] c.j.p.i.c.PedidoControllerHttpStatusTest - The following 1 profile is active: "test"
2025-08-04 07:48:43.100 [main] INFO  [] [] o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-08-04 07:48:43.104 [main] INFO  [] [] o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 3 ms. Found 3 JPA repository interfaces.
2025-08-04 07:48:43.140 [main] INFO  [] [] o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-08-04 07:48:43.141 [main] INFO  [] [] com.zaxxer.hikari.HikariDataSource - HikariPool-3 - Starting...
2025-08-04 07:48:43.141 [main] INFO  [] [] com.zaxxer.hikari.pool.HikariPool - HikariPool-3 - Added connection conn18: url=jdbc:h2:mem:testdb user=SA
2025-08-04 07:48:43.141 [main] INFO  [] [] com.zaxxer.hikari.HikariDataSource - HikariPool-3 - Start completed.
2025-08-04 07:48:43.142 [main] WARN  [] [] org.hibernate.orm.deprecation - HHH90000025: H2Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-08-04 07:48:43.155 [main] DEBUG [] [] org.hibernate.SQL - drop table if exists cliente cascade 
2025-08-04 07:48:43.155 [main] DEBUG [] [] org.hibernate.SQL - drop table if exists pedido cascade 
2025-08-04 07:48:43.155 [main] DEBUG [] [] org.hibernate.SQL - drop table if exists zona cascade 
2025-08-04 07:48:43.155 [main] DEBUG [] [] org.hibernate.SQL - create table cliente (id varchar(255) not null, nombre varchar(255), primary key (id))
2025-08-04 07:48:43.156 [main] DEBUG [] [] org.hibernate.SQL - create table pedido (fecha_entrega date, requiere_refrigeracion boolean not null, cliente_id varchar(255) not null, numero_pedido varchar(255) not null, zona_entrega varchar(255) not null, estado enum ('CONFIRMADO','ENTREGADO','PENDIENTE'), primary key (numero_pedido))
2025-08-04 07:48:43.157 [main] DEBUG [] [] org.hibernate.SQL - create table zona (soporte_refrigeracion boolean not null, id varchar(255) not null, primary key (id))
2025-08-04 07:48:43.158 [main] DEBUG [] [] org.hibernate.SQL - alter table if exists pedido add constraint FK30s8j2ktpay6of18lbyqn3632 foreign key (cliente_id) references cliente
2025-08-04 07:48:43.159 [main] DEBUG [] [] org.hibernate.SQL - alter table if exists pedido add constraint FK1aokin5yjk78h5cax5jju4fs9 foreign key (zona_entrega) references zona
2025-08-04 07:48:43.160 [main] INFO  [] [] o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-08-04 07:48:43.179 [main] DEBUG [] [] org.hibernate.SQL - select count(*) from cliente c1_0
2025-08-04 07:48:43.188 [main] DEBUG [] [] org.hibernate.SQL - select c1_0.id,c1_0.nombre from cliente c1_0 where c1_0.id=?
2025-08-04 07:48:43.191 [main] DEBUG [] [] org.hibernate.SQL - insert into cliente (nombre,id) values (?,?)
2025-08-04 07:48:43.192 [main] DEBUG [] [] org.hibernate.SQL - select c1_0.id,c1_0.nombre from cliente c1_0 where c1_0.id=?
2025-08-04 07:48:43.196 [main] DEBUG [] [] org.hibernate.SQL - insert into cliente (nombre,id) values (?,?)
2025-08-04 07:48:43.198 [main] DEBUG [] [] org.hibernate.SQL - select count(*) from zona z1_0
2025-08-04 07:48:43.199 [main] DEBUG [] [] org.hibernate.SQL - select z1_0.id,z1_0.soporte_refrigeracion from zona z1_0 where z1_0.id=?
2025-08-04 07:48:43.200 [main] DEBUG [] [] org.hibernate.SQL - insert into zona (soporte_refrigeracion,id) values (?,?)
2025-08-04 07:48:43.201 [main] DEBUG [] [] org.hibernate.SQL - select z1_0.id,z1_0.soporte_refrigeracion from zona z1_0 where z1_0.id=?
2025-08-04 07:48:43.201 [main] DEBUG [] [] org.hibernate.SQL - insert into zona (soporte_refrigeracion,id) values (?,?)
2025-08-04 07:48:43.213 [main] WARN  [] [] o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-08-04 07:48:43.273 [main] INFO  [] [] o.s.b.a.h.H2ConsoleAutoConfiguration - H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:testdb'
2025-08-04 07:48:43.277 [main] INFO  [] [] o.s.b.t.m.w.SpringBootMockServletContext - Initializing Spring TestDispatcherServlet ''
2025-08-04 07:48:43.277 [main] INFO  [] [] o.s.t.w.s.TestDispatcherServlet - Initializing Servlet ''
2025-08-04 07:48:43.278 [main] INFO  [] [] o.s.b.a.e.web.EndpointLinksResolver - Exposing 1 endpoint beneath base path '/actuator'
2025-08-04 07:48:43.281 [main] INFO  [] [] o.s.t.w.s.TestDispatcherServlet - Completed initialization in 4 ms
2025-08-04 07:48:43.298 [main] INFO  [] [] c.j.p.i.c.PedidoControllerHttpStatusTest - Started PedidoControllerHttpStatusTest in 0.322 seconds (process running for 4.163)
2025-08-04 07:48:43.309 [main] DEBUG [] [] org.hibernate.SQL - select c1_0.id,c1_0.nombre from cliente c1_0
2025-08-04 07:48:43.312 [main] DEBUG [] [] org.hibernate.SQL - select z1_0.id,z1_0.soporte_refrigeracion from zona z1_0
2025-08-04 07:48:43.314 [main] DEBUG [] [] org.hibernate.SQL - delete from cliente where id=?
2025-08-04 07:48:43.315 [main] DEBUG [] [] org.hibernate.SQL - delete from cliente where id=?
2025-08-04 07:48:43.315 [main] DEBUG [] [] org.hibernate.SQL - delete from zona where id=?
2025-08-04 07:48:43.316 [main] DEBUG [] [] org.hibernate.SQL - delete from zona where id=?
2025-08-04 07:48:43.317 [main] DEBUG [] [] org.hibernate.SQL - select z1_0.id,z1_0.soporte_refrigeracion from zona z1_0 where z1_0.id=?
2025-08-04 07:48:43.319 [main] INFO  [] [HTTP_REQUEST] c.j.p.i.controller.PedidoController - [INICIO_CARGA_CSV] POST /pedidos/cargar - Request ID: 808422f4 - Archivo: pedidos.csv - Tamaño: 122 bytes
2025-08-04 07:48:43.319 [main] INFO  [] [CARGA_CSV] c.j.p.a.usecase.CargarPedidosUseCase - [INICIO_CARGA_CSV] Iniciando procesamiento de archivo: pedidos.csv (tamaño: 122 bytes)
2025-08-04 07:48:43.319 [main] INFO  [] [CARGA_CSV] c.j.p.a.usecase.CargarPedidosUseCase - [INICIO_CARGA_CSV] Procesando 1 filas de datos (excluyendo cabecera)
2025-08-04 07:48:43.319 [main] DEBUG [P001] [CARGA_CSV] c.j.p.a.usecase.CargarPedidosUseCase - [INICIO_VALIDACION] Iniciando validación completa de pedido: P001
2025-08-04 07:48:43.319 [main] INFO  [P001] [CARGA_CSV] c.j.p.domain.service.PedidoValidator - [INICIO_VALIDACION] Validando número de pedido: P001
2025-08-04 07:48:43.321 [main] DEBUG [P001] [CARGA_CSV] org.hibernate.SQL - select count(*) from pedido p1_0 where p1_0.numero_pedido=?
2025-08-04 07:48:43.321 [main] DEBUG [P001] [CARGA_CSV] c.j.p.domain.service.PedidoValidator - [PEDIDO_VALIDO] Número de pedido único y válido: P001
2025-08-04 07:48:43.321 [main] DEBUG [P001] [CARGA_CSV] c.j.p.d.service.ClienteValidator - [INICIO_VALIDACION] Validando cliente: CLI-123
2025-08-04 07:48:43.322 [main] DEBUG [P001] [CARGA_CSV] c.j.p.d.service.ClienteValidator - [PEDIDO_VALIDO] Cliente válido encontrado: CLI-123 - Test Cliente
2025-08-04 07:48:43.322 [main] DEBUG [P001] [CARGA_CSV] c.j.p.domain.service.FechaValidator - [INICIO_VALIDACION] Validando fecha de entrega: 2099-08-10
2025-08-04 07:48:43.322 [main] DEBUG [P001] [CARGA_CSV] c.j.p.domain.service.FechaValidator - [PEDIDO_VALIDO] Fecha de entrega válida: 2099-08-10 (días desde hoy: 27034)
2025-08-04 07:48:43.322 [main] DEBUG [P001] [CARGA_CSV] c.j.p.domain.service.EstadoValidator - [INICIO_VALIDACION] Validando estado: PENDIENTE
2025-08-04 07:48:43.322 [main] DEBUG [P001] [CARGA_CSV] c.j.p.domain.service.EstadoValidator - [PEDIDO_VALIDO] Estado válido: PENDIENTE
2025-08-04 07:48:43.322 [main] DEBUG [P001] [CARGA_CSV] c.j.p.domain.service.ZonaValidator - [INICIO_VALIDACION] Validando zona: ZONA1 con refrigeración: true
2025-08-04 07:48:43.323 [main] DEBUG [P001] [CARGA_CSV] c.j.p.domain.service.ZonaValidator - [PEDIDO_VALIDO] Zona válida: ZONA1 - Soporte refrigeración: true - Requerido: true
2025-08-04 07:48:43.323 [main] DEBUG [P001] [CARGA_CSV] c.j.p.a.usecase.CargarPedidosUseCase - [PEDIDO_VALIDO] Todas las validaciones pasaron exitosamente
2025-08-04 07:48:43.323 [main] DEBUG [P001] [CONVERSION] c.j.p.a.usecase.CargarPedidosUseCase - [PEDIDO_PROCESADO] Convirtiendo DTO a entidad de dominio: P001
2025-08-04 07:48:43.323 [main] DEBUG [P001] [CONVERSION] c.j.p.a.usecase.CargarPedidosUseCase - [PEDIDO_PROCESADO] Conversión exitosa - Pedido: P001, Cliente: CLI-123, Fecha: 2099-08-10, Estado: PENDIENTE, Zona: ZONA1, Refrigeración: true
2025-08-04 07:48:43.324 [main] DEBUG [P001] [CONVERSION] c.j.p.a.usecase.CargarPedidosUseCase - [PEDIDO_PROCESADO] Pedido válido agregado para guardado: P001
2025-08-04 07:48:43.324 [main] INFO  [P001] [PERSISTENCIA] c.j.p.a.usecase.CargarPedidosUseCase - [PEDIDO_GUARDADO] Guardando 1 pedidos válidos en base de datos
2025-08-04 07:48:43.325 [main] DEBUG [P001] [PERSISTENCIA] org.hibernate.SQL - select p1_0.numero_pedido,p1_0.cliente_id,c1_0.id,c1_0.nombre,p1_0.estado,p1_0.fecha_entrega,p1_0.requiere_refrigeracion,p1_0.zona_entrega,ze1_0.id,ze1_0.soporte_refrigeracion from pedido p1_0 join cliente c1_0 on c1_0.id=p1_0.cliente_id join zona ze1_0 on ze1_0.id=p1_0.zona_entrega where p1_0.numero_pedido=?
2025-08-04 07:48:43.326 [main] INFO  [P001] [PERSISTENCIA] c.j.p.a.usecase.CargarPedidosUseCase - [PEDIDO_GUARDADO] Guardados exitosamente 1 pedidos
2025-08-04 07:48:43.326 [main] INFO  [] [] c.j.p.a.usecase.CargarPedidosUseCase - [RESUMEN_PROCESAMIENTO] Procesamiento completado - Total: 1, Guardados: 1, Errores: 0
2025-08-04 07:48:43.326 [main] INFO  [] [] c.j.p.i.controller.PedidoController - [FIN_CARGA_CSV] Request ID: 808422f4 - Procesamiento completado en 7ms - Total: 1, Guardados: 1, Tipos de errores: 0
2025-08-04 07:48:43.334 [main] INFO  [] [] o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-08-04 07:48:43.334 [main] DEBUG [] [] org.hibernate.SQL - drop table if exists cliente cascade 
2025-08-04 07:48:43.334 [main] DEBUG [] [] org.hibernate.SQL - drop table if exists pedido cascade 
2025-08-04 07:48:43.335 [main] DEBUG [] [] org.hibernate.SQL - drop table if exists zona cascade 
2025-08-04 07:48:43.335 [main] INFO  [] [] com.zaxxer.hikari.HikariDataSource - HikariPool-3 - Shutdown initiated...
2025-08-04 07:48:43.353 [main] INFO  [] [] com.zaxxer.hikari.HikariDataSource - HikariPool-3 - Shutdown completed.
2025-08-04 07:48:43.355 [main] INFO  [] [] o.s.b.d.r.RestartApplicationListener - Restart disabled due to context in which it is running
2025-08-04 07:48:43.372 [main] INFO  [] [] c.j.p.i.c.PedidoControllerHttpStatusTest - Starting PedidoControllerHttpStatusTest using Java 17.0.15 with PID 97497 (started by josuepatricio in /Users/josuepatricio/Downloads/pedidos-ms)
2025-08-04 07:48:43.372 [main] DEBUG [] [] c.j.p.i.c.PedidoControllerHttpStatusTest - Running with Spring Boot v3.5.4, Spring v6.2.9
2025-08-04 07:48:43.372 [main] INFO  [] [] c.j.p.i.c.PedidoControllerHttpStatusTest - The following 1 profile is active: "test"
2025-08-04 07:48:43.483 [main] INFO  [] [] o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-08-04 07:48:43.491 [main] INFO  [] [] o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 6 ms. Found 3 JPA repository interfaces.
2025-08-04 07:48:43.540 [main] INFO  [] [] o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-08-04 07:48:43.541 [main] INFO  [] [] com.zaxxer.hikari.HikariDataSource - HikariPool-4 - Starting...
2025-08-04 07:48:43.544 [main] INFO  [] [] com.zaxxer.hikari.pool.HikariPool - HikariPool-4 - Added connection conn22: url=jdbc:h2:mem:testdb user=SA
2025-08-04 07:48:43.544 [main] INFO  [] [] com.zaxxer.hikari.HikariDataSource - HikariPool-4 - Start completed.
2025-08-04 07:48:43.544 [main] WARN  [] [] org.hibernate.orm.deprecation - HHH90000025: H2Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-08-04 07:48:43.771 [main] DEBUG [] [] org.hibernate.SQL - drop table if exists cliente cascade 
2025-08-04 07:48:43.772 [main] DEBUG [] [] org.hibernate.SQL - drop table if exists pedido cascade 
2025-08-04 07:48:43.772 [main] DEBUG [] [] org.hibernate.SQL - drop table if exists zona cascade 
2025-08-04 07:48:43.773 [main] DEBUG [] [] org.hibernate.SQL - create table cliente (id varchar(255) not null, nombre varchar(255), primary key (id))
2025-08-04 07:48:43.787 [main] DEBUG [] [] org.hibernate.SQL - create table pedido (fecha_entrega date, requiere_refrigeracion boolean not null, cliente_id varchar(255) not null, numero_pedido varchar(255) not null, zona_entrega varchar(255) not null, estado enum ('CONFIRMADO','ENTREGADO','PENDIENTE'), primary key (numero_pedido))
2025-08-04 07:48:43.796 [main] DEBUG [] [] org.hibernate.SQL - create table zona (soporte_refrigeracion boolean not null, id varchar(255) not null, primary key (id))
2025-08-04 07:48:43.800 [main] DEBUG [] [] org.hibernate.SQL - alter table if exists pedido add constraint FK30s8j2ktpay6of18lbyqn3632 foreign key (cliente_id) references cliente
2025-08-04 07:48:43.806 [main] DEBUG [] [] org.hibernate.SQL - alter table if exists pedido add constraint FK1aokin5yjk78h5cax5jju4fs9 foreign key (zona_entrega) references zona
2025-08-04 07:48:43.815 [main] INFO  [] [] o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-08-04 07:48:44.801 [main] DEBUG [] [] org.hibernate.SQL - select count(*) from cliente c1_0
2025-08-04 07:48:44.910 [main] DEBUG [] [] org.hibernate.SQL - select c1_0.id,c1_0.nombre from cliente c1_0 where c1_0.id=?
2025-08-04 07:48:45.109 [main] DEBUG [] [] org.hibernate.SQL - insert into cliente (nombre,id) values (?,?)
2025-08-04 07:48:45.258 [main] DEBUG [] [] org.hibernate.SQL - select c1_0.id,c1_0.nombre from cliente c1_0 where c1_0.id=?
2025-08-04 07:48:45.260 [main] DEBUG [] [] org.hibernate.SQL - insert into cliente (nombre,id) values (?,?)
2025-08-04 07:48:45.263 [main] DEBUG [] [] org.hibernate.SQL - select count(*) from zona z1_0
2025-08-04 07:48:45.268 [main] DEBUG [] [] org.hibernate.SQL - select z1_0.id,z1_0.soporte_refrigeracion from zona z1_0 where z1_0.id=?
2025-08-04 07:48:45.269 [main] DEBUG [] [] org.hibernate.SQL - insert into zona (soporte_refrigeracion,id) values (?,?)
2025-08-04 07:48:45.314 [main] DEBUG [] [] org.hibernate.SQL - select z1_0.id,z1_0.soporte_refrigeracion from zona z1_0 where z1_0.id=?
2025-08-04 07:48:45.315 [main] DEBUG [] [] org.hibernate.SQL - insert into zona (soporte_refrigeracion,id) values (?,?)
2025-08-04 07:48:45.599 [main] WARN  [] [] o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-08-04 07:48:45.718 [main] INFO  [] [] o.s.b.a.h.H2ConsoleAutoConfiguration - H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:testdb'
2025-08-04 07:48:45.727 [main] INFO  [] [] o.s.b.t.m.w.SpringBootMockServletContext - Initializing Spring TestDispatcherServlet ''
2025-08-04 07:48:45.727 [main] INFO  [] [] o.s.t.w.s.TestDispatcherServlet - Initializing Servlet ''
2025-08-04 07:48:45.729 [main] INFO  [] [] o.s.b.a.e.web.EndpointLinksResolver - Exposing 1 endpoint beneath base path '/actuator'
2025-08-04 07:48:45.738 [main] INFO  [] [] o.s.t.w.s.TestDispatcherServlet - Completed initialization in 11 ms
2025-08-04 07:48:45.772 [main] INFO  [] [] c.j.p.i.c.PedidoControllerHttpStatusTest - Started PedidoControllerHttpStatusTest in 2.417 seconds (process running for 6.637)
2025-08-04 07:48:45.783 [main] DEBUG [] [] org.hibernate.SQL - select c1_0.id,c1_0.nombre from cliente c1_0
2025-08-04 07:48:45.786 [main] DEBUG [] [] org.hibernate.SQL - select z1_0.id,z1_0.soporte_refrigeracion from zona z1_0
2025-08-04 07:48:45.790 [main] DEBUG [] [] org.hibernate.SQL - delete from cliente where id=?
2025-08-04 07:48:45.792 [main] DEBUG [] [] org.hibernate.SQL - delete from cliente where id=?
2025-08-04 07:48:45.793 [main] DEBUG [] [] org.hibernate.SQL - delete from zona where id=?
2025-08-04 07:48:45.794 [main] DEBUG [] [] org.hibernate.SQL - delete from zona where id=?
2025-08-04 07:48:45.796 [main] DEBUG [] [] org.hibernate.SQL - select z1_0.id,z1_0.soporte_refrigeracion from zona z1_0 where z1_0.id=?
2025-08-04 07:48:45.802 [main] INFO  [] [HTTP_REQUEST] c.j.p.i.controller.PedidoController - [INICIO_CARGA_CSV] POST /pedidos/cargar - Request ID: 7466c7c2 - Archivo: pedidos.csv - Tamaño: 61 bytes
2025-08-04 07:48:45.802 [main] INFO  [] [CARGA_CSV] c.j.p.a.usecase.CargarPedidosUseCase - [INICIO_CARGA_CSV] Iniciando procesamiento de archivo: pedidos.csv (tamaño: 61 bytes)
2025-08-04 07:48:45.807 [main] ERROR [] [CARGA_CSV] c.j.p.a.usecase.CargarPedidosUseCase - [[ERROR_LECTURA_CSV, pedidos.csv]] Error al leer archivo CSV: {}
com.opencsv.exceptions.CsvMalformedLineException: Unterminated quoted field at end of CSV line. Beginning of lost text: [P001,CLI-123,2099-08-10
]
	at com.opencsv.CSVReader.primeNextRecord(CSVReader.java:245) ~[opencsv-5.8.jar:na]
	at com.opencsv.CSVReader.flexibleRead(CSVReader.java:610) ~[opencsv-5.8.jar:na]
	at com.opencsv.CSVReader.readNext(CSVReader.java:204) ~[opencsv-5.8.jar:na]
	at com.opencsv.CSVReader.readAll(CSVReader.java:186) ~[opencsv-5.8.jar:na]
	at com.josue.pedidos_ms.application.usecase.CargarPedidosUseCase.procesarArchivo(CargarPedidosUseCase.java:57) ~[classes/:na]
	at com.josue.pedidos_ms.infrastructure.controller.PedidoController.cargarArchivo(PedidoController.java:54) ~[classes/:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:569) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.9.jar:6.2.9]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.9.jar:6.2.9]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.9.jar:6.2.9]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991) ~[spring-webmvc-6.2.9.jar:6.2.9]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896) ~[spring-webmvc-6.2.9.jar:6.2.9]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.9.jar:6.2.9]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.9.jar:6.2.9]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.9.jar:6.2.9]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.9.jar:6.2.9]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914) ~[spring-webmvc-6.2.9.jar:6.2.9]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590) ~[tomcat-embed-core-10.1.43.jar:6.0]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.9.jar:6.2.9]
	at org.springframework.test.web.servlet.TestDispatcherServlet.service(TestDispatcherServlet.java:72) ~[spring-test-6.2.9.jar:6.2.9]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.43.jar:6.0]
	at org.springframework.mock.web.MockFilterChain$ServletFilterProxy.doFilter(MockFilterChain.java:165) ~[spring-test-6.2.9.jar:6.2.9]
	at org.springframework.mock.web.MockFilterChain.doFilter(MockFilterChain.java:132) ~[spring-test-6.2.9.jar:6.2.9]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.9.jar:6.2.9]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.9.jar:6.2.9]
	at org.springframework.test.web.servlet.setup.MockMvcFilterDecorator.doFilter(MockMvcFilterDecorator.java:162) ~[spring-test-6.2.9.jar:6.2.9]
	at org.springframework.mock.web.MockFilterChain.doFilter(MockFilterChain.java:132) ~[spring-test-6.2.9.jar:6.2.9]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.9.jar:6.2.9]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.9.jar:6.2.9]
	at org.springframework.test.web.servlet.setup.MockMvcFilterDecorator.doFilter(MockMvcFilterDecorator.java:162) ~[spring-test-6.2.9.jar:6.2.9]
	at org.springframework.mock.web.MockFilterChain.doFilter(MockFilterChain.java:132) ~[spring-test-6.2.9.jar:6.2.9]
	at org.springframework.web.filter.ServerHttpObservationFilter.doFilterInternal(ServerHttpObservationFilter.java:110) ~[spring-web-6.2.9.jar:6.2.9]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.9.jar:6.2.9]
	at org.springframework.test.web.servlet.setup.MockMvcFilterDecorator.doFilter(MockMvcFilterDecorator.java:162) ~[spring-test-6.2.9.jar:6.2.9]
	at org.springframework.mock.web.MockFilterChain.doFilter(MockFilterChain.java:132) ~[spring-test-6.2.9.jar:6.2.9]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.9.jar:6.2.9]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.9.jar:6.2.9]
	at org.springframework.test.web.servlet.setup.MockMvcFilterDecorator.doFilter(MockMvcFilterDecorator.java:162) ~[spring-test-6.2.9.jar:6.2.9]
	at org.springframework.mock.web.MockFilterChain.doFilter(MockFilterChain.java:132) ~[spring-test-6.2.9.jar:6.2.9]
	at org.springframework.test.web.servlet.MockMvc.perform(MockMvc.java:201) ~[spring-test-6.2.9.jar:6.2.9]
	at com.josue.pedidos_ms.infrastructure.controller.PedidoControllerHttpStatusTest.debeRetornar400CuandoElCsvEsMalformado(PedidoControllerHttpStatusTest.java:117) ~[test-classes/:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:569) ~[na:na]
	at org.junit.platform.commons.util.ReflectionUtils.invokeMethod(ReflectionUtils.java:775) ~[junit-platform-commons-1.12.2.jar:1.12.2]
	at org.junit.platform.commons.support.ReflectionSupport.invokeMethod(ReflectionSupport.java:479) ~[junit-platform-commons-1.12.2.jar:1.12.2]
	at org.junit.jupiter.engine.execution.MethodInvocation.proceed(MethodInvocation.java:60) ~[junit-jupiter-engine-5.12.2.jar:5.12.2]
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$ValidatingInvocation.proceed(InvocationInterceptorChain.java:131) ~[junit-jupiter-engine-5.12.2.jar:5.12.2]
	at org.junit.jupiter.engine.extension.TimeoutExtension.intercept(TimeoutExtension.java:161) ~[junit-jupiter-engine-5.12.2.jar:5.12.2]
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestableMethod(TimeoutExtension.java:152) ~[junit-jupiter-engine-5.12.2.jar:5.12.2]
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestMethod(TimeoutExtension.java:91) ~[junit-jupiter-engine-5.12.2.jar:5.12.2]
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker$ReflectiveInterceptorCall.lambda$ofVoidMethod$0(InterceptingExecutableInvoker.java:112) ~[junit-jupiter-engine-5.12.2.jar:5.12.2]
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.lambda$invoke$0(InterceptingExecutableInvoker.java:94) ~[junit-jupiter-engine-5.12.2.jar:5.12.2]
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$InterceptedInvocation.proceed(InvocationInterceptorChain.java:106) ~[junit-jupiter-engine-5.12.2.jar:5.12.2]
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.proceed(InvocationInterceptorChain.java:64) ~[junit-jupiter-engine-5.12.2.jar:5.12.2]
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.chainAndInvoke(InvocationInterceptorChain.java:45) ~[junit-jupiter-engine-5.12.2.jar:5.12.2]
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.invoke(InvocationInterceptorChain.java:37) ~[junit-jupiter-engine-5.12.2.jar:5.12.2]
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.invoke(InterceptingExecutableInvoker.java:93) ~[junit-jupiter-engine-5.12.2.jar:5.12.2]
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.invoke(InterceptingExecutableInvoker.java:87) ~[junit-jupiter-engine-5.12.2.jar:5.12.2]
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeTestMethod$7(TestMethodTestDescriptor.java:216) ~[junit-jupiter-engine-5.12.2.jar:5.12.2]
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73) ~[junit-platform-engine-1.12.2.jar:1.12.2]
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeTestMethod(TestMethodTestDescriptor.java:212) ~[junit-jupiter-engine-5.12.2.jar:5.12.2]
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:137) ~[junit-jupiter-engine-5.12.2.jar:5.12.2]
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:69) ~[junit-jupiter-engine-5.12.2.jar:5.12.2]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:156) ~[junit-platform-engine-1.12.2.jar:1.12.2]
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73) ~[junit-platform-engine-1.12.2.jar:1.12.2]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:146) ~[junit-platform-engine-1.12.2.jar:1.12.2]
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137) ~[junit-platform-engine-1.12.2.jar:1.12.2]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:144) ~[junit-platform-engine-1.12.2.jar:1.12.2]
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73) ~[junit-platform-engine-1.12.2.jar:1.12.2]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:143) ~[junit-platform-engine-1.12.2.jar:1.12.2]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:100) ~[junit-platform-engine-1.12.2.jar:1.12.2]
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511) ~[na:na]
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41) ~[junit-platform-engine-1.12.2.jar:1.12.2]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:160) ~[junit-platform-engine-1.12.2.jar:1.12.2]
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73) ~[junit-platform-engine-1.12.2.jar:1.12.2]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:146) ~[junit-platform-engine-1.12.2.jar:1.12.2]
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137) ~[junit-platform-engine-1.12.2.jar:1.12.2]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:144) ~[junit-platform-engine-1.12.2.jar:1.12.2]
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73) ~[junit-platform-engine-1.12.2.jar:1.12.2]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:143) ~[junit-platform-engine-1.12.2.jar:1.12.2]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:100) ~[junit-platform-engine-1.12.2.jar:1.12.2]
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511) ~[na:na]
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41) ~[junit-platform-engine-1.12.2.jar:1.12.2]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:160) ~[junit-platform-engine-1.12.2.jar:1.12.2]
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73) ~[junit-platform-engine-1.12.2.jar:1.12.2]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:146) ~[junit-platform-engine-1.12.2.jar:1.12.2]
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137) ~[junit-platform-engine-1.12.2.jar:1.12.2]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:144) ~[junit-platform-engine-1.12.2.jar:1.12.2]
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73) ~[junit-platform-engine-1.12.2.jar:1.12.2]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:143) ~[junit-platform-engine-1.12.2.jar:1.12.2]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:100) ~[junit-platform-engine-1.12.2.jar:1.12.2]
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:35) ~[junit-platform-engine-1.12.2.jar:1.12.2]
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57) ~[junit-platform-engine-1.12.2.jar:1.12.2]
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:54) ~[junit-platform-engine-1.12.2.jar:1.12.2]
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:201) ~[junit-platform-launcher-1.12.2.jar:1.12.2]
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:170) ~[junit-platform-launcher-1.12.2.jar:1.12.2]
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:94) ~[junit-platform-launcher-1.12.2.jar:1.12.2]
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:59) ~[junit-platform-launcher-1.12.2.jar:1.12.2]
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:142) ~[junit-platform-launcher-1.12.2.jar:1.12.2]
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:58) ~[junit-platform-launcher-1.12.2.jar:1.12.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:103) ~[junit-platform-launcher-1.12.2.jar:1.12.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:94) ~[junit-platform-launcher-1.12.2.jar:1.12.2]
	at org.junit.platform.launcher.core.DelegatingLauncher.execute(DelegatingLauncher.java:52) ~[junit-platform-launcher-1.12.2.jar:1.12.2]
	at org.junit.platform.launcher.core.InterceptingLauncher.lambda$execute$2(InterceptingLauncher.java:47) ~[junit-platform-launcher-1.12.2.jar:1.12.2]
	at org.junit.platform.launcher.core.ClasspathAlignmentCheckingLauncherInterceptor.intercept(ClasspathAlignmentCheckingLauncherInterceptor.java:25) ~[junit-platform-launcher-1.12.2.jar:1.12.2]
	at org.junit.platform.launcher.core.InterceptingLauncher.execute(InterceptingLauncher.java:46) ~[junit-platform-launcher-1.12.2.jar:1.12.2]
	at org.junit.platform.launcher.core.DelegatingLauncher.execute(DelegatingLauncher.java:52) ~[junit-platform-launcher-1.12.2.jar:1.12.2]
	at org.junit.platform.launcher.core.SessionPerRequestLauncher.execute(SessionPerRequestLauncher.java:70) ~[junit-platform-launcher-1.12.2.jar:1.12.2]
	at org.eclipse.jdt.internal.junit5.runner.JUnit5TestReference.run(JUnit5TestReference.java:100) ~[.cp/:na]
	at org.eclipse.jdt.internal.junit.runner.TestExecution.run(TestExecution.java:40) ~[.cp/:na]
	at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:520) ~[.cp/:na]
	at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:748) ~[.cp/:na]
	at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:443) ~[.cp/:na]
	at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.main(RemoteTestRunner.java:211) ~[.cp/:na]
2025-08-04 07:48:45.818 [main] WARN  [] [] c.j.p.i.c.GlobalExceptionHandler - [ERROR_LECTURA_CSV] Error de validación CSV: Archivo CSV ilegible o mal formateado: Unterminated quoted field at end of CSV line. Beginning of lost text: [P001,CLI-123,2099-08-10
]
2025-08-04 07:48:45.880 [main] INFO  [] [] o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-08-04 07:48:45.885 [main] DEBUG [] [] org.hibernate.SQL - drop table if exists cliente cascade 
2025-08-04 07:48:45.894 [main] DEBUG [] [] org.hibernate.SQL - drop table if exists pedido cascade 
2025-08-04 07:48:45.895 [main] DEBUG [] [] org.hibernate.SQL - drop table if exists zona cascade 
2025-08-04 07:48:45.901 [main] INFO  [] [] com.zaxxer.hikari.HikariDataSource - HikariPool-4 - Shutdown initiated...
2025-08-04 07:48:46.078 [main] INFO  [] [] com.zaxxer.hikari.HikariDataSource - HikariPool-4 - Shutdown completed.
2025-08-04 07:48:46.719 [main] INFO  [] [] o.s.b.d.r.RestartApplicationListener - Restart disabled due to context in which it is running
2025-08-04 07:48:46.784 [main] INFO  [] [] c.j.p.i.c.PedidoControllerHttpStatusTest - Starting PedidoControllerHttpStatusTest using Java 17.0.15 with PID 97497 (started by josuepatricio in /Users/josuepatricio/Downloads/pedidos-ms)
2025-08-04 07:48:46.784 [main] DEBUG [] [] c.j.p.i.c.PedidoControllerHttpStatusTest - Running with Spring Boot v3.5.4, Spring v6.2.9
2025-08-04 07:48:46.785 [main] INFO  [] [] c.j.p.i.c.PedidoControllerHttpStatusTest - The following 1 profile is active: "test"
2025-08-04 07:48:46.919 [main] INFO  [] [] o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-08-04 07:48:46.929 [main] INFO  [] [] o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 8 ms. Found 3 JPA repository interfaces.
2025-08-04 07:48:46.963 [main] INFO  [] [] o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-08-04 07:48:46.963 [main] INFO  [] [] com.zaxxer.hikari.HikariDataSource - HikariPool-5 - Starting...
2025-08-04 07:48:46.964 [main] INFO  [] [] com.zaxxer.hikari.pool.HikariPool - HikariPool-5 - Added connection conn32: url=jdbc:h2:mem:testdb user=SA
2025-08-04 07:48:46.965 [main] INFO  [] [] com.zaxxer.hikari.HikariDataSource - HikariPool-5 - Start completed.
2025-08-04 07:48:46.965 [main] WARN  [] [] org.hibernate.orm.deprecation - HHH90000025: H2Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-08-04 07:48:46.981 [main] DEBUG [] [] org.hibernate.SQL - drop table if exists cliente cascade 
2025-08-04 07:48:46.982 [main] DEBUG [] [] org.hibernate.SQL - drop table if exists pedido cascade 
2025-08-04 07:48:46.982 [main] DEBUG [] [] org.hibernate.SQL - drop table if exists zona cascade 
2025-08-04 07:48:46.982 [main] DEBUG [] [] org.hibernate.SQL - create table cliente (id varchar(255) not null, nombre varchar(255), primary key (id))
2025-08-04 07:48:46.983 [main] DEBUG [] [] org.hibernate.SQL - create table pedido (fecha_entrega date, requiere_refrigeracion boolean not null, cliente_id varchar(255) not null, numero_pedido varchar(255) not null, zona_entrega varchar(255) not null, estado enum ('CONFIRMADO','ENTREGADO','PENDIENTE'), primary key (numero_pedido))
2025-08-04 07:48:46.984 [main] DEBUG [] [] org.hibernate.SQL - create table zona (soporte_refrigeracion boolean not null, id varchar(255) not null, primary key (id))
2025-08-04 07:48:46.984 [main] DEBUG [] [] org.hibernate.SQL - alter table if exists pedido add constraint FK30s8j2ktpay6of18lbyqn3632 foreign key (cliente_id) references cliente
2025-08-04 07:48:46.985 [main] DEBUG [] [] org.hibernate.SQL - alter table if exists pedido add constraint FK1aokin5yjk78h5cax5jju4fs9 foreign key (zona_entrega) references zona
2025-08-04 07:48:46.986 [main] INFO  [] [] o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-08-04 07:48:47.006 [main] DEBUG [] [] org.hibernate.SQL - select count(*) from cliente c1_0
2025-08-04 07:48:47.012 [main] DEBUG [] [] org.hibernate.SQL - select c1_0.id,c1_0.nombre from cliente c1_0 where c1_0.id=?
2025-08-04 07:48:47.013 [main] DEBUG [] [] org.hibernate.SQL - insert into cliente (nombre,id) values (?,?)
2025-08-04 07:48:47.014 [main] DEBUG [] [] org.hibernate.SQL - select c1_0.id,c1_0.nombre from cliente c1_0 where c1_0.id=?
2025-08-04 07:48:47.015 [main] DEBUG [] [] org.hibernate.SQL - insert into cliente (nombre,id) values (?,?)
2025-08-04 07:48:47.016 [main] DEBUG [] [] org.hibernate.SQL - select count(*) from zona z1_0
2025-08-04 07:48:47.017 [main] DEBUG [] [] org.hibernate.SQL - select z1_0.id,z1_0.soporte_refrigeracion from zona z1_0 where z1_0.id=?
2025-08-04 07:48:47.017 [main] DEBUG [] [] org.hibernate.SQL - insert into zona (soporte_refrigeracion,id) values (?,?)
2025-08-04 07:48:47.018 [main] DEBUG [] [] org.hibernate.SQL - select z1_0.id,z1_0.soporte_refrigeracion from zona z1_0 where z1_0.id=?
2025-08-04 07:48:47.018 [main] DEBUG [] [] org.hibernate.SQL - insert into zona (soporte_refrigeracion,id) values (?,?)
2025-08-04 07:48:47.033 [main] WARN  [] [] o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-08-04 07:48:47.082 [main] INFO  [] [] o.s.b.a.h.H2ConsoleAutoConfiguration - H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:testdb'
2025-08-04 07:48:47.086 [main] INFO  [] [] o.s.b.t.m.w.SpringBootMockServletContext - Initializing Spring TestDispatcherServlet ''
2025-08-04 07:48:47.086 [main] INFO  [] [] o.s.t.w.s.TestDispatcherServlet - Initializing Servlet ''
2025-08-04 07:48:47.087 [main] INFO  [] [] o.s.b.a.e.web.EndpointLinksResolver - Exposing 1 endpoint beneath base path '/actuator'
2025-08-04 07:48:47.090 [main] INFO  [] [] o.s.t.w.s.TestDispatcherServlet - Completed initialization in 4 ms
2025-08-04 07:48:47.108 [main] INFO  [] [] c.j.p.i.c.PedidoControllerHttpStatusTest - Started PedidoControllerHttpStatusTest in 0.394 seconds (process running for 7.973)
2025-08-04 07:48:47.113 [main] DEBUG [] [] org.hibernate.SQL - select c1_0.id,c1_0.nombre from cliente c1_0
2025-08-04 07:48:47.115 [main] DEBUG [] [] org.hibernate.SQL - select z1_0.id,z1_0.soporte_refrigeracion from zona z1_0
2025-08-04 07:48:47.117 [main] DEBUG [] [] org.hibernate.SQL - delete from cliente where id=?
2025-08-04 07:48:47.117 [main] DEBUG [] [] org.hibernate.SQL - delete from cliente where id=?
2025-08-04 07:48:47.117 [main] DEBUG [] [] org.hibernate.SQL - delete from zona where id=?
2025-08-04 07:48:47.118 [main] DEBUG [] [] org.hibernate.SQL - delete from zona where id=?
2025-08-04 07:48:47.118 [main] DEBUG [] [] org.hibernate.SQL - select z1_0.id,z1_0.soporte_refrigeracion from zona z1_0 where z1_0.id=?
2025-08-04 07:48:47.121 [main] INFO  [] [HTTP_REQUEST] c.j.p.i.controller.PedidoController - [INICIO_CARGA_CSV] POST /pedidos/cargar - Request ID: 90fb858a - Archivo: pedidos.csv - Tamaño: 0 bytes
2025-08-04 07:48:47.121 [main] WARN  [] [HTTP_REQUEST] c.j.p.i.controller.PedidoController - [ARCHIVO_VACIO] Request ID: 90fb858a - Archivo vacío recibido
2025-08-04 07:48:47.121 [main] WARN  [] [] c.j.p.i.c.GlobalExceptionHandler - [ERROR_LECTURA_CSV] Error de validación CSV: El archivo está vacío
2025-08-04 07:48:47.130 [main] INFO  [] [] o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-08-04 07:48:47.130 [main] DEBUG [] [] org.hibernate.SQL - drop table if exists cliente cascade 
2025-08-04 07:48:47.130 [main] DEBUG [] [] org.hibernate.SQL - drop table if exists pedido cascade 
2025-08-04 07:48:47.131 [main] DEBUG [] [] org.hibernate.SQL - drop table if exists zona cascade 
2025-08-04 07:48:47.131 [main] INFO  [] [] com.zaxxer.hikari.HikariDataSource - HikariPool-5 - Shutdown initiated...
2025-08-04 07:48:47.141 [main] INFO  [] [] com.zaxxer.hikari.HikariDataSource - HikariPool-5 - Shutdown completed.
2025-08-04 07:48:47.142 [main] INFO  [] [] o.s.b.d.r.RestartApplicationListener - Restart disabled due to context in which it is running
2025-08-04 07:48:47.154 [main] INFO  [] [] c.j.p.i.c.PedidoControllerHttpStatusTest - Starting PedidoControllerHttpStatusTest using Java 17.0.15 with PID 97497 (started by josuepatricio in /Users/josuepatricio/Downloads/pedidos-ms)
2025-08-04 07:48:47.154 [main] DEBUG [] [] c.j.p.i.c.PedidoControllerHttpStatusTest - Running with Spring Boot v3.5.4, Spring v6.2.9
2025-08-04 07:48:47.154 [main] INFO  [] [] c.j.p.i.c.PedidoControllerHttpStatusTest - The following 1 profile is active: "test"
2025-08-04 07:48:47.258 [main] INFO  [] [] o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-08-04 07:48:47.263 [main] INFO  [] [] o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 4 ms. Found 3 JPA repository interfaces.
2025-08-04 07:48:47.295 [main] INFO  [] [] o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-08-04 07:48:47.296 [main] INFO  [] [] com.zaxxer.hikari.HikariDataSource - HikariPool-6 - Starting...
2025-08-04 07:48:47.298 [main] INFO  [] [] com.zaxxer.hikari.pool.HikariPool - HikariPool-6 - Added connection conn35: url=jdbc:h2:mem:testdb user=SA
2025-08-04 07:48:47.298 [main] INFO  [] [] com.zaxxer.hikari.HikariDataSource - HikariPool-6 - Start completed.
2025-08-04 07:48:47.298 [main] WARN  [] [] org.hibernate.orm.deprecation - HHH90000025: H2Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-08-04 07:48:47.312 [main] DEBUG [] [] org.hibernate.SQL - drop table if exists cliente cascade 
2025-08-04 07:48:47.312 [main] DEBUG [] [] org.hibernate.SQL - drop table if exists pedido cascade 
2025-08-04 07:48:47.312 [main] DEBUG [] [] org.hibernate.SQL - drop table if exists zona cascade 
2025-08-04 07:48:47.313 [main] DEBUG [] [] org.hibernate.SQL - create table cliente (id varchar(255) not null, nombre varchar(255), primary key (id))
2025-08-04 07:48:47.313 [main] DEBUG [] [] org.hibernate.SQL - create table pedido (fecha_entrega date, requiere_refrigeracion boolean not null, cliente_id varchar(255) not null, numero_pedido varchar(255) not null, zona_entrega varchar(255) not null, estado enum ('CONFIRMADO','ENTREGADO','PENDIENTE'), primary key (numero_pedido))
2025-08-04 07:48:47.314 [main] DEBUG [] [] org.hibernate.SQL - create table zona (soporte_refrigeracion boolean not null, id varchar(255) not null, primary key (id))
2025-08-04 07:48:47.314 [main] DEBUG [] [] org.hibernate.SQL - alter table if exists pedido add constraint FK30s8j2ktpay6of18lbyqn3632 foreign key (cliente_id) references cliente
2025-08-04 07:48:47.316 [main] DEBUG [] [] org.hibernate.SQL - alter table if exists pedido add constraint FK1aokin5yjk78h5cax5jju4fs9 foreign key (zona_entrega) references zona
2025-08-04 07:48:47.317 [main] INFO  [] [] o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-08-04 07:48:47.341 [main] DEBUG [] [] org.hibernate.SQL - select count(*) from cliente c1_0
2025-08-04 07:48:47.345 [main] DEBUG [] [] org.hibernate.SQL - select c1_0.id,c1_0.nombre from cliente c1_0 where c1_0.id=?
2025-08-04 07:48:47.345 [main] DEBUG [] [] org.hibernate.SQL - insert into cliente (nombre,id) values (?,?)
2025-08-04 07:48:47.346 [main] DEBUG [] [] org.hibernate.SQL - select c1_0.id,c1_0.nombre from cliente c1_0 where c1_0.id=?
2025-08-04 07:48:47.347 [main] DEBUG [] [] org.hibernate.SQL - insert into cliente (nombre,id) values (?,?)
2025-08-04 07:48:47.348 [main] DEBUG [] [] org.hibernate.SQL - select count(*) from zona z1_0
2025-08-04 07:48:47.349 [main] DEBUG [] [] org.hibernate.SQL - select z1_0.id,z1_0.soporte_refrigeracion from zona z1_0 where z1_0.id=?
2025-08-04 07:48:47.349 [main] DEBUG [] [] org.hibernate.SQL - insert into zona (soporte_refrigeracion,id) values (?,?)
2025-08-04 07:48:47.350 [main] DEBUG [] [] org.hibernate.SQL - select z1_0.id,z1_0.soporte_refrigeracion from zona z1_0 where z1_0.id=?
2025-08-04 07:48:47.351 [main] DEBUG [] [] org.hibernate.SQL - insert into zona (soporte_refrigeracion,id) values (?,?)
2025-08-04 07:48:47.361 [main] WARN  [] [] o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-08-04 07:48:47.406 [main] INFO  [] [] o.s.b.a.h.H2ConsoleAutoConfiguration - H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:testdb'
2025-08-04 07:48:47.409 [main] INFO  [] [] o.s.b.t.m.w.SpringBootMockServletContext - Initializing Spring TestDispatcherServlet ''
2025-08-04 07:48:47.409 [main] INFO  [] [] o.s.t.w.s.TestDispatcherServlet - Initializing Servlet ''
2025-08-04 07:48:47.410 [main] INFO  [] [] o.s.b.a.e.web.EndpointLinksResolver - Exposing 1 endpoint beneath base path '/actuator'
2025-08-04 07:48:47.413 [main] INFO  [] [] o.s.t.w.s.TestDispatcherServlet - Completed initialization in 4 ms
2025-08-04 07:48:47.430 [main] INFO  [] [] c.j.p.i.c.PedidoControllerHttpStatusTest - Started PedidoControllerHttpStatusTest in 0.288 seconds (process running for 8.295)
2025-08-04 07:48:47.434 [main] DEBUG [] [] org.hibernate.SQL - select c1_0.id,c1_0.nombre from cliente c1_0
2025-08-04 07:48:47.440 [main] DEBUG [] [] org.hibernate.SQL - select z1_0.id,z1_0.soporte_refrigeracion from zona z1_0
2025-08-04 07:48:47.442 [main] DEBUG [] [] org.hibernate.SQL - delete from cliente where id=?
2025-08-04 07:48:47.442 [main] DEBUG [] [] org.hibernate.SQL - delete from cliente where id=?
2025-08-04 07:48:47.442 [main] DEBUG [] [] org.hibernate.SQL - delete from zona where id=?
2025-08-04 07:48:47.442 [main] DEBUG [] [] org.hibernate.SQL - delete from zona where id=?
2025-08-04 07:48:47.443 [main] DEBUG [] [] org.hibernate.SQL - select z1_0.id,z1_0.soporte_refrigeracion from zona z1_0 where z1_0.id=?
2025-08-04 07:48:47.445 [main] INFO  [] [HTTP_REQUEST] c.j.p.i.controller.PedidoController - [INICIO_CARGA_CSV] POST /pedidos/cargar - Request ID: dd193e61 - Archivo: pedidos.csv - Tamaño: 147 bytes
2025-08-04 07:48:47.446 [main] INFO  [] [CARGA_CSV] c.j.p.a.usecase.CargarPedidosUseCase - [INICIO_CARGA_CSV] Iniciando procesamiento de archivo: pedidos.csv (tamaño: 147 bytes)
2025-08-04 07:48:47.446 [main] INFO  [] [CARGA_CSV] c.j.p.a.usecase.CargarPedidosUseCase - [INICIO_CARGA_CSV] Procesando 1 filas de datos (excluyendo cabecera)
2025-08-04 07:48:47.446 [main] DEBUG [P001] [CARGA_CSV] c.j.p.a.usecase.CargarPedidosUseCase - [INICIO_VALIDACION] Iniciando validación completa de pedido: P001
2025-08-04 07:48:47.446 [main] INFO  [P001] [CARGA_CSV] c.j.p.domain.service.PedidoValidator - [INICIO_VALIDACION] Validando número de pedido: P001
2025-08-04 07:48:47.448 [main] DEBUG [P001] [CARGA_CSV] org.hibernate.SQL - select count(*) from pedido p1_0 where p1_0.numero_pedido=?
2025-08-04 07:48:47.449 [main] DEBUG [P001] [CARGA_CSV] c.j.p.domain.service.PedidoValidator - [PEDIDO_VALIDO] Número de pedido único y válido: P001
2025-08-04 07:48:47.449 [main] DEBUG [P001] [CARGA_CSV] c.j.p.d.service.ClienteValidator - [INICIO_VALIDACION] Validando cliente: CLI-INEXISTENTE
2025-08-04 07:48:47.449 [main] DEBUG [P001] [CARGA_CSV] org.hibernate.SQL - select c1_0.id,c1_0.nombre from cliente c1_0 where c1_0.id=?
2025-08-04 07:48:47.450 [main] WARN  [P001] [CARGA_CSV] c.j.p.d.service.ClienteValidator - [PEDIDO_INVALIDO] Cliente no encontrado en base de datos: CLI-INEXISTENTE
2025-08-04 07:48:47.450 [main] DEBUG [P001] [CARGA_CSV] c.j.p.domain.service.FechaValidator - [INICIO_VALIDACION] Validando fecha de entrega: 2020-01-01
2025-08-04 07:48:47.450 [main] WARN  [P001] [CARGA_CSV] c.j.p.domain.service.FechaValidator - [PEDIDO_INVALIDO] Fecha de entrega en el pasado: 2020-01-01 (hoy: 2025-08-04)
2025-08-04 07:48:47.450 [main] DEBUG [P001] [CARGA_CSV] c.j.p.domain.service.EstadoValidator - [INICIO_VALIDACION] Validando estado: ESTADO_INVALIDO
2025-08-04 07:48:47.450 [main] WARN  [P001] [CARGA_CSV] c.j.p.domain.service.EstadoValidator - [PEDIDO_INVALIDO] Estado inválido: ESTADO_INVALIDO. Estados válidos: PENDIENTE, CONFIRMADO, ENTREGADO
2025-08-04 07:48:47.450 [main] DEBUG [P001] [CARGA_CSV] c.j.p.domain.service.ZonaValidator - [INICIO_VALIDACION] Validando zona: ZONA_INEXISTENTE con refrigeración: true
2025-08-04 07:48:47.450 [main] DEBUG [P001] [CARGA_CSV] org.hibernate.SQL - select z1_0.id,z1_0.soporte_refrigeracion from zona z1_0 where z1_0.id=?
2025-08-04 07:48:47.451 [main] WARN  [P001] [CARGA_CSV] c.j.p.domain.service.ZonaValidator - [PEDIDO_INVALIDO] Zona no encontrada en base de datos: ZONA_INEXISTENTE
2025-08-04 07:48:47.451 [main] INFO  [P001] [CARGA_CSV] c.j.p.a.usecase.CargarPedidosUseCase - [ESTADISTICAS_VALIDACION] Validación completada con 4 errores: [Clientes no encontrados, Fecha de entrega inválida, Estado inválido, Zonas inválidas]
2025-08-04 07:48:47.451 [main] WARN  [P001] [CARGA_CSV] c.j.p.a.usecase.CargarPedidosUseCase - [PEDIDO_INVALIDO] Pedido con 4 errores de validación
2025-08-04 07:48:47.452 [main] INFO  [] [] c.j.p.a.usecase.CargarPedidosUseCase - [RESUMEN_PROCESAMIENTO] Procesamiento completado - Total: 1, Guardados: 0, Errores: 4
2025-08-04 07:48:47.452 [main] INFO  [] [] c.j.p.i.controller.PedidoController - [FIN_CARGA_CSV] Request ID: dd193e61 - Procesamiento completado en 6ms - Total: 1, Guardados: 0, Tipos de errores: 4
2025-08-04 07:48:47.452 [main] WARN  [] [] c.j.p.i.controller.PedidoController - [ESTADISTICAS_VALIDACION] Request ID: dd193e61 - Errores de validación encontrados: 4 errores totales
2025-08-04 07:48:47.462 [main] INFO  [] [] o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-08-04 07:48:47.462 [main] DEBUG [] [] org.hibernate.SQL - drop table if exists cliente cascade 
2025-08-04 07:48:47.463 [main] DEBUG [] [] org.hibernate.SQL - drop table if exists pedido cascade 
2025-08-04 07:48:47.463 [main] DEBUG [] [] org.hibernate.SQL - drop table if exists zona cascade 
2025-08-04 07:48:47.464 [main] INFO  [] [] com.zaxxer.hikari.HikariDataSource - HikariPool-6 - Shutdown initiated...
2025-08-04 07:48:47.474 [main] INFO  [] [] com.zaxxer.hikari.HikariDataSource - HikariPool-6 - Shutdown completed.
2025-08-04 07:48:47.476 [main] INFO  [] [] o.s.b.d.r.RestartApplicationListener - Restart disabled due to context in which it is running
2025-08-04 07:48:47.492 [main] INFO  [] [] c.j.p.i.c.PedidoControllerHttpStatusTest - Starting PedidoControllerHttpStatusTest using Java 17.0.15 with PID 97497 (started by josuepatricio in /Users/josuepatricio/Downloads/pedidos-ms)
2025-08-04 07:48:47.492 [main] DEBUG [] [] c.j.p.i.c.PedidoControllerHttpStatusTest - Running with Spring Boot v3.5.4, Spring v6.2.9
2025-08-04 07:48:47.492 [main] INFO  [] [] c.j.p.i.c.PedidoControllerHttpStatusTest - The following 1 profile is active: "test"
2025-08-04 07:48:47.580 [main] INFO  [] [] o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-08-04 07:48:47.585 [main] INFO  [] [] o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 4 ms. Found 3 JPA repository interfaces.
2025-08-04 07:48:47.617 [main] INFO  [] [] o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-08-04 07:48:47.617 [main] INFO  [] [] com.zaxxer.hikari.HikariDataSource - HikariPool-7 - Starting...
2025-08-04 07:48:47.618 [main] INFO  [] [] com.zaxxer.hikari.pool.HikariPool - HikariPool-7 - Added connection conn38: url=jdbc:h2:mem:testdb user=SA
2025-08-04 07:48:47.618 [main] INFO  [] [] com.zaxxer.hikari.HikariDataSource - HikariPool-7 - Start completed.
2025-08-04 07:48:47.618 [main] WARN  [] [] org.hibernate.orm.deprecation - HHH90000025: H2Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-08-04 07:48:47.631 [main] DEBUG [] [] org.hibernate.SQL - drop table if exists cliente cascade 
2025-08-04 07:48:47.631 [main] DEBUG [] [] org.hibernate.SQL - drop table if exists pedido cascade 
2025-08-04 07:48:47.631 [main] DEBUG [] [] org.hibernate.SQL - drop table if exists zona cascade 
2025-08-04 07:48:47.632 [main] DEBUG [] [] org.hibernate.SQL - create table cliente (id varchar(255) not null, nombre varchar(255), primary key (id))
2025-08-04 07:48:47.632 [main] DEBUG [] [] org.hibernate.SQL - create table pedido (fecha_entrega date, requiere_refrigeracion boolean not null, cliente_id varchar(255) not null, numero_pedido varchar(255) not null, zona_entrega varchar(255) not null, estado enum ('CONFIRMADO','ENTREGADO','PENDIENTE'), primary key (numero_pedido))
2025-08-04 07:48:47.633 [main] DEBUG [] [] org.hibernate.SQL - create table zona (soporte_refrigeracion boolean not null, id varchar(255) not null, primary key (id))
2025-08-04 07:48:47.633 [main] DEBUG [] [] org.hibernate.SQL - alter table if exists pedido add constraint FK30s8j2ktpay6of18lbyqn3632 foreign key (cliente_id) references cliente
2025-08-04 07:48:47.634 [main] DEBUG [] [] org.hibernate.SQL - alter table if exists pedido add constraint FK1aokin5yjk78h5cax5jju4fs9 foreign key (zona_entrega) references zona
2025-08-04 07:48:47.635 [main] INFO  [] [] o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-08-04 07:48:47.649 [main] DEBUG [] [] org.hibernate.SQL - select count(*) from cliente c1_0
2025-08-04 07:48:47.653 [main] DEBUG [] [] org.hibernate.SQL - select c1_0.id,c1_0.nombre from cliente c1_0 where c1_0.id=?
2025-08-04 07:48:47.654 [main] DEBUG [] [] org.hibernate.SQL - insert into cliente (nombre,id) values (?,?)
2025-08-04 07:48:47.655 [main] DEBUG [] [] org.hibernate.SQL - select c1_0.id,c1_0.nombre from cliente c1_0 where c1_0.id=?
2025-08-04 07:48:47.656 [main] DEBUG [] [] org.hibernate.SQL - insert into cliente (nombre,id) values (?,?)
2025-08-04 07:48:47.657 [main] DEBUG [] [] org.hibernate.SQL - select count(*) from zona z1_0
2025-08-04 07:48:47.659 [main] DEBUG [] [] org.hibernate.SQL - select z1_0.id,z1_0.soporte_refrigeracion from zona z1_0 where z1_0.id=?
2025-08-04 07:48:47.660 [main] DEBUG [] [] org.hibernate.SQL - insert into zona (soporte_refrigeracion,id) values (?,?)
2025-08-04 07:48:47.661 [main] DEBUG [] [] org.hibernate.SQL - select z1_0.id,z1_0.soporte_refrigeracion from zona z1_0 where z1_0.id=?
2025-08-04 07:48:47.661 [main] DEBUG [] [] org.hibernate.SQL - insert into zona (soporte_refrigeracion,id) values (?,?)
2025-08-04 07:48:47.670 [main] WARN  [] [] o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-08-04 07:48:47.722 [main] INFO  [] [] o.s.b.a.h.H2ConsoleAutoConfiguration - H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:testdb'
2025-08-04 07:48:47.731 [main] INFO  [] [] o.s.b.t.m.w.SpringBootMockServletContext - Initializing Spring TestDispatcherServlet ''
2025-08-04 07:48:47.731 [main] INFO  [] [] o.s.t.w.s.TestDispatcherServlet - Initializing Servlet ''
2025-08-04 07:48:47.732 [main] INFO  [] [] o.s.b.a.e.web.EndpointLinksResolver - Exposing 1 endpoint beneath base path '/actuator'
2025-08-04 07:48:47.736 [main] INFO  [] [] o.s.t.w.s.TestDispatcherServlet - Completed initialization in 5 ms
2025-08-04 07:48:47.774 [main] INFO  [] [] c.j.p.i.c.PedidoControllerHttpStatusTest - Started PedidoControllerHttpStatusTest in 0.298 seconds (process running for 8.64)
2025-08-04 07:48:47.778 [main] DEBUG [] [] org.hibernate.SQL - select c1_0.id,c1_0.nombre from cliente c1_0
2025-08-04 07:48:47.780 [main] DEBUG [] [] org.hibernate.SQL - select z1_0.id,z1_0.soporte_refrigeracion from zona z1_0
2025-08-04 07:48:47.782 [main] DEBUG [] [] org.hibernate.SQL - delete from cliente where id=?
2025-08-04 07:48:47.783 [main] DEBUG [] [] org.hibernate.SQL - delete from cliente where id=?
2025-08-04 07:48:47.783 [main] DEBUG [] [] org.hibernate.SQL - delete from zona where id=?
2025-08-04 07:48:47.784 [main] DEBUG [] [] org.hibernate.SQL - delete from zona where id=?
2025-08-04 07:48:47.785 [main] DEBUG [] [] org.hibernate.SQL - select z1_0.id,z1_0.soporte_refrigeracion from zona z1_0 where z1_0.id=?
2025-08-04 07:48:47.787 [main] INFO  [] [HTTP_REQUEST] c.j.p.i.controller.PedidoController - [INICIO_CARGA_CSV] POST /pedidos/cargar - Request ID: 77756d3c - Archivo: pedidos.txt - Tamaño: 9 bytes
2025-08-04 07:48:47.787 [main] WARN  [] [HTTP_REQUEST] c.j.p.i.controller.PedidoController - [ERROR_LECTURA_CSV] Request ID: 77756d3c - Formato de archivo inválido: pedidos.txt
2025-08-04 07:48:47.787 [main] WARN  [] [] c.j.p.i.c.GlobalExceptionHandler - [ERROR_LECTURA_CSV] Error de validación CSV: Solo se permiten archivos CSV
2025-08-04 07:48:47.798 [main] INFO  [] [] o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-08-04 07:48:47.798 [main] DEBUG [] [] org.hibernate.SQL - drop table if exists cliente cascade 
2025-08-04 07:48:47.799 [main] DEBUG [] [] org.hibernate.SQL - drop table if exists pedido cascade 
2025-08-04 07:48:47.799 [main] DEBUG [] [] org.hibernate.SQL - drop table if exists zona cascade 
2025-08-04 07:48:47.800 [main] INFO  [] [] com.zaxxer.hikari.HikariDataSource - HikariPool-7 - Shutdown initiated...
2025-08-04 07:48:47.822 [main] INFO  [] [] com.zaxxer.hikari.HikariDataSource - HikariPool-7 - Shutdown completed.
2025-08-04 07:48:47.824 [main] INFO  [] [] o.s.b.d.r.RestartApplicationListener - Restart disabled due to context in which it is running
2025-08-04 07:48:47.842 [main] INFO  [] [] c.j.p.i.c.PedidoControllerHttpStatusTest - Starting PedidoControllerHttpStatusTest using Java 17.0.15 with PID 97497 (started by josuepatricio in /Users/josuepatricio/Downloads/pedidos-ms)
2025-08-04 07:48:47.842 [main] DEBUG [] [] c.j.p.i.c.PedidoControllerHttpStatusTest - Running with Spring Boot v3.5.4, Spring v6.2.9
2025-08-04 07:48:47.842 [main] INFO  [] [] c.j.p.i.c.PedidoControllerHttpStatusTest - The following 1 profile is active: "test"
2025-08-04 07:48:47.933 [main] INFO  [] [] o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-08-04 07:48:47.938 [main] INFO  [] [] o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 3 ms. Found 3 JPA repository interfaces.
2025-08-04 07:48:47.967 [main] INFO  [] [] o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-08-04 07:48:47.967 [main] INFO  [] [] com.zaxxer.hikari.HikariDataSource - HikariPool-8 - Starting...
2025-08-04 07:48:47.968 [main] INFO  [] [] com.zaxxer.hikari.pool.HikariPool - HikariPool-8 - Added connection conn42: url=jdbc:h2:mem:testdb user=SA
2025-08-04 07:48:47.968 [main] INFO  [] [] com.zaxxer.hikari.HikariDataSource - HikariPool-8 - Start completed.
2025-08-04 07:48:47.968 [main] WARN  [] [] org.hibernate.orm.deprecation - HHH90000025: H2Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-08-04 07:48:47.981 [main] DEBUG [] [] org.hibernate.SQL - drop table if exists cliente cascade 
2025-08-04 07:48:47.981 [main] DEBUG [] [] org.hibernate.SQL - drop table if exists pedido cascade 
2025-08-04 07:48:47.981 [main] DEBUG [] [] org.hibernate.SQL - drop table if exists zona cascade 
2025-08-04 07:48:47.981 [main] DEBUG [] [] org.hibernate.SQL - create table cliente (id varchar(255) not null, nombre varchar(255), primary key (id))
2025-08-04 07:48:47.982 [main] DEBUG [] [] org.hibernate.SQL - create table pedido (fecha_entrega date, requiere_refrigeracion boolean not null, cliente_id varchar(255) not null, numero_pedido varchar(255) not null, zona_entrega varchar(255) not null, estado enum ('CONFIRMADO','ENTREGADO','PENDIENTE'), primary key (numero_pedido))
2025-08-04 07:48:47.983 [main] DEBUG [] [] org.hibernate.SQL - create table zona (soporte_refrigeracion boolean not null, id varchar(255) not null, primary key (id))
2025-08-04 07:48:47.983 [main] DEBUG [] [] org.hibernate.SQL - alter table if exists pedido add constraint FK30s8j2ktpay6of18lbyqn3632 foreign key (cliente_id) references cliente
2025-08-04 07:48:47.984 [main] DEBUG [] [] org.hibernate.SQL - alter table if exists pedido add constraint FK1aokin5yjk78h5cax5jju4fs9 foreign key (zona_entrega) references zona
2025-08-04 07:48:47.985 [main] INFO  [] [] o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-08-04 07:48:48.006 [main] DEBUG [] [] org.hibernate.SQL - select count(*) from cliente c1_0
2025-08-04 07:48:48.018 [main] DEBUG [] [] org.hibernate.SQL - select c1_0.id,c1_0.nombre from cliente c1_0 where c1_0.id=?
2025-08-04 07:48:48.019 [main] DEBUG [] [] org.hibernate.SQL - insert into cliente (nombre,id) values (?,?)
2025-08-04 07:48:48.025 [main] DEBUG [] [] org.hibernate.SQL - select c1_0.id,c1_0.nombre from cliente c1_0 where c1_0.id=?
2025-08-04 07:48:48.030 [main] DEBUG [] [] org.hibernate.SQL - insert into cliente (nombre,id) values (?,?)
2025-08-04 07:48:48.032 [main] DEBUG [] [] org.hibernate.SQL - select count(*) from zona z1_0
2025-08-04 07:48:48.033 [main] DEBUG [] [] org.hibernate.SQL - select z1_0.id,z1_0.soporte_refrigeracion from zona z1_0 where z1_0.id=?
2025-08-04 07:48:48.034 [main] DEBUG [] [] org.hibernate.SQL - insert into zona (soporte_refrigeracion,id) values (?,?)
2025-08-04 07:48:48.035 [main] DEBUG [] [] org.hibernate.SQL - select z1_0.id,z1_0.soporte_refrigeracion from zona z1_0 where z1_0.id=?
2025-08-04 07:48:48.035 [main] DEBUG [] [] org.hibernate.SQL - insert into zona (soporte_refrigeracion,id) values (?,?)
2025-08-04 07:48:48.045 [main] WARN  [] [] o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-08-04 07:48:48.091 [main] INFO  [] [] o.s.b.a.h.H2ConsoleAutoConfiguration - H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:testdb'
2025-08-04 07:48:48.094 [main] INFO  [] [] o.s.b.t.m.w.SpringBootMockServletContext - Initializing Spring TestDispatcherServlet ''
2025-08-04 07:48:48.095 [main] INFO  [] [] o.s.t.w.s.TestDispatcherServlet - Initializing Servlet ''
2025-08-04 07:48:48.096 [main] INFO  [] [] o.s.b.a.e.web.EndpointLinksResolver - Exposing 1 endpoint beneath base path '/actuator'
2025-08-04 07:48:48.098 [main] INFO  [] [] o.s.t.w.s.TestDispatcherServlet - Completed initialization in 3 ms
2025-08-04 07:48:48.112 [main] INFO  [] [] c.j.p.i.c.PedidoControllerHttpStatusTest - Started PedidoControllerHttpStatusTest in 0.288 seconds (process running for 8.977)
2025-08-04 07:48:48.117 [main] DEBUG [] [] org.hibernate.SQL - select c1_0.id,c1_0.nombre from cliente c1_0
2025-08-04 07:48:48.119 [main] DEBUG [] [] org.hibernate.SQL - select z1_0.id,z1_0.soporte_refrigeracion from zona z1_0
2025-08-04 07:48:48.120 [main] DEBUG [] [] org.hibernate.SQL - delete from cliente where id=?
2025-08-04 07:48:48.120 [main] DEBUG [] [] org.hibernate.SQL - delete from cliente where id=?
2025-08-04 07:48:48.121 [main] DEBUG [] [] org.hibernate.SQL - delete from zona where id=?
2025-08-04 07:48:48.121 [main] DEBUG [] [] org.hibernate.SQL - delete from zona where id=?
2025-08-04 07:48:48.121 [main] DEBUG [] [] org.hibernate.SQL - select z1_0.id,z1_0.soporte_refrigeracion from zona z1_0 where z1_0.id=?
2025-08-04 07:48:48.125 [main] INFO  [] [HTTP_REQUEST] c.j.p.i.controller.PedidoController - [INICIO_CARGA_CSV] POST /pedidos/cargar - Request ID: 773a2f2f - Archivo: pedidos.csv - Tamaño: 186 bytes
2025-08-04 07:48:48.125 [main] INFO  [] [CARGA_CSV] c.j.p.a.usecase.CargarPedidosUseCase - [INICIO_CARGA_CSV] Iniciando procesamiento de archivo: pedidos.csv (tamaño: 186 bytes)
2025-08-04 07:48:48.125 [main] INFO  [] [CARGA_CSV] c.j.p.a.usecase.CargarPedidosUseCase - [INICIO_CARGA_CSV] Procesando 2 filas de datos (excluyendo cabecera)
2025-08-04 07:48:48.125 [main] DEBUG [P001] [CARGA_CSV] c.j.p.a.usecase.CargarPedidosUseCase - [INICIO_VALIDACION] Iniciando validación completa de pedido: P001
2025-08-04 07:48:48.125 [main] INFO  [P001] [CARGA_CSV] c.j.p.domain.service.PedidoValidator - [INICIO_VALIDACION] Validando número de pedido: P001
2025-08-04 07:48:48.127 [main] DEBUG [P001] [CARGA_CSV] org.hibernate.SQL - select count(*) from pedido p1_0 where p1_0.numero_pedido=?
2025-08-04 07:48:48.129 [main] DEBUG [P001] [CARGA_CSV] c.j.p.domain.service.PedidoValidator - [PEDIDO_VALIDO] Número de pedido único y válido: P001
2025-08-04 07:48:48.129 [main] DEBUG [P001] [CARGA_CSV] c.j.p.d.service.ClienteValidator - [INICIO_VALIDACION] Validando cliente: CLI-123
2025-08-04 07:48:48.130 [main] DEBUG [P001] [CARGA_CSV] c.j.p.d.service.ClienteValidator - [PEDIDO_VALIDO] Cliente válido encontrado: CLI-123 - Test Cliente
2025-08-04 07:48:48.130 [main] DEBUG [P001] [CARGA_CSV] c.j.p.domain.service.FechaValidator - [INICIO_VALIDACION] Validando fecha de entrega: 2099-08-10
2025-08-04 07:48:48.130 [main] DEBUG [P001] [CARGA_CSV] c.j.p.domain.service.FechaValidator - [PEDIDO_VALIDO] Fecha de entrega válida: 2099-08-10 (días desde hoy: 27034)
2025-08-04 07:48:48.130 [main] DEBUG [P001] [CARGA_CSV] c.j.p.domain.service.EstadoValidator - [INICIO_VALIDACION] Validando estado: PENDIENTE
2025-08-04 07:48:48.130 [main] DEBUG [P001] [CARGA_CSV] c.j.p.domain.service.EstadoValidator - [PEDIDO_VALIDO] Estado válido: PENDIENTE
2025-08-04 07:48:48.130 [main] DEBUG [P001] [CARGA_CSV] c.j.p.domain.service.ZonaValidator - [INICIO_VALIDACION] Validando zona: ZONA1 con refrigeración: true
2025-08-04 07:48:48.131 [main] DEBUG [P001] [CARGA_CSV] c.j.p.domain.service.ZonaValidator - [PEDIDO_VALIDO] Zona válida: ZONA1 - Soporte refrigeración: true - Requerido: true
2025-08-04 07:48:48.131 [main] DEBUG [P001] [CARGA_CSV] c.j.p.a.usecase.CargarPedidosUseCase - [PEDIDO_VALIDO] Todas las validaciones pasaron exitosamente
2025-08-04 07:48:48.131 [main] DEBUG [P001] [CONVERSION] c.j.p.a.usecase.CargarPedidosUseCase - [PEDIDO_PROCESADO] Convirtiendo DTO a entidad de dominio: P001
2025-08-04 07:48:48.131 [main] DEBUG [P001] [CONVERSION] c.j.p.a.usecase.CargarPedidosUseCase - [PEDIDO_PROCESADO] Conversión exitosa - Pedido: P001, Cliente: CLI-123, Fecha: 2099-08-10, Estado: PENDIENTE, Zona: ZONA1, Refrigeración: true
2025-08-04 07:48:48.131 [main] DEBUG [P001] [CONVERSION] c.j.p.a.usecase.CargarPedidosUseCase - [PEDIDO_PROCESADO] Pedido válido agregado para guardado: P001
2025-08-04 07:48:48.131 [main] DEBUG [P002] [CONVERSION] c.j.p.a.usecase.CargarPedidosUseCase - [INICIO_VALIDACION] Iniciando validación completa de pedido: P002
2025-08-04 07:48:48.131 [main] INFO  [P002] [CONVERSION] c.j.p.domain.service.PedidoValidator - [INICIO_VALIDACION] Validando número de pedido: P002
2025-08-04 07:48:48.133 [main] DEBUG [P002] [CONVERSION] org.hibernate.SQL - select count(*) from pedido p1_0 where p1_0.numero_pedido=?
2025-08-04 07:48:48.133 [main] DEBUG [P002] [CONVERSION] c.j.p.domain.service.PedidoValidator - [PEDIDO_VALIDO] Número de pedido único y válido: P002
2025-08-04 07:48:48.133 [main] DEBUG [P002] [CONVERSION] c.j.p.d.service.ClienteValidator - [INICIO_VALIDACION] Validando cliente: CLI-INEXISTENTE
2025-08-04 07:48:48.133 [main] DEBUG [P002] [CONVERSION] org.hibernate.SQL - select c1_0.id,c1_0.nombre from cliente c1_0 where c1_0.id=?
2025-08-04 07:48:48.134 [main] WARN  [P002] [CONVERSION] c.j.p.d.service.ClienteValidator - [PEDIDO_INVALIDO] Cliente no encontrado en base de datos: CLI-INEXISTENTE
2025-08-04 07:48:48.134 [main] DEBUG [P002] [CONVERSION] c.j.p.domain.service.FechaValidator - [INICIO_VALIDACION] Validando fecha de entrega: 2020-01-01
2025-08-04 07:48:48.134 [main] WARN  [P002] [CONVERSION] c.j.p.domain.service.FechaValidator - [PEDIDO_INVALIDO] Fecha de entrega en el pasado: 2020-01-01 (hoy: 2025-08-04)
2025-08-04 07:48:48.134 [main] DEBUG [P002] [CONVERSION] c.j.p.domain.service.EstadoValidator - [INICIO_VALIDACION] Validando estado: INVALIDO
2025-08-04 07:48:48.134 [main] WARN  [P002] [CONVERSION] c.j.p.domain.service.EstadoValidator - [PEDIDO_INVALIDO] Estado inválido: INVALIDO. Estados válidos: PENDIENTE, CONFIRMADO, ENTREGADO
2025-08-04 07:48:48.134 [main] DEBUG [P002] [CONVERSION] c.j.p.domain.service.ZonaValidator - [INICIO_VALIDACION] Validando zona: ZONA_INEXISTENTE con refrigeración: false
2025-08-04 07:48:48.135 [main] DEBUG [P002] [CONVERSION] org.hibernate.SQL - select z1_0.id,z1_0.soporte_refrigeracion from zona z1_0 where z1_0.id=?
2025-08-04 07:48:48.135 [main] WARN  [P002] [CONVERSION] c.j.p.domain.service.ZonaValidator - [PEDIDO_INVALIDO] Zona no encontrada en base de datos: ZONA_INEXISTENTE
2025-08-04 07:48:48.135 [main] INFO  [P002] [CONVERSION] c.j.p.a.usecase.CargarPedidosUseCase - [ESTADISTICAS_VALIDACION] Validación completada con 4 errores: [Clientes no encontrados, Fecha de entrega inválida, Estado inválido, Zonas inválidas]
2025-08-04 07:48:48.135 [main] WARN  [P002] [CONVERSION] c.j.p.a.usecase.CargarPedidosUseCase - [PEDIDO_INVALIDO] Pedido con 4 errores de validación
2025-08-04 07:48:48.135 [main] INFO  [P002] [PERSISTENCIA] c.j.p.a.usecase.CargarPedidosUseCase - [PEDIDO_GUARDADO] Guardando 1 pedidos válidos en base de datos
2025-08-04 07:48:48.136 [main] DEBUG [P002] [PERSISTENCIA] org.hibernate.SQL - select p1_0.numero_pedido,p1_0.cliente_id,c1_0.id,c1_0.nombre,p1_0.estado,p1_0.fecha_entrega,p1_0.requiere_refrigeracion,p1_0.zona_entrega,ze1_0.id,ze1_0.soporte_refrigeracion from pedido p1_0 join cliente c1_0 on c1_0.id=p1_0.cliente_id join zona ze1_0 on ze1_0.id=p1_0.zona_entrega where p1_0.numero_pedido=?
2025-08-04 07:48:48.137 [main] INFO  [P002] [PERSISTENCIA] c.j.p.a.usecase.CargarPedidosUseCase - [PEDIDO_GUARDADO] Guardados exitosamente 1 pedidos
2025-08-04 07:48:48.137 [main] INFO  [] [] c.j.p.a.usecase.CargarPedidosUseCase - [RESUMEN_PROCESAMIENTO] Procesamiento completado - Total: 2, Guardados: 1, Errores: 4
2025-08-04 07:48:48.137 [main] INFO  [] [] c.j.p.i.controller.PedidoController - [FIN_CARGA_CSV] Request ID: 773a2f2f - Procesamiento completado en 12ms - Total: 2, Guardados: 1, Tipos de errores: 4
2025-08-04 07:48:48.137 [main] WARN  [] [] c.j.p.i.controller.PedidoController - [ESTADISTICAS_VALIDACION] Request ID: 773a2f2f - Errores de validación encontrados: 4 errores totales
2025-08-04 07:48:48.408 [main] INFO  [] [CARGA_CSV] c.j.p.a.usecase.CargarPedidosUseCase - [INICIO_CARGA_CSV] Iniciando procesamiento de archivo: pedidos.csv (tamaño: 167 bytes)
2025-08-04 07:48:48.408 [main] INFO  [] [CARGA_CSV] c.j.p.a.usecase.CargarPedidosUseCase - [INICIO_CARGA_CSV] Procesando 2 filas de datos (excluyendo cabecera)
2025-08-04 07:48:48.408 [main] DEBUG [P001] [CARGA_CSV] c.j.p.a.usecase.CargarPedidosUseCase - [INICIO_VALIDACION] Iniciando validación completa de pedido: P001
2025-08-04 07:48:48.408 [main] INFO  [P001] [CARGA_CSV] c.j.p.domain.service.PedidoValidator - [INICIO_VALIDACION] Validando número de pedido: P001
2025-08-04 07:48:48.409 [main] DEBUG [P001] [CARGA_CSV] c.j.p.domain.service.PedidoValidator - [PEDIDO_VALIDO] Número de pedido único y válido: P001
2025-08-04 07:48:48.410 [main] DEBUG [P001] [CARGA_CSV] c.j.p.d.service.ClienteValidator - [INICIO_VALIDACION] Validando cliente: CLI-123
2025-08-04 07:48:48.411 [main] DEBUG [P001] [CARGA_CSV] c.j.p.d.service.ClienteValidator - [PEDIDO_VALIDO] Cliente válido encontrado: CLI-123 - Cliente Test
2025-08-04 07:48:48.411 [main] DEBUG [P001] [CARGA_CSV] c.j.p.domain.service.FechaValidator - [INICIO_VALIDACION] Validando fecha de entrega: 2099-08-10
2025-08-04 07:48:48.411 [main] DEBUG [P001] [CARGA_CSV] c.j.p.domain.service.FechaValidator - [PEDIDO_VALIDO] Fecha de entrega válida: 2099-08-10 (días desde hoy: 27034)
2025-08-04 07:48:48.411 [main] DEBUG [P001] [CARGA_CSV] c.j.p.domain.service.EstadoValidator - [INICIO_VALIDACION] Validando estado: PENDIENTE
2025-08-04 07:48:48.411 [main] DEBUG [P001] [CARGA_CSV] c.j.p.domain.service.EstadoValidator - [PEDIDO_VALIDO] Estado válido: PENDIENTE
2025-08-04 07:48:48.411 [main] DEBUG [P001] [CARGA_CSV] c.j.p.domain.service.ZonaValidator - [INICIO_VALIDACION] Validando zona: ZONA1 con refrigeración: true
2025-08-04 07:48:48.411 [main] DEBUG [P001] [CARGA_CSV] c.j.p.domain.service.ZonaValidator - [PEDIDO_VALIDO] Zona válida: ZONA1 - Soporte refrigeración: true - Requerido: true
2025-08-04 07:48:48.412 [main] DEBUG [P001] [CARGA_CSV] c.j.p.a.usecase.CargarPedidosUseCase - [PEDIDO_VALIDO] Todas las validaciones pasaron exitosamente
2025-08-04 07:48:48.412 [main] DEBUG [P001] [CONVERSION] c.j.p.a.usecase.CargarPedidosUseCase - [PEDIDO_PROCESADO] Convirtiendo DTO a entidad de dominio: P001
2025-08-04 07:48:48.412 [main] DEBUG [P001] [CONVERSION] c.j.p.a.usecase.CargarPedidosUseCase - [PEDIDO_PROCESADO] Conversión exitosa - Pedido: P001, Cliente: CLI-123, Fecha: 2099-08-10, Estado: PENDIENTE, Zona: ZONA1, Refrigeración: true
2025-08-04 07:48:48.412 [main] DEBUG [P001] [CONVERSION] c.j.p.a.usecase.CargarPedidosUseCase - [PEDIDO_PROCESADO] Pedido válido agregado para guardado: P001
2025-08-04 07:48:48.412 [main] DEBUG [P002] [CONVERSION] c.j.p.a.usecase.CargarPedidosUseCase - [INICIO_VALIDACION] Iniciando validación completa de pedido: P002
2025-08-04 07:48:48.412 [main] INFO  [P002] [CONVERSION] c.j.p.domain.service.PedidoValidator - [INICIO_VALIDACION] Validando número de pedido: P002
2025-08-04 07:48:48.413 [main] DEBUG [P002] [CONVERSION] c.j.p.domain.service.PedidoValidator - [PEDIDO_VALIDO] Número de pedido único y válido: P002
2025-08-04 07:48:48.413 [main] DEBUG [P002] [CONVERSION] c.j.p.d.service.ClienteValidator - [INICIO_VALIDACION] Validando cliente: CLI-999
2025-08-04 07:48:48.413 [main] WARN  [P002] [CONVERSION] c.j.p.d.service.ClienteValidator - [PEDIDO_INVALIDO] Cliente no encontrado en base de datos: CLI-999
2025-08-04 07:48:48.413 [main] DEBUG [P002] [CONVERSION] c.j.p.domain.service.FechaValidator - [INICIO_VALIDACION] Validando fecha de entrega: 2020-01-01
2025-08-04 07:48:48.413 [main] WARN  [P002] [CONVERSION] c.j.p.domain.service.FechaValidator - [PEDIDO_INVALIDO] Fecha de entrega en el pasado: 2020-01-01 (hoy: 2025-08-04)
2025-08-04 07:48:48.414 [main] DEBUG [P002] [CONVERSION] c.j.p.domain.service.EstadoValidator - [INICIO_VALIDACION] Validando estado: INVALIDO
2025-08-04 07:48:48.414 [main] WARN  [P002] [CONVERSION] c.j.p.domain.service.EstadoValidator - [PEDIDO_INVALIDO] Estado inválido: INVALIDO. Estados válidos: PENDIENTE, CONFIRMADO, ENTREGADO
2025-08-04 07:48:48.414 [main] DEBUG [P002] [CONVERSION] c.j.p.domain.service.ZonaValidator - [INICIO_VALIDACION] Validando zona: ZONA2 con refrigeración: false
2025-08-04 07:48:48.414 [main] WARN  [P002] [CONVERSION] c.j.p.domain.service.ZonaValidator - [PEDIDO_INVALIDO] Zona no encontrada en base de datos: ZONA2
2025-08-04 07:48:48.414 [main] INFO  [P002] [CONVERSION] c.j.p.a.usecase.CargarPedidosUseCase - [ESTADISTICAS_VALIDACION] Validación completada con 4 errores: [Clientes no encontrados, Fecha de entrega inválida, Estado inválido, Zonas inválidas]
2025-08-04 07:48:48.414 [main] WARN  [P002] [CONVERSION] c.j.p.a.usecase.CargarPedidosUseCase - [PEDIDO_INVALIDO] Pedido con 4 errores de validación
2025-08-04 07:48:48.414 [main] INFO  [P002] [PERSISTENCIA] c.j.p.a.usecase.CargarPedidosUseCase - [PEDIDO_GUARDADO] Guardando 1 pedidos válidos en base de datos
2025-08-04 07:48:48.415 [main] INFO  [P002] [PERSISTENCIA] c.j.p.a.usecase.CargarPedidosUseCase - [PEDIDO_GUARDADO] Guardados exitosamente 1 pedidos
2025-08-04 07:48:48.415 [main] INFO  [] [] c.j.p.a.usecase.CargarPedidosUseCase - [RESUMEN_PROCESAMIENTO] Procesamiento completado - Total: 2, Guardados: 1, Errores: 4
2025-08-04 07:48:48.427 [SpringApplicationShutdownHook] INFO  [] [] o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-08-04 07:48:48.427 [SpringApplicationShutdownHook] DEBUG [] [] org.hibernate.SQL - drop table if exists cliente cascade 
2025-08-04 07:48:48.428 [SpringApplicationShutdownHook] DEBUG [] [] org.hibernate.SQL - drop table if exists pedido cascade 
2025-08-04 07:48:48.429 [SpringApplicationShutdownHook] DEBUG [] [] org.hibernate.SQL - drop table if exists zona cascade 
2025-08-04 07:48:48.430 [SpringApplicationShutdownHook] INFO  [] [] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-08-04 07:48:48.431 [SpringApplicationShutdownHook] INFO  [] [] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-08-04 07:48:48.434 [SpringApplicationShutdownHook] INFO  [] [] o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-08-04 07:48:48.434 [SpringApplicationShutdownHook] DEBUG [] [] org.hibernate.SQL - drop table if exists cliente cascade 
2025-08-04 07:48:48.434 [SpringApplicationShutdownHook] DEBUG [] [] org.hibernate.SQL - drop table if exists pedido cascade 
2025-08-04 07:48:48.434 [SpringApplicationShutdownHook] DEBUG [] [] org.hibernate.SQL - drop table if exists zona cascade 
2025-08-04 07:48:48.435 [SpringApplicationShutdownHook] INFO  [] [] com.zaxxer.hikari.HikariDataSource - HikariPool-8 - Shutdown initiated...
2025-08-04 07:48:48.436 [SpringApplicationShutdownHook] INFO  [] [] com.zaxxer.hikari.HikariDataSource - HikariPool-8 - Shutdown completed.
